From 3577d3162075a6a60c8425ec34dd96d44ccc4828 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 16:12:09 +0200
Subject: [PATCH 001/267] Step 0.2: Remove both, client and server

---
 both/collections/demo-collection.ts               |  4 -
 both/models/demo-data-object.ts                   |  4 -
 client/imports/app/app.component.html             |  4 -
 client/imports/app/app.component.scss             |  5 --
 client/imports/app/app.component.ts               | 12 ---
 client/imports/app/app.module.ts                  | 30 -------
 client/imports/app/demo/demo-data.service.test.ts | 19 -----
 client/imports/app/demo/demo-data.service.ts      | 18 -----
 client/imports/app/demo/demo.component.html       |  8 --
 client/imports/app/demo/demo.component.scss       |  3 -
 client/imports/app/demo/demo.component.test.ts    | 95 -----------------------
 client/imports/app/demo/demo.component.ts         | 25 ------
 client/imports/app/index.ts                       |  2 -
 client/index.html                                 |  6 --
 client/init.test.ts                               | 12 ---
 client/main.ts                                    | 10 ---
 server/imports/server-main/main.test.ts           | 40 ----------
 server/imports/server-main/main.ts                | 27 -------
 server/main.ts                                    |  4 -
 19 files changed, 328 deletions(-)
 delete mode 100644 both/collections/demo-collection.ts
 delete mode 100644 both/models/demo-data-object.ts
 delete mode 100644 client/imports/app/app.component.html
 delete mode 100644 client/imports/app/app.component.scss
 delete mode 100644 client/imports/app/app.component.ts
 delete mode 100644 client/imports/app/app.module.ts
 delete mode 100644 client/imports/app/demo/demo-data.service.test.ts
 delete mode 100644 client/imports/app/demo/demo-data.service.ts
 delete mode 100644 client/imports/app/demo/demo.component.html
 delete mode 100644 client/imports/app/demo/demo.component.scss
 delete mode 100644 client/imports/app/demo/demo.component.test.ts
 delete mode 100644 client/imports/app/demo/demo.component.ts
 delete mode 100644 client/imports/app/index.ts
 delete mode 100644 client/index.html
 delete mode 100644 client/init.test.ts
 delete mode 100644 client/main.ts
 delete mode 100644 server/imports/server-main/main.test.ts
 delete mode 100644 server/imports/server-main/main.ts
 delete mode 100644 server/main.ts

diff --git a/both/collections/demo-collection.ts b/both/collections/demo-collection.ts
deleted file mode 100644
index 371b609..0000000
--- a/both/collections/demo-collection.ts
+++ /dev/null
@@ -1,4 +0,0 @@
-import { MongoObservable } from 'meteor-rxjs';
-import { DemoDataObject } from '../models/demo-data-object';
-
-export const DemoCollection = new MongoObservable.Collection<DemoDataObject>('demo-collection');
\ No newline at end of file
diff --git a/both/models/demo-data-object.ts b/both/models/demo-data-object.ts
deleted file mode 100644
index 64846d7..0000000
--- a/both/models/demo-data-object.ts
+++ /dev/null
@@ -1,4 +0,0 @@
-export interface DemoDataObject {
-  name: string;
-  age: number;
-}
\ No newline at end of file
diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
deleted file mode 100644
index 1d40faa..0000000
--- a/client/imports/app/app.component.html
+++ /dev/null
@@ -1,4 +0,0 @@
-<div>
-    <h1>Hello Angular2-Meteor!</h1>
-    <demo></demo>
-</div>
diff --git a/client/imports/app/app.component.scss b/client/imports/app/app.component.scss
deleted file mode 100644
index 4c02b72..0000000
--- a/client/imports/app/app.component.scss
+++ /dev/null
@@ -1,5 +0,0 @@
-body {
-
-}
-
-@import "./imports/demo/demo.component";
diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
deleted file mode 100644
index ca2fb29..0000000
--- a/client/imports/app/app.component.ts
+++ /dev/null
@@ -1,12 +0,0 @@
-import { Component } from '@angular/core';
-
-import template from './app.component.html';
-
-@Component({
-  selector: 'app',
-  template
-})
-export class AppComponent {
-  constructor() {
-  }
-}
diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
deleted file mode 100644
index 81baa33..0000000
--- a/client/imports/app/app.module.ts
+++ /dev/null
@@ -1,30 +0,0 @@
-import { NgModule } from '@angular/core';
-import { BrowserModule } from '@angular/platform-browser';
-import { METEOR_PROVIDERS } from 'angular2-meteor';
-
-import { AppComponent } from './app.component';
-import { DemoComponent } from './demo/demo.component';
-import { DemoDataService } from './demo/demo-data.service';
-
-@NgModule({
-  // Components, Pipes, Directive
-  declarations: [
-    AppComponent,
-    DemoComponent
-  ],
-  // Entry Components
-  entryComponents: [
-    AppComponent
-  ],
-  // Providers
-  providers: [
-    DemoDataService
-  ],
-  // Modules
-  imports: [
-    BrowserModule
-  ],
-  // Main Component
-  bootstrap: [ AppComponent ]
-})
-export class AppModule {}
diff --git a/client/imports/app/demo/demo-data.service.test.ts b/client/imports/app/demo/demo-data.service.test.ts
deleted file mode 100644
index 4320d63..0000000
--- a/client/imports/app/demo/demo-data.service.test.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-// chai uses as asset library
-import { assert } from 'chai';
-import { Mongo } from 'meteor/mongo';
-
-// Project imports
-import { DemoDataService } from './demo-data.service';
-
-describe('DemoDataService', () => {
-  let demoDataService:DemoDataService;
-
-  beforeEach(() => {
-    // Create the service instance
-    demoDataService = new DemoDataService();
-  });
-
-  it('Should return MongoDB Cursor when requesting the data', () => {
-    assert.isTrue(demoDataService.getData() instanceof Mongo.Cursor);
-  });
-});
diff --git a/client/imports/app/demo/demo-data.service.ts b/client/imports/app/demo/demo-data.service.ts
deleted file mode 100644
index 357aaf7..0000000
--- a/client/imports/app/demo/demo-data.service.ts
+++ /dev/null
@@ -1,18 +0,0 @@
-import { Injectable } from '@angular/core';
-import { ObservableCursor } from 'meteor-rxjs';
-
-import { DemoDataObject } from '../../../../both/models/demo-data-object';
-import { DemoCollection } from '../../../../both/collections/demo-collection';
-
-@Injectable()
-export class DemoDataService {
-  private data : ObservableCursor<DemoDataObject>;
-
-  constructor() {
-    this.data = DemoCollection.find({});
-  }
-
-  public getData() : ObservableCursor<DemoDataObject> {
-    return this.data;
-  }
-}
diff --git a/client/imports/app/demo/demo.component.html b/client/imports/app/demo/demo.component.html
deleted file mode 100644
index 38180c6..0000000
--- a/client/imports/app/demo/demo.component.html
+++ /dev/null
@@ -1,8 +0,0 @@
-<h2>{{greeting}}</h2>
-
-This is the available data:
-<ul>
-    <li *ngFor="let item of data | async">
-        {{item.name}} ({{item.age}})
-    </li>
-</ul>
diff --git a/client/imports/app/demo/demo.component.scss b/client/imports/app/demo/demo.component.scss
deleted file mode 100644
index 9e27489..0000000
--- a/client/imports/app/demo/demo.component.scss
+++ /dev/null
@@ -1,3 +0,0 @@
-demo {
-
-}
diff --git a/client/imports/app/demo/demo.component.test.ts b/client/imports/app/demo/demo.component.test.ts
deleted file mode 100644
index 39221cd..0000000
--- a/client/imports/app/demo/demo.component.test.ts
+++ /dev/null
@@ -1,95 +0,0 @@
-// chai uses as asset library
-import { assert } from 'chai';
-
-// Angular 2 tests imports
-import { inject } from '@angular/core';
-import { provide } from '@angular/core';
-import { TestComponentBuilder } from '@angular/compiler';
-
-// Project imports
-import { DemoComponent } from './demo.component';
-import { DemoDataService } from './demo-data.service';
-import { DemoDataObject } from '../../../../both/models/demo-data-object';
-
-describe('DemoComponent', () => {
-  let demoComponentInstance:DemoComponent;
-  let demoComponentElement;
-  let componentFixture;
-
-  let mockDataArray = [
-    <DemoDataObject>{
-      name: 'Test',
-      age: 10
-    }
-  ];
-
-  let mockDataService = {
-    getData: () => mockDataArray
-  };
-
-  beforeEach(inject([TestComponentBuilder], (tcb:TestComponentBuilder) => {
-    // We inject TestComponentBuilder that provides use the ability to control the injections of the component
-    // Then we will request to get DemoComponent with a mock service instead of the real DemoDataService
-    // The fixture created contain the element and the instance of the Component class
-    // Finally, we need to save 'detectChanges' and call it to flush the changes into the view.
-    return tcb.overrideProviders(DemoComponent, [
-      provide(DemoDataService, {useValue: mockDataService})
-    ]).createAsync(DemoComponent).then((fixture) => {
-      componentFixture = fixture;
-
-      demoComponentInstance = componentFixture.componentInstance;
-      demoComponentElement = componentFixture.nativeElement;
-
-      componentFixture.detectChanges();
-    });
-  }));
-
-  describe('@Component instance', () => {
-    it('Should have a greeting string on the component', () => {
-      assert.typeOf(demoComponentInstance.greeting, 'string', 'Greeting should be a string!');
-    });
-
-    it('Should say hello to the component on the greeting string', () => {
-      assert.equal(demoComponentInstance.greeting, 'Hello Demo Component!');
-    });
-
-    it('Should have an array (from the mock) of the instance', () => {
-      assert.typeOf(demoComponentInstance.getData(), 'array');
-    });
-
-    it('Should have an items in the array', () => {
-      assert.typeOf(demoComponentInstance.getData(), 'array');
-      assert.equal((<Array>demoComponentInstance.getData()).length, 1);
-    });
-  });
-
-  describe('@Component view', () => {
-    it('Should print the greeting to the screen', () => {
-      assert.include(demoComponentElement.innerHTML, 'Hello Demo Component');
-    });
-
-    it('Should change the greeting when it changes', () => {
-      assert.include(demoComponentElement.innerHTML, 'Hello Demo Component');
-      demoComponentInstance.greeting = 'New Test Greeting';
-      componentFixture.detectChanges();
-      assert.include(demoComponentElement.innerHTML, 'New Test Greeting');
-    });
-
-    it('Should display a list of items in the screen', () => {
-      assert.isNotNull(demoComponentElement.querySelector('ul'));
-    });
-
-    it('Should add item to the list when modifying the data in the service', () => {
-      assert.equal(demoComponentElement.querySelectorAll('li').length, 1);
-
-      mockDataArray.push({
-        name: 'Dotan',
-        age: 20
-      });
-
-      componentFixture.detectChanges();
-
-      assert.equal(demoComponentElement.querySelectorAll('li').length, 2);
-    });
-  });
-});
diff --git a/client/imports/app/demo/demo.component.ts b/client/imports/app/demo/demo.component.ts
deleted file mode 100644
index 9a4df43..0000000
--- a/client/imports/app/demo/demo.component.ts
+++ /dev/null
@@ -1,25 +0,0 @@
-import { Component, OnInit } from '@angular/core';
-import { ObservableCursor } from 'meteor-rxjs';
-import { Observable } from 'rxjs/Observable';
-
-import { DemoDataService } from './demo-data.service';
-import { DemoDataObject } from '../../../../both/models/demo-data-object';
-
-import template from './demo.component.html';
-
-@Component({
-  selector: 'demo',
-  template
-})
-export class DemoComponent implements OnInit {
-  greeting: string;
-  data: Observable<DemoDataObject[]>;
-
-  constructor(private demoDataService: DemoDataService) {
-    this.greeting = 'Hello Demo Component!';
-  }
-
-  ngOnInit() {
-    this.data = this.demoDataService.getData().zone();
-  }
-}
diff --git a/client/imports/app/index.ts b/client/imports/app/index.ts
deleted file mode 100644
index 875bdb2..0000000
--- a/client/imports/app/index.ts
+++ /dev/null
@@ -1,2 +0,0 @@
-export * from './app.component';
-export * from './app.module';
diff --git a/client/index.html b/client/index.html
deleted file mode 100644
index d3675e5..0000000
--- a/client/index.html
+++ /dev/null
@@ -1,6 +0,0 @@
-<head>
-    <base href="/">
-</head>
-<body>
-  <app>Loading...</app>
-</body>
diff --git a/client/init.test.ts b/client/init.test.ts
deleted file mode 100644
index cd07c0b..0000000
--- a/client/init.test.ts
+++ /dev/null
@@ -1,12 +0,0 @@
-// angular2-meteor polyfills required for testing
-import 'angular2-meteor-tests-polyfills';
-
-// Angular 2 tests imports
-import { platformBrowserDynamicTesting, BrowserDynamicTestingModule } from '@angular/platform-browser-dynamic';
-import { TestBed } from '@angular/core';
-
-// Init the test framework
-TestBed.initTestEnvironment(
-  BrowserDynamicTestingModule,
-  platformBrowserDynamicTesting()
-);
diff --git a/client/main.ts b/client/main.ts
deleted file mode 100644
index 0a01b5b..0000000
--- a/client/main.ts
+++ /dev/null
@@ -1,10 +0,0 @@
-import 'angular2-meteor-polyfills';
-
-import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
-import { enableProdMode } from '@angular/core';
-
-import { AppModule } from './imports/app';
-
-enableProdMode();
-
-platformBrowserDynamic().bootstrapModule(AppModule);
diff --git a/server/imports/server-main/main.test.ts b/server/imports/server-main/main.test.ts
deleted file mode 100644
index e050427..0000000
--- a/server/imports/server-main/main.test.ts
+++ /dev/null
@@ -1,40 +0,0 @@
-// chai uses as asset library
-import * as chai from 'chai';
-import * as spies from 'chai-spies';
-import StubCollections from 'meteor/hwillson:stub-collections';
-
-import { DemoCollection } from '../../../both/collections/demo-collection';
-import { Main } from './main';
-
-chai.use(spies);
-
-describe('Server Main', () => {
-  let mainInstance : Main;
-
-  beforeEach(() => {
-    // Creating database mock
-    StubCollections.stub(DemoCollection);
-
-    // Create instance of main class
-    mainInstance = new Main();
-  });
-
-  afterEach(() => {
-    // Restore database
-    StubCollections.restore();
-  });
-
-  it('Should call initFakeData on startup', () => {
-    mainInstance.initFakeData = chai.spy();
-    mainInstance.start();
-
-    chai.expect(mainInstance.initFakeData).to.have.been.called();
-  });
-
-  it('Should call insert 3 times when init fake data', () => {
-    DemoCollection.insert = chai.spy();
-    mainInstance.initFakeData();
-
-    chai.expect(DemoCollection.insert).to.have.been.called.exactly(3);
-  });
-});
diff --git a/server/imports/server-main/main.ts b/server/imports/server-main/main.ts
deleted file mode 100644
index d4b1cda..0000000
--- a/server/imports/server-main/main.ts
+++ /dev/null
@@ -1,27 +0,0 @@
-import { DemoCollection } from '../../../both/collections/demo-collection';
-import { DemoDataObject } from '../../../both/models/demo-data-object';
-
-export class Main {
-  start(): void {
-    this.initFakeData();
-  }
-
-  initFakeData(): void {
-    if (DemoCollection.find({}).cursor.count() === 0) {
-      const data: DemoDataObject[] = [{
-        name: 'Dotan',
-        age: 25
-      }, {
-        name: 'Liran',
-        age: 26
-      }, {
-        name: 'Uri',
-        age: 30
-      }];
-      
-      data.forEach((obj: DemoDataObject) => {
-        DemoCollection.insert(obj);
-      });
-    }
-  }
-}
diff --git a/server/main.ts b/server/main.ts
deleted file mode 100644
index de5d825..0000000
--- a/server/main.ts
+++ /dev/null
@@ -1,4 +0,0 @@
-import { Main } from './imports/server-main/main';
-
-const mainInstance = new Main();
-mainInstance.start();
-- 
2.7.4 (Apple Git-66)


From 9fbf9680a8246fb334ec502a6ef0ad01a46d1c55 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 16:13:29 +0200
Subject: [PATCH 002/267] Step 0.3: Create index.html

---
 client/index.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 client/index.html

diff --git a/client/index.html b/client/index.html
new file mode 100644
index 0000000..292767b
--- /dev/null
+++ b/client/index.html
@@ -0,0 +1,6 @@
+<head>
+  <base href="/">
+</head>
+<body>
+  Hello World!
+</body>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 76c317fac03c14c3f5486f4f1ef4275fac6b7e41 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 16:14:27 +0200
Subject: [PATCH 003/267] Step 0.4: Create App component

---
 client/imports/app/app.component.ts | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 client/imports/app/app.component.ts

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
new file mode 100644
index 0000000..9c5caf4
--- /dev/null
+++ b/client/imports/app/app.component.ts
@@ -0,0 +1,6 @@
+import { Component } from '@angular/core';
+
+@Component({
+  selector: 'app'
+})
+export class AppComponent {}
-- 
2.7.4 (Apple Git-66)


From a4e72b49d7b870bcc4c8301f1be284f2a0a67e70 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 16:14:59 +0200
Subject: [PATCH 004/267] Step 0.5: Create template for the App component

---
 client/imports/app/app.component.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/imports/app/app.component.html

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
new file mode 100644
index 0000000..c57eff5
--- /dev/null
+++ b/client/imports/app/app.component.html
@@ -0,0 +1 @@
+Hello World!
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From f87640cead1fd6926e6a5492ec6cf450cdaff693 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 16:15:41 +0200
Subject: [PATCH 005/267] Step 0.6: Implement template

---
 client/imports/app/app.component.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
index 9c5caf4..91e1a06 100644
--- a/client/imports/app/app.component.ts
+++ b/client/imports/app/app.component.ts
@@ -1,6 +1,9 @@
 import { Component } from '@angular/core';
 
+import template from './app.component.html';
+
 @Component({
-  selector: 'app'
+  selector: 'app',
+  template
 })
 export class AppComponent {}
-- 
2.7.4 (Apple Git-66)


From b5e2cc481d87609a2ae2b2a838fc999ea29fcbb0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 16:16:18 +0200
Subject: [PATCH 006/267] Step 0.7: Add App component to index.html

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 292767b..4e8596c 100644
--- a/client/index.html
+++ b/client/index.html
@@ -2,5 +2,5 @@
   <base href="/">
 </head>
 <body>
-  Hello World!
+  <app>Loading...</app>
 </body>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From eeed9280ee58b1aea43e1e96b98048d2df37e63d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 16:19:05 +0200
Subject: [PATCH 007/267] Step 0.8: Create AppModule

---
 client/imports/app/app.module.ts | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 client/imports/app/app.module.ts

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
new file mode 100644
index 0000000..6eda2d2
--- /dev/null
+++ b/client/imports/app/app.module.ts
@@ -0,0 +1,9 @@
+import { NgModule } from '@angular/core';
+import { BrowserModule } from '@angular/platform-browser';
+
+@NgModule({
+  imports: [
+    BrowserModule
+  ]
+})
+export class AppModule {}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From b97a4fba5b8d717fc6838999d202136fa150f27b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 16:20:10 +0200
Subject: [PATCH 008/267] Step 0.9: Add App component to App module

---
 client/imports/app/app.module.ts | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 6eda2d2..50a22d6 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -1,9 +1,17 @@
 import { NgModule } from '@angular/core';
 import { BrowserModule } from '@angular/platform-browser';
 
+import { AppComponent } from './app.component';
+
 @NgModule({
   imports: [
     BrowserModule
+  ],
+  declarations: [
+    AppComponent
+  ],
+  bootstrap: [
+    AppComponent
   ]
 })
 export class AppModule {}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From be48654ca0e3c160af9694284d0d907a25d73983 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 16:22:46 +0200
Subject: [PATCH 009/267] Step 0.10: Create main entry point

---
 client/main.ts | 8 ++++++++
 1 file changed, 8 insertions(+)
 create mode 100644 client/main.ts

diff --git a/client/main.ts b/client/main.ts
new file mode 100644
index 0000000..c5323fd
--- /dev/null
+++ b/client/main.ts
@@ -0,0 +1,8 @@
+import 'angular2-meteor-polyfills';
+
+import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
+
+import { AppModule } from './imports/app/app.module';
+
+const platform = platformBrowserDynamic();
+platform.bootstrapModule(AppModule);
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From e779a0a025741c7102c4b8de219ba7db38f73b67 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:02:38 +0200
Subject: [PATCH 010/267] Step 1.1: Add static HTML to the main component view

---
 client/imports/app/app.component.html | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index c57eff5..9ea318e 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1 +1,14 @@
-Hello World!
\ No newline at end of file
+<ul>
+  <li>
+    <span>Dubstep-Free Zone</span>
+    <p>
+      Can we please just for an evening not listen to dubstep.
+    </p>
+  </li>
+  <li>
+    <span>All dubstep all the time</span>
+    <p>
+      Get it on!
+    </p>
+  </li>
+</ul>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 6a9af316a3c5588ecae4cb89befb8f0d1ff3277b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:04:31 +0200
Subject: [PATCH 011/267] Step 2.1: Add dynamic html to the App component

---
 client/imports/app/app.component.html | 23 +++++++++--------------
 1 file changed, 9 insertions(+), 14 deletions(-)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index 9ea318e..b750655 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1,14 +1,9 @@
-<ul>
-  <li>
-    <span>Dubstep-Free Zone</span>
-    <p>
-      Can we please just for an evening not listen to dubstep.
-    </p>
-  </li>
-  <li>
-    <span>All dubstep all the time</span>
-    <p>
-      Get it on!
-    </p>
-  </li>
-</ul>
\ No newline at end of file
+<div>
+  <ul>
+    <li *ngFor="let party of parties">
+      {{party.name}}
+      <p>{{party.description}}</p>
+      <p>{{party.location}}</p>
+    </li>
+  </ul>
+</div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From bc0e6d5ea6a72800f5fd4dec22bc47ed7a72aa86 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:05:17 +0200
Subject: [PATCH 012/267] Step 2.2: Load parties data into app

---
 client/imports/app/app.component.ts | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
index 91e1a06..834d1ea 100644
--- a/client/imports/app/app.component.ts
+++ b/client/imports/app/app.component.ts
@@ -6,4 +6,23 @@ import template from './app.component.html';
   selector: 'app',
   template
 })
-export class AppComponent {}
+export class AppComponent {
+  parties: any[];
+
+  constructor() {
+    this.parties = [
+      {'name': 'Dubstep-Free Zone',
+        'description': 'Can we please just for an evening not listen to dubstep.',
+        'location': 'Palo Alto'
+      },
+      {'name': 'All dubstep all the time',
+        'description': 'Get it on!',
+        'location': 'Palo Alto'
+      },
+      {'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.',
+        'location': 'San Francisco'
+      }
+    ];
+  }
+}
-- 
2.7.4 (Apple Git-66)


From 7fd6c19ae3a7bee0ad068177c2897ba54e657dbe Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:35:10 +0200
Subject: [PATCH 013/267] Step 3.1: Add Parties collection

---
 both/collections/parties.collection.ts | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 both/collections/parties.collection.ts

diff --git a/both/collections/parties.collection.ts b/both/collections/parties.collection.ts
new file mode 100644
index 0000000..65011f1
--- /dev/null
+++ b/both/collections/parties.collection.ts
@@ -0,0 +1,3 @@
+import { MongoObservable } from 'meteor-rxjs';
+
+export const Parties = new MongoObservable.Collection('parties');
-- 
2.7.4 (Apple Git-66)


From 57a1cdf95e4a3613fe08577516292dc242991481 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:36:03 +0200
Subject: [PATCH 014/267] Step 3.2: Import Parties collection

---
 client/imports/app/app.component.ts | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
index 834d1ea..b41b7c6 100644
--- a/client/imports/app/app.component.ts
+++ b/client/imports/app/app.component.ts
@@ -1,5 +1,7 @@
 import { Component } from '@angular/core';
 
+import { Parties } from '../../both/collections/parties.collection';
+
 import template from './app.component.html';
 
 @Component({
-- 
2.7.4 (Apple Git-66)


From b5d44217bf75d40f87ba0dcc214ba45367d0cb3c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:38:50 +0200
Subject: [PATCH 015/267] Step 3.3: Bind MongoObservable to Angular

---
 client/imports/app/app.component.ts | 18 +++---------------
 1 file changed, 3 insertions(+), 15 deletions(-)

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
index b41b7c6..ef11c40 100644
--- a/client/imports/app/app.component.ts
+++ b/client/imports/app/app.component.ts
@@ -1,4 +1,5 @@
 import { Component } from '@angular/core';
+import { Observable } from 'rxjs/Observable';
 
 import { Parties } from '../../both/collections/parties.collection';
 
@@ -9,22 +10,9 @@ import template from './app.component.html';
   template
 })
 export class AppComponent {
-  parties: any[];
+  parties: Observable<any[]>;
 
   constructor() {
-    this.parties = [
-      {'name': 'Dubstep-Free Zone',
-        'description': 'Can we please just for an evening not listen to dubstep.',
-        'location': 'Palo Alto'
-      },
-      {'name': 'All dubstep all the time',
-        'description': 'Get it on!',
-        'location': 'Palo Alto'
-      },
-      {'name': 'Savage lounging',
-        'description': 'Leisure suit required. And only fiercest manners.',
-        'location': 'San Francisco'
-      }
-    ];
+    this.parties = Parties.find({}).zone();
   }
 }
-- 
2.7.4 (Apple Git-66)


From 36e8c8f5851aa0c1c93269bc3b668fc835b78588 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:40:42 +0200
Subject: [PATCH 016/267] Step 3.4: Add initial Parties

---
 server/imports/fixtures/parties.ts | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)
 create mode 100644 server/imports/fixtures/parties.ts

diff --git a/server/imports/fixtures/parties.ts b/server/imports/fixtures/parties.ts
new file mode 100644
index 0000000..63b055b
--- /dev/null
+++ b/server/imports/fixtures/parties.ts
@@ -0,0 +1,21 @@
+import { Parties } from '../../../both/collections/parties.collection';
+
+export function loadParties() {
+  if (Parties.find().cursor.count() === 0) {
+    const parties = [{
+      name: 'Dubstep-Free Zone',
+      description: 'Can we please just for an evening not listen to dubstep.',
+      location: 'Palo Alto'
+    }, {
+      name: 'All dubstep all the time',
+      description: 'Get it on!',
+      location: 'Palo Alto'
+    }, {
+      name: 'Savage lounging',
+      description: 'Leisure suit required. And only fiercest manners.',
+      location: 'San Francisco'
+    }];
+
+    parties.forEach((party) => Parties.insert(party));
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 57c2e039b1db5d210c92a00cf5519f93756d02d8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:41:39 +0200
Subject: [PATCH 017/267] Step 3.5: Load initial Parties

---
 server/main.ts | 7 +++++++
 1 file changed, 7 insertions(+)
 create mode 100644 server/main.ts

diff --git a/server/main.ts b/server/main.ts
new file mode 100644
index 0000000..cf58a8d
--- /dev/null
+++ b/server/main.ts
@@ -0,0 +1,7 @@
+import { Meteor } from 'meteor/meteor';
+
+import { loadParties } from './imports/fixtures/parties';
+
+Meteor.startup(() => {
+  loadParties();
+});
-- 
2.7.4 (Apple Git-66)


From e793545f3f7e7cf52505f90b1f378df065241a1b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:42:21 +0200
Subject: [PATCH 018/267] Step 3.6: Use AsyncPipe

---
 client/imports/app/app.component.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index b750655..cc8d5c5 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1,6 +1,6 @@
 <div>
   <ul>
-    <li *ngFor="let party of parties">
+    <li *ngFor="let party of parties | async">
       {{party.name}}
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
-- 
2.7.4 (Apple Git-66)


From 39309c9dc3883f45c033de80f9575c6c5935b6bc Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:51:56 +0200
Subject: [PATCH 019/267] Step 3.7: Define Party interface

---
 both/models/party.model.ts | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 both/models/party.model.ts

diff --git a/both/models/party.model.ts b/both/models/party.model.ts
new file mode 100644
index 0000000..388567d
--- /dev/null
+++ b/both/models/party.model.ts
@@ -0,0 +1,5 @@
+export interface Party {
+  name: string;
+  description: string;
+  location: string;
+}
-- 
2.7.4 (Apple Git-66)


From 0fa54569d564e978fa8df8b233e09802d9ed417f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:53:05 +0200
Subject: [PATCH 020/267] Step 3.8: Add Party type to Parties collection

---
 both/collections/parties.collection.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/both/collections/parties.collection.ts b/both/collections/parties.collection.ts
index 65011f1..8146c60 100644
--- a/both/collections/parties.collection.ts
+++ b/both/collections/parties.collection.ts
@@ -1,3 +1,5 @@
 import { MongoObservable } from 'meteor-rxjs';
 
-export const Parties = new MongoObservable.Collection('parties');
+import { Party } from '../models/party.model';
+
+export const Parties = new MongoObservable.Collection<Party>('parties');
-- 
2.7.4 (Apple Git-66)


From d744cbbd0fb823741bd3b3a74d2a185272b524b3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:53:54 +0200
Subject: [PATCH 021/267] Step 3.9: Add Party type to data fixtures

---
 server/imports/fixtures/parties.ts | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/server/imports/fixtures/parties.ts b/server/imports/fixtures/parties.ts
index 63b055b..4f6d555 100644
--- a/server/imports/fixtures/parties.ts
+++ b/server/imports/fixtures/parties.ts
@@ -1,8 +1,9 @@
 import { Parties } from '../../../both/collections/parties.collection';
+import { Party } from '../../../both/models/party.model';
 
 export function loadParties() {
   if (Parties.find().cursor.count() === 0) {
-    const parties = [{
+    const parties: Party[] = [{
       name: 'Dubstep-Free Zone',
       description: 'Can we please just for an evening not listen to dubstep.',
       location: 'Palo Alto'
@@ -16,6 +17,6 @@ export function loadParties() {
       location: 'San Francisco'
     }];
 
-    parties.forEach((party) => Parties.insert(party));
+    parties.forEach((party: Party) => Parties.insert(party));
   }
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From c87616c5f8213de6da1af440ecc264c835ba0cd7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 17:54:22 +0200
Subject: [PATCH 022/267] Step 3.10: Add Party type to App component

---
 client/imports/app/app.component.ts | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
index ef11c40..dde38a4 100644
--- a/client/imports/app/app.component.ts
+++ b/client/imports/app/app.component.ts
@@ -2,6 +2,7 @@ import { Component } from '@angular/core';
 import { Observable } from 'rxjs/Observable';
 
 import { Parties } from '../../both/collections/parties.collection';
+import { Party } from '../../both/models/party.model';
 
 import template from './app.component.html';
 
@@ -10,7 +11,7 @@ import template from './app.component.html';
   template
 })
 export class AppComponent {
-  parties: Observable<any[]>;
+  parties: Observable<Party[]>;
 
   constructor() {
     this.parties = Parties.find({}).zone();
-- 
2.7.4 (Apple Git-66)


From 35bb35ef5d41910e3f6021e4c96cd976b477981d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:08:58 +0200
Subject: [PATCH 023/267] Step 4.1: Create PartiesForm component

---
 client/imports/app/parties/parties-form.component.ts | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 client/imports/app/parties/parties-form.component.ts

diff --git a/client/imports/app/parties/parties-form.component.ts b/client/imports/app/parties/parties-form.component.ts
new file mode 100644
index 0000000..36df898
--- /dev/null
+++ b/client/imports/app/parties/parties-form.component.ts
@@ -0,0 +1,9 @@
+import { Component } from '@angular/core';
+
+import template from './parties-form.component.html';
+
+@Component({
+  selector: 'parties-form',
+  template
+})
+export class PartiesFormComponent {}
-- 
2.7.4 (Apple Git-66)


From e9d17caeb54e9fb93935e710d06bb27c0d0f6943 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:10:01 +0200
Subject: [PATCH 024/267] Step 4.2: Create template of PartiesForm

---
 client/imports/app/parties/parties-form.component.html | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 client/imports/app/parties/parties-form.component.html

diff --git a/client/imports/app/parties/parties-form.component.html b/client/imports/app/parties/parties-form.component.html
new file mode 100644
index 0000000..4f908e7
--- /dev/null
+++ b/client/imports/app/parties/parties-form.component.html
@@ -0,0 +1,12 @@
+<form>
+  <label>Name</label>
+  <input type="text">
+
+  <label>Description</label>
+  <input type="text">
+
+  <label>Location</label>
+  <input type="text">
+  
+  <button>Add</button>
+</form>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 42b68073cdea8f19cd8cdc8b015be8e9e3cfbb15 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:10:46 +0200
Subject: [PATCH 025/267] Step 4.3: Add PartiesForm to App

---
 client/imports/app/app.component.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index cc8d5c5..9e780a4 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1,4 +1,6 @@
 <div>
+  <parties-form></parties-form>
+  
   <ul>
     <li *ngFor="let party of parties | async">
       {{party.name}}
-- 
2.7.4 (Apple Git-66)


From b04676bcbfcd26ed346fa5c43479dfca0f5a70a5 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:13:04 +0200
Subject: [PATCH 026/267] Step 4.4: Create index for parties with declarations

---
 client/imports/app/parties/index.ts | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 client/imports/app/parties/index.ts

diff --git a/client/imports/app/parties/index.ts b/client/imports/app/parties/index.ts
new file mode 100644
index 0000000..c5e7e18
--- /dev/null
+++ b/client/imports/app/parties/index.ts
@@ -0,0 +1,5 @@
+import { PartiesFormComponent } from './parties-form.component';
+
+export const PARTIES_DECLARATIONS = [
+  PartiesFormComponent
+];
-- 
2.7.4 (Apple Git-66)


From 29ed7eda26b904284bf4f73dada42eb63d86342b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:13:23 +0200
Subject: [PATCH 027/267] Step 4.5: Add parties declarations to AppModule

---
 client/imports/app/app.module.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 50a22d6..e3a487a 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -2,13 +2,15 @@ import { NgModule } from '@angular/core';
 import { BrowserModule } from '@angular/platform-browser';
 
 import { AppComponent } from './app.component';
+import { PARTIES_DECLARATIONS } from './parties';
 
 @NgModule({
   imports: [
     BrowserModule
   ],
   declarations: [
-    AppComponent
+    AppComponent,
+    ...PARTIES_DECLARATIONS
   ],
   bootstrap: [
     AppComponent
-- 
2.7.4 (Apple Git-66)


From 7f776865b44b90afe3ee0bfbd41831926cd80136 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:14:46 +0200
Subject: [PATCH 028/267] Step 4.6: Import Forms modules

---
 client/imports/app/app.module.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index e3a487a..8e8c303 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -1,12 +1,15 @@
 import { NgModule } from '@angular/core';
 import { BrowserModule } from '@angular/platform-browser';
+import { FormsModule, ReactiveFormsModule } from '@angular/forms';
 
 import { AppComponent } from './app.component';
 import { PARTIES_DECLARATIONS } from './parties';
 
 @NgModule({
   imports: [
-    BrowserModule
+    BrowserModule,
+    FormsModule,
+    ReactiveFormsModule
   ],
   declarations: [
     AppComponent,
-- 
2.7.4 (Apple Git-66)


From 8bcbcba3b1a8762f413e855b2e209d9996a43c81 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:17:31 +0200
Subject: [PATCH 029/267] Step 4.7: Create form model

---
 client/imports/app/parties/parties-form.component.ts | 19 +++++++++++++++++--
 1 file changed, 17 insertions(+), 2 deletions(-)

diff --git a/client/imports/app/parties/parties-form.component.ts b/client/imports/app/parties/parties-form.component.ts
index 36df898..d98ae60 100644
--- a/client/imports/app/parties/parties-form.component.ts
+++ b/client/imports/app/parties/parties-form.component.ts
@@ -1,4 +1,5 @@
-import { Component } from '@angular/core';
+import { Component, OnInit } from '@angular/core';
+import { FormGroup, FormBuilder } from '@angular/forms';
 
 import template from './parties-form.component.html';
 
@@ -6,4 +7,18 @@ import template from './parties-form.component.html';
   selector: 'parties-form',
   template
 })
-export class PartiesFormComponent {}
+export class PartiesFormComponent implements OnInit {
+  addForm: FormGroup;
+
+  constructor(
+    private formBuilder: FormBuilder
+  ) {}
+
+  ngOnInit() {
+    this.addForm = this.formBuilder.group({
+      name: [],
+      description: [],
+      location: []
+    });
+  }
+}
-- 
2.7.4 (Apple Git-66)


From aa03182390a41205a220ed263d0ccd3ecedcd3f7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:18:39 +0200
Subject: [PATCH 030/267] Step 4.8: Implement form directives

---
 client/imports/app/parties/parties-form.component.html | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/client/imports/app/parties/parties-form.component.html b/client/imports/app/parties/parties-form.component.html
index 4f908e7..d707240 100644
--- a/client/imports/app/parties/parties-form.component.html
+++ b/client/imports/app/parties/parties-form.component.html
@@ -1,12 +1,12 @@
-<form>
+<form [formGroup]="addForm">
   <label>Name</label>
-  <input type="text">
+  <input type="text" formControlName="name">
 
   <label>Description</label>
-  <input type="text">
+  <input type="text" formControlName="description">
 
   <label>Location</label>
-  <input type="text">
+  <input type="text" formControlName="location">
   
-  <button>Add</button>
+  <button type="submit">Add</button>
 </form>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 4094ae0b0b6f16db2ee339992606d46c92523c71 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:19:25 +0200
Subject: [PATCH 031/267] Step 4.9: Add validators

---
 client/imports/app/parties/parties-form.component.ts | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/imports/app/parties/parties-form.component.ts b/client/imports/app/parties/parties-form.component.ts
index d98ae60..bb47f4b 100644
--- a/client/imports/app/parties/parties-form.component.ts
+++ b/client/imports/app/parties/parties-form.component.ts
@@ -1,5 +1,5 @@
 import { Component, OnInit } from '@angular/core';
-import { FormGroup, FormBuilder } from '@angular/forms';
+import { FormGroup, FormBuilder, Validators } from '@angular/forms';
 
 import template from './parties-form.component.html';
 
@@ -16,9 +16,9 @@ export class PartiesFormComponent implements OnInit {
 
   ngOnInit() {
     this.addForm = this.formBuilder.group({
-      name: [],
+      name: ['', Validators.required],
       description: [],
-      location: []
+      location: ['', Validators.required]
     });
   }
 }
-- 
2.7.4 (Apple Git-66)


From 6a32ea23f0e4da1794e25d2a8ee1977c1cef147f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:20:00 +0200
Subject: [PATCH 032/267] Step 4.10: Add ngSubmit to the form

---
 client/imports/app/parties/parties-form.component.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-form.component.html b/client/imports/app/parties/parties-form.component.html
index d707240..98f90ca 100644
--- a/client/imports/app/parties/parties-form.component.html
+++ b/client/imports/app/parties/parties-form.component.html
@@ -1,4 +1,4 @@
-<form [formGroup]="addForm">
+<form [formGroup]="addForm" (ngSubmit)="addParty()">
   <label>Name</label>
   <input type="text" formControlName="name">
 
-- 
2.7.4 (Apple Git-66)


From 46b0034da958f3ce4bf3dc2a1d0b82f2c0564356 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:23:47 +0200
Subject: [PATCH 033/267] Step 4.11: Add addParty method

---
 client/imports/app/parties/parties-form.component.ts | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/imports/app/parties/parties-form.component.ts b/client/imports/app/parties/parties-form.component.ts
index bb47f4b..511812d 100644
--- a/client/imports/app/parties/parties-form.component.ts
+++ b/client/imports/app/parties/parties-form.component.ts
@@ -1,6 +1,8 @@
 import { Component, OnInit } from '@angular/core';
 import { FormGroup, FormBuilder, Validators } from '@angular/forms';
 
+import { Parties } from '../../../../both/collections/parties.collection';
+
 import template from './parties-form.component.html';
 
 @Component({
@@ -21,4 +23,12 @@ export class PartiesFormComponent implements OnInit {
       location: ['', Validators.required]
     });
   }
+
+  addParty(): void {
+    if (this.addForm.valid) {
+      Parties.insert(this.addForm.value);
+
+      this.addForm.reset();
+    }
+  }
 }
-- 
2.7.4 (Apple Git-66)


From 99d95e47ad48e7ccd7f25c6e787ba5b74de06c4b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:24:18 +0200
Subject: [PATCH 034/267] Step 4.12: Add remove button

---
 client/imports/app/app.component.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index 9e780a4..0820d66 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -6,6 +6,7 @@
       {{party.name}}
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
+      <button (click)="removeParty(party)">X</button>
     </li>
   </ul>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 16251fcb15d8fce46d1916ef72a6e58be78a1218 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:25:25 +0200
Subject: [PATCH 035/267] Step 4.13: Implement removeParty method

---
 client/imports/app/app.component.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
index dde38a4..dbff991 100644
--- a/client/imports/app/app.component.ts
+++ b/client/imports/app/app.component.ts
@@ -16,4 +16,8 @@ export class AppComponent {
   constructor() {
     this.parties = Parties.find({}).zone();
   }
+
+  removeParty(party: Party): void {
+    Parties.remove(party._id);
+  }
 }
-- 
2.7.4 (Apple Git-66)


From 7171fc26e1e57f3c940d545724fcf59a26704127 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:26:25 +0200
Subject: [PATCH 036/267] Step 4.14: Create CollectionObject model

---
 both/models/collection-object.model.ts | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 both/models/collection-object.model.ts

diff --git a/both/models/collection-object.model.ts b/both/models/collection-object.model.ts
new file mode 100644
index 0000000..f83638e
--- /dev/null
+++ b/both/models/collection-object.model.ts
@@ -0,0 +1,3 @@
+export interface CollectionObject {
+  _id?: string;
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From e04c455c8c290d8006e29c38854efe077708d87d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:27:11 +0200
Subject: [PATCH 037/267] Step 4.15: Extend Party by CollectionObject model

---
 both/models/party.model.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/both/models/party.model.ts b/both/models/party.model.ts
index 388567d..fd5a709 100644
--- a/both/models/party.model.ts
+++ b/both/models/party.model.ts
@@ -1,4 +1,6 @@
-export interface Party {
+import { CollectionObject } from './collection-object.model';
+
+export interface Party extends CollectionObject {
   name: string;
   description: string;
   location: string;
-- 
2.7.4 (Apple Git-66)


From ca915b4dfc55984d6bdb1ded74daac5fb42036b1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:31:20 +0200
Subject: [PATCH 038/267] Step 5.1: Create PartiesList component

---
 .../imports/app/parties/parties-list.component.ts  | 23 ++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 client/imports/app/parties/parties-list.component.ts

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
new file mode 100644
index 0000000..bb09b1c
--- /dev/null
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -0,0 +1,23 @@
+import { Component } from '@angular/core';
+import { Observable } from 'rxjs/Observable';
+
+import { Parties } from '../../../../both/collections/parties.collection';
+import { Party } from '../../../../both/models/party.model';
+
+import template from './parties-list.component.html';
+
+@Component({
+  selector: 'parties-list',
+  template
+})
+export class PartiesListComponent {
+  parties: Observable<Party[]>;
+
+  constructor() {
+    this.parties = Parties.find({}).zone();
+  }
+
+  removeParty(party: Party): void {
+    Parties.remove(party._id);
+  }
+}
-- 
2.7.4 (Apple Git-66)


From aed2e3c561cd896cb0605ca6b28dccc648fe08d2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:32:21 +0200
Subject: [PATCH 039/267] Step 5.2: Copy contents of app.html to PartiesList
 template

---
 client/imports/app/parties/parties-list.component.html | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 client/imports/app/parties/parties-list.component.html

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
new file mode 100644
index 0000000..49136a9
--- /dev/null
+++ b/client/imports/app/parties/parties-list.component.html
@@ -0,0 +1,12 @@
+<div>
+  <parties-form></parties-form>
+
+  <ul>
+    <li *ngFor="let party of parties | async">
+      {{party.name}}
+      <p>{{party.description}}</p>
+      <p>{{party.location}}</p>
+      <button (click)="removeParty(party)">X</button>
+    </li>
+  </ul>
+</div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 92bc91b3de9c5e92e5220b32ba94f572f6b4bdde Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:33:04 +0200
Subject: [PATCH 040/267] Step 5.3: Clean up App component

---
 client/imports/app/app.component.ts | 16 +---------------
 1 file changed, 1 insertion(+), 15 deletions(-)

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
index dbff991..91e1a06 100644
--- a/client/imports/app/app.component.ts
+++ b/client/imports/app/app.component.ts
@@ -1,8 +1,4 @@
 import { Component } from '@angular/core';
-import { Observable } from 'rxjs/Observable';
-
-import { Parties } from '../../both/collections/parties.collection';
-import { Party } from '../../both/models/party.model';
 
 import template from './app.component.html';
 
@@ -10,14 +6,4 @@ import template from './app.component.html';
   selector: 'app',
   template
 })
-export class AppComponent {
-  parties: Observable<Party[]>;
-
-  constructor() {
-    this.parties = Parties.find({}).zone();
-  }
-
-  removeParty(party: Party): void {
-    Parties.remove(party._id);
-  }
-}
+export class AppComponent {}
-- 
2.7.4 (Apple Git-66)


From 8012843faf5eb3afc6b15968461d0d615d831129 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:33:33 +0200
Subject: [PATCH 041/267] Step 5.4: Clean up App template

---
 client/imports/app/app.component.html | 13 +------------
 1 file changed, 1 insertion(+), 12 deletions(-)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index 0820d66..281c686 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1,12 +1 @@
-<div>
-  <parties-form></parties-form>
-  
-  <ul>
-    <li *ngFor="let party of parties | async">
-      {{party.name}}
-      <p>{{party.description}}</p>
-      <p>{{party.location}}</p>
-      <button (click)="removeParty(party)">X</button>
-    </li>
-  </ul>
-</div>
\ No newline at end of file
+<div></div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 89883d3d4d69fba6951fa662d87d2c07f492ca05 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:34:43 +0200
Subject: [PATCH 042/267] Step 5.5: Add PartiesList to parties declarations

---
 client/imports/app/parties/index.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/index.ts b/client/imports/app/parties/index.ts
index c5e7e18..06ca4d7 100644
--- a/client/imports/app/parties/index.ts
+++ b/client/imports/app/parties/index.ts
@@ -1,5 +1,7 @@
 import { PartiesFormComponent } from './parties-form.component';
+import { PartiesListComponent } from './parties-list.component';
 
 export const PARTIES_DECLARATIONS = [
-  PartiesFormComponent
+  PartiesFormComponent,
+  PartiesListComponent
 ];
-- 
2.7.4 (Apple Git-66)


From d738e6df01742300cf7224b88fc2b750b30ff1cd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:36:34 +0200
Subject: [PATCH 043/267] Step 5.6: Define routes

---
 client/imports/app/app.routes.ts | 7 +++++++
 1 file changed, 7 insertions(+)
 create mode 100644 client/imports/app/app.routes.ts

diff --git a/client/imports/app/app.routes.ts b/client/imports/app/app.routes.ts
new file mode 100644
index 0000000..8f6b8bb
--- /dev/null
+++ b/client/imports/app/app.routes.ts
@@ -0,0 +1,7 @@
+import { Route } from '@angular/router';
+
+import { PartiesListComponent } from './parties/parties-list.component';
+
+export const routes: Route[] = [
+  { path: '', component: PartiesListComponent }
+];
-- 
2.7.4 (Apple Git-66)


From 7979d22c0210cf6b74911aadd3110191bdb1a50f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:37:43 +0200
Subject: [PATCH 044/267] Step 5.7: Register RouterModule

---
 client/imports/app/app.module.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 8e8c303..192c630 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -1,15 +1,18 @@
 import { NgModule } from '@angular/core';
 import { BrowserModule } from '@angular/platform-browser';
 import { FormsModule, ReactiveFormsModule } from '@angular/forms';
+import { RouterModule } from '@angular/router';
 
 import { AppComponent } from './app.component';
+import { routes } from './app.routes';
 import { PARTIES_DECLARATIONS } from './parties';
 
 @NgModule({
   imports: [
     BrowserModule,
     FormsModule,
-    ReactiveFormsModule
+    ReactiveFormsModule,
+    RouterModule.forRoot(routes)
   ],
   declarations: [
     AppComponent,
-- 
2.7.4 (Apple Git-66)


From 84e3de7e83436b3e0ddba42e303916e9d84d3bc5 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:39:51 +0200
Subject: [PATCH 045/267] Step 5.8: Implement routerOutlet

---
 client/imports/app/app.component.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index 281c686..b426778 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1 +1,3 @@
-<div></div>
\ No newline at end of file
+<div>
+  <router-outlet></router-outlet>
+</div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 6c256204084b4c36137df9487caf7db0366d1c79 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:46:44 +0200
Subject: [PATCH 046/267] Step 5.9: Add PartyDetails component

---
 client/imports/app/parties/party-details.component.ts | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 client/imports/app/parties/party-details.component.ts

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
new file mode 100644
index 0000000..67c86ab
--- /dev/null
+++ b/client/imports/app/parties/party-details.component.ts
@@ -0,0 +1,9 @@
+import { Component } from '@angular/core';
+
+import template from './party-details.component.html';
+
+@Component({
+  selector: 'party-details',
+  template
+})
+export class PartyDetailsComponent {}
-- 
2.7.4 (Apple Git-66)


From 698f2dff676a0a1e2af642feb654cfe75b531385 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:47:24 +0200
Subject: [PATCH 047/267] Step 5.10: Create template for PartyDetails

---
 client/imports/app/parties/party-details.component.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 client/imports/app/parties/party-details.component.html

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
new file mode 100644
index 0000000..a3da9f4
--- /dev/null
+++ b/client/imports/app/parties/party-details.component.html
@@ -0,0 +1,5 @@
+<header>
+  <h2>PARTY_NAME</h2>
+
+  <p>PARTY_DESCRIPTION</p>
+</header>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From adf2c1dc02b18d4e65ef14802a7e0c86c1f84256 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:48:22 +0200
Subject: [PATCH 048/267] Step 5.11: Add component to declarations

---
 client/imports/app/app.routes.ts    | 4 +++-
 client/imports/app/parties/index.ts | 4 +++-
 2 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/client/imports/app/app.routes.ts b/client/imports/app/app.routes.ts
index 8f6b8bb..fef7277 100644
--- a/client/imports/app/app.routes.ts
+++ b/client/imports/app/app.routes.ts
@@ -1,7 +1,9 @@
 import { Route } from '@angular/router';
 
 import { PartiesListComponent } from './parties/parties-list.component';
+import { PartyDetailsComponent } from './parties/party-details.component';
 
 export const routes: Route[] = [
-  { path: '', component: PartiesListComponent }
+  { path: '', component: PartiesListComponent },
+  { path: 'party/:partyId', component: PartyDetailsComponent }
 ];
diff --git a/client/imports/app/parties/index.ts b/client/imports/app/parties/index.ts
index 06ca4d7..ae09066 100644
--- a/client/imports/app/parties/index.ts
+++ b/client/imports/app/parties/index.ts
@@ -1,7 +1,9 @@
 import { PartiesFormComponent } from './parties-form.component';
 import { PartiesListComponent } from './parties-list.component';
+import { PartyDetailsComponent } from './party-details.component';
 
 export const PARTIES_DECLARATIONS = [
   PartiesFormComponent,
-  PartiesListComponent
+  PartiesListComponent,
+  PartyDetailsComponent
 ];
-- 
2.7.4 (Apple Git-66)


From 8fa8363fa97d6462ff3a7aaae3a2cc4930d25e8d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:49:46 +0200
Subject: [PATCH 049/267] Step 5.12: Use routerLink in PartiesList component

---
 client/imports/app/parties/parties-list.component.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index 49136a9..488ba09 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -3,7 +3,7 @@
 
   <ul>
     <li *ngFor="let party of parties | async">
-      {{party.name}}
+      <a [routerLink]="['/party', party._id]">{{party.name}}</a>
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
       <button (click)="removeParty(party)">X</button>
-- 
2.7.4 (Apple Git-66)


From 96ce9a807b90ee011e6dae813082d3583c8bb432 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:52:55 +0200
Subject: [PATCH 050/267] Step 5.13: Subscribe to get the partyId

---
 client/imports/app/parties/party-details.component.ts | 19 +++++++++++++++++--
 1 file changed, 17 insertions(+), 2 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 67c86ab..55c5b8b 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -1,4 +1,7 @@
-import { Component } from '@angular/core';
+import { Component, OnInit } from '@angular/core';
+import { ActivatedRoute } from '@angular/router';
+
+import 'rxjs/add/operator/map';
 
 import template from './party-details.component.html';
 
@@ -6,4 +9,16 @@ import template from './party-details.component.html';
   selector: 'party-details',
   template
 })
-export class PartyDetailsComponent {}
+export class PartyDetailsComponent implements OnInit {
+  partyId: string;
+
+  constructor(
+    private route: ActivatedRoute
+  ) {}
+
+  ngOnInit() {
+    this.route.params
+      .map(params => params['partyId'])
+      .subscribe(partyId => this.partyId = partyId);
+  }
+}
-- 
2.7.4 (Apple Git-66)


From b274c1ec297a22225978169a3b69b0850e94adff Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:54:26 +0200
Subject: [PATCH 051/267] Step 5.14: Unsubscribe when component is being
 destroyed

---
 client/imports/app/parties/party-details.component.ts | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 55c5b8b..1f2562b 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -1,5 +1,6 @@
-import { Component, OnInit } from '@angular/core';
+import { Component, OnInit, OnDestroy } from '@angular/core';
 import { ActivatedRoute } from '@angular/router';
+import { Subscription } from 'rxjs/Subscription';
 
 import 'rxjs/add/operator/map';
 
@@ -9,16 +10,21 @@ import template from './party-details.component.html';
   selector: 'party-details',
   template
 })
-export class PartyDetailsComponent implements OnInit {
+export class PartyDetailsComponent implements OnInit, OnDestroy {
   partyId: string;
+  paramsSub: Subscription;
 
   constructor(
     private route: ActivatedRoute
   ) {}
 
   ngOnInit() {
-    this.route.params
+    this.paramsSub = this.route.params
       .map(params => params['partyId'])
       .subscribe(partyId => this.partyId = partyId);
   }
+
+  ngOnDestroy() {
+    this.paramsSub.unsubscribe();
+  }
 }
-- 
2.7.4 (Apple Git-66)


From cd7e5d45cb48ec974ded5e2a0e6a4bb079be00ca Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:57:48 +0200
Subject: [PATCH 052/267] Step 5.15: Load party details

---
 client/imports/app/parties/party-details.component.ts | 12 ++++++++++--
 1 file changed, 10 insertions(+), 2 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 1f2562b..6c53448 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -1,9 +1,12 @@
 import { Component, OnInit, OnDestroy } from '@angular/core';
 import { ActivatedRoute } from '@angular/router';
-import { Subscription } from 'rxjs/Subscription';
+import { Subscription } from 'rxjs/Subscription'; 
 
 import 'rxjs/add/operator/map';
 
+import { Parties } from '../../../../both/collections/parties.collection';
+import { Party } from '../../../../both/models/party.model';
+
 import template from './party-details.component.html';
 
 @Component({
@@ -13,6 +16,7 @@ import template from './party-details.component.html';
 export class PartyDetailsComponent implements OnInit, OnDestroy {
   partyId: string;
   paramsSub: Subscription;
+  party: Party;
 
   constructor(
     private route: ActivatedRoute
@@ -21,7 +25,11 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
   ngOnInit() {
     this.paramsSub = this.route.params
       .map(params => params['partyId'])
-      .subscribe(partyId => this.partyId = partyId);
+      .subscribe(partyId => {
+        this.partyId = partyId
+        
+        this.party = Parties.findOne(this.partyId);
+      });
   }
 
   ngOnDestroy() {
-- 
2.7.4 (Apple Git-66)


From db17b7a12aa7ddb121c1dc08a5f0ac3b20c758e1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:57:57 +0200
Subject: [PATCH 053/267] Step 6.1: Display party details

---
 client/imports/app/parties/party-details.component.html | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index a3da9f4..d6fd3fb 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -1,5 +1,7 @@
-<header>
-  <h2>PARTY_NAME</h2>
+<header *ngIf="party">
+  <h2>{{party.name}}</h2>
 
-  <p>PARTY_DESCRIPTION</p>
+  <p>{{party.description}}</p>
+
+  <p>{{party.location}}</p>
 </header>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 0c4b2c546425ebdc7de1479bf87e5d6366f58cf5 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 18:58:51 +0200
Subject: [PATCH 054/267] Step 6.2: Create form inside PartyDetails template

---
 client/imports/app/parties/party-details.component.html | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index d6fd3fb..aef5bae 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -1,7 +1,13 @@
-<header *ngIf="party">
-  <h2>{{party.name}}</h2>
+<form *ngIf="party" (submit)="saveParty()">
+  <label>Name</label>
+  <input type="text" [(ngModel)]="party.name" name="name">
 
-  <p>{{party.description}}</p>
+  <label>Description</label>
+  <input type="text" [(ngModel)]="party.description" name="description">
 
-  <p>{{party.location}}</p>
-</header>
\ No newline at end of file
+  <label>Location</label>
+  <input type="text" [(ngModel)]="party.location" name="location">
+
+  <button type="submit">Save</button>
+  <a [routerLink]="['/']">Cancel</a>
+</form>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From da7a7e44fb289abd77984a238c648f6310e5c4b2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 19:01:57 +0200
Subject: [PATCH 055/267] Step 6.3: Add submit event handler

---
 client/imports/app/parties/party-details.component.ts | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 6c53448..3abaa71 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -32,6 +32,16 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
       });
   }
 
+  saveParty() {
+    Parties.update(this.party._id, {
+      $set: {
+        name: this.party.name,
+        description: this.party.description,
+        location: this.party.location
+      }
+    });
+  }
+
   ngOnDestroy() {
     this.paramsSub.unsubscribe();
   }
-- 
2.7.4 (Apple Git-66)


From 59944680222065d9dff67c3224cab6172300e0d7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 20:40:52 +0200
Subject: [PATCH 056/267] Step 8.1: Add accounts

---
 .meteor/packages |  2 +-
 .meteor/versions | 11 ++++++++++-
 package.json     |  1 +
 3 files changed, 12 insertions(+), 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index cd12a6f..eb89681 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -16,10 +16,10 @@ standard-minifier-js@1.2.0    # JS minifier run for production mode
 es5-shim@4.6.14                # ECMAScript 5 compatibility for older browsers.
 
 autopublish@1.0.7             # Publish all data to the clients (for prototyping)
-insecure@1.0.7                # Allow all DB writes from clients (for prototyping)
 angular2-compilers
 practicalmeteor:mocha
 xolvio:cleaner
 hwillson:stub-collections
 dispatch:mocha-phantomjs
 shell-server
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index 9886afc..a935b08 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+accounts-base@1.2.11
+accounts-password@1.3.0
 allow-deny@1.0.5
 angular2-compilers@0.6.1
 autopublish@1.0.7
@@ -22,6 +24,7 @@ coffeescript@1.1.4
 ddp@1.2.5
 ddp-client@1.2.9
 ddp-common@1.2.6
+ddp-rate-limiter@1.0.5
 ddp-server@1.2.10
 deps@1.0.12
 diff-sequence@1.0.6
@@ -30,6 +33,7 @@ dispatch:phantomjs-tests@0.0.5
 ecmascript@0.5.8
 ecmascript-runtime@0.3.14
 ejson@1.0.12
+email@1.1.17
 es5-shim@4.6.14
 fastclick@1.0.12
 geojson-utils@1.0.9
@@ -39,10 +43,10 @@ htmljs@1.0.11
 http@1.1.8
 hwillson:stub-collections@1.0.1
 id-map@1.0.8
-insecure@1.0.7
 jquery@1.11.9
 launch-screen@1.0.12
 livedata@1.0.18
+localstorage@1.0.11
 logging@1.1.15
 meteor@1.2.17
 meteor-base@1.0.4
@@ -55,6 +59,7 @@ modules@0.7.6
 modules-runtime@0.7.6
 mongo@1.1.12
 mongo-id@1.0.5
+npm-bcrypt@0.9.1
 npm-mongo@1.5.49
 observe-sequence@1.0.12
 ordered-dict@1.0.8
@@ -65,13 +70,17 @@ practicalmeteor:mocha-core@1.0.1
 practicalmeteor:sinon@1.14.1_2
 promise@0.8.7
 random@1.0.10
+rate-limit@1.0.5
 reactive-var@1.0.10
 reload@1.1.10
 retry@1.0.8
 routepolicy@1.0.11
+service-configuration@1.0.10
+sha@1.0.8
 shell-server@0.2.1
 spacebars@1.0.13
 spacebars-compiler@1.0.13
+srp@1.0.9
 standard-minifier-css@1.2.0
 standard-minifier-js@1.2.0
 templating@1.1.14
diff --git a/package.json b/package.json
index ebb7b4b..ae890b2 100644
--- a/package.json
+++ b/package.json
@@ -25,6 +25,7 @@
     "@angular/platform-browser-dynamic": "2.0.1",
     "@angular/router": "3.0.1",
     "angular2-meteor": "0.7.0",
+    "angular2-meteor-accounts-ui": "0.8.0",
     "angular2-meteor-polyfills": "^0.1.1",
     "angular2-meteor-tests-polyfills": "0.0.2",
     "meteor-node-stubs": "0.2.3",
-- 
2.7.4 (Apple Git-66)


From e14d338b8d9ed6e3e0f9282bd2edc61ff02702fc Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 20:41:37 +0200
Subject: [PATCH 057/267] Step 8.2: Import AccountsModule

---
 client/imports/app/app.module.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 192c630..1e7e1ac 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -2,6 +2,7 @@ import { NgModule } from '@angular/core';
 import { BrowserModule } from '@angular/platform-browser';
 import { FormsModule, ReactiveFormsModule } from '@angular/forms';
 import { RouterModule } from '@angular/router';
+import { AccountsModule } from 'angular2-meteor-accounts-ui';
 
 import { AppComponent } from './app.component';
 import { routes } from './app.routes';
@@ -12,7 +13,8 @@ import { PARTIES_DECLARATIONS } from './parties';
     BrowserModule,
     FormsModule,
     ReactiveFormsModule,
-    RouterModule.forRoot(routes)
+    RouterModule.forRoot(routes),
+    AccountsModule
   ],
   declarations: [
     AppComponent,
-- 
2.7.4 (Apple Git-66)


From 3fdea26da221241962e11ce41de731754592c084 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 20:42:08 +0200
Subject: [PATCH 058/267] Step 8.3: Use LoginButtons component

---
 client/imports/app/parties/parties-list.component.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index 488ba09..20400c4 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -1,5 +1,6 @@
 <div>
   <parties-form></parties-form>
+  <login-buttons></login-buttons>
 
   <ul>
     <li *ngFor="let party of parties | async">
-- 
2.7.4 (Apple Git-66)


From 833af770bb9cfd9131e25b6c9d0eacc9f3a9ab85 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 20:42:25 +0200
Subject: [PATCH 059/267] Step 8.4: Import styles

---
 client/main.scss | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/main.scss

diff --git a/client/main.scss b/client/main.scss
new file mode 100644
index 0000000..ac0e5ee
--- /dev/null
+++ b/client/main.scss
@@ -0,0 +1 @@
+@import "{}/node_modules/angular2-meteor-accounts-ui/build/login-buttons.scss";
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From d98072045623f1da2303f2e21212539ec189b8b7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 21:20:37 +0200
Subject: [PATCH 060/267] Step 8.5: Add Parties collection security

---
 both/collections/parties.collection.ts | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/both/collections/parties.collection.ts b/both/collections/parties.collection.ts
index 8146c60..731b244 100644
--- a/both/collections/parties.collection.ts
+++ b/both/collections/parties.collection.ts
@@ -1,5 +1,16 @@
 import { MongoObservable } from 'meteor-rxjs';
+import { Meteor } from 'meteor/meteor';
 
 import { Party } from '../models/party.model';
 
 export const Parties = new MongoObservable.Collection<Party>('parties');
+
+function loggedIn() {
+  return !!Meteor.user();
+}
+
+Parties.allow({
+  insert: loggedIn,
+  update: loggedIn,
+  remove: loggedIn
+});
-- 
2.7.4 (Apple Git-66)


From 97f66b3e089c3699c3146a8b07aace47ee7413f8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 21:27:52 +0200
Subject: [PATCH 061/267] Step 8.6: Check access in PartiesForm

---
 client/imports/app/parties/parties-form.component.ts | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/imports/app/parties/parties-form.component.ts b/client/imports/app/parties/parties-form.component.ts
index 511812d..565cf77 100644
--- a/client/imports/app/parties/parties-form.component.ts
+++ b/client/imports/app/parties/parties-form.component.ts
@@ -1,5 +1,6 @@
 import { Component, OnInit } from '@angular/core';
 import { FormGroup, FormBuilder, Validators } from '@angular/forms';
+import { Meteor } from 'meteor/meteor';
 
 import { Parties } from '../../../../both/collections/parties.collection';
 
@@ -25,6 +26,11 @@ export class PartiesFormComponent implements OnInit {
   }
 
   addParty(): void {
+    if (!Meteor.userId()) {
+      alert('Please log in to add a party');
+      return;
+    }
+
     if (this.addForm.valid) {
       Parties.insert(this.addForm.value);
 
-- 
2.7.4 (Apple Git-66)


From 45a121acea0a3a754130857f3323d2124e9c62d3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 21:30:05 +0200
Subject: [PATCH 062/267] Step 8.7: Add owner

---
 client/imports/app/parties/parties-form.component.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-form.component.ts b/client/imports/app/parties/parties-form.component.ts
index 565cf77..978f6e4 100644
--- a/client/imports/app/parties/parties-form.component.ts
+++ b/client/imports/app/parties/parties-form.component.ts
@@ -32,7 +32,7 @@ export class PartiesFormComponent implements OnInit {
     }
 
     if (this.addForm.valid) {
-      Parties.insert(this.addForm.value);
+      Parties.insert(Object.assign({}, this.addForm.value, { owner: Meteor.userId() }));
 
       this.addForm.reset();
     }
-- 
2.7.4 (Apple Git-66)


From 6098101d78f306197e4b8ca06fab56e5cf368b83 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 21:30:44 +0200
Subject: [PATCH 063/267] Step 8.8: Define owner in Party type

---
 both/models/party.model.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/both/models/party.model.ts b/both/models/party.model.ts
index fd5a709..5b20610 100644
--- a/both/models/party.model.ts
+++ b/both/models/party.model.ts
@@ -4,4 +4,5 @@ export interface Party extends CollectionObject {
   name: string;
   description: string;
   location: string;
+  owner?: string; 
 }
-- 
2.7.4 (Apple Git-66)


From 30e1c881d0d329fa70167adbf3be9af5a02a3711 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 21:32:09 +0200
Subject: [PATCH 064/267] Step 8.9: Check access to update a party

---
 client/imports/app/parties/party-details.component.ts | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 3abaa71..0032c65 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -1,6 +1,7 @@
 import { Component, OnInit, OnDestroy } from '@angular/core';
 import { ActivatedRoute } from '@angular/router';
-import { Subscription } from 'rxjs/Subscription'; 
+import { Subscription } from 'rxjs/Subscription';
+import { Meteor } from 'meteor/meteor'; 
 
 import 'rxjs/add/operator/map';
 
@@ -33,6 +34,11 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
   }
 
   saveParty() {
+    if (!Meteor.userId()) {
+      alert('Please log in to change this party');
+      return;
+    }
+    
     Parties.update(this.party._id, {
       $set: {
         name: this.party.name,
-- 
2.7.4 (Apple Git-66)


From 18918903dc16d44daec36e85414f569912a15e85 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 21:37:13 +0200
Subject: [PATCH 065/267] Step 8.10: Require user to access PartyDetails

---
 client/imports/app/app.routes.ts | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.routes.ts b/client/imports/app/app.routes.ts
index fef7277..c5812a4 100644
--- a/client/imports/app/app.routes.ts
+++ b/client/imports/app/app.routes.ts
@@ -1,9 +1,15 @@
 import { Route } from '@angular/router';
+import { Meteor } from 'meteor/meteor';
 
 import { PartiesListComponent } from './parties/parties-list.component';
 import { PartyDetailsComponent } from './parties/party-details.component';
 
 export const routes: Route[] = [
   { path: '', component: PartiesListComponent },
-  { path: 'party/:partyId', component: PartyDetailsComponent }
+  { path: 'party/:partyId', component: PartyDetailsComponent, canActivate: ['canActivateForLoggedIn'] }
 ];
+
+export const ROUTES_PROVIDERS = [{
+  provide: 'canActivateForLoggedIn',
+  useValue: () => !! Meteor.userId()
+}];
-- 
2.7.4 (Apple Git-66)


From 5334dced24c3ad10a1290c9f530b4e493dfe5a71 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Wed, 21 Sep 2016 21:37:31 +0200
Subject: [PATCH 066/267] Step 8.11: Add ROUTES_PROVIDERS

---
 client/imports/app/app.module.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 1e7e1ac..139b880 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -5,7 +5,7 @@ import { RouterModule } from '@angular/router';
 import { AccountsModule } from 'angular2-meteor-accounts-ui';
 
 import { AppComponent } from './app.component';
-import { routes } from './app.routes';
+import { routes, ROUTES_PROVIDERS } from './app.routes';
 import { PARTIES_DECLARATIONS } from './parties';
 
 @NgModule({
@@ -20,6 +20,9 @@ import { PARTIES_DECLARATIONS } from './parties';
     AppComponent,
     ...PARTIES_DECLARATIONS
   ],
+  providers: [
+    ...ROUTES_PROVIDERS
+  ],
   bootstrap: [
     AppComponent
   ]
-- 
2.7.4 (Apple Git-66)


From fb9266a7c5fd34fdecd4ac2342347824e649561b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 12:54:25 +0200
Subject: [PATCH 067/267] Step 9.1: Remove autopublish package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index eb89681..27a491b 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -15,7 +15,6 @@ standard-minifier-css@1.2.0   # CSS minifier run for production mode
 standard-minifier-js@1.2.0    # JS minifier run for production mode
 es5-shim@4.6.14                # ECMAScript 5 compatibility for older browsers.
 
-autopublish@1.0.7             # Publish all data to the clients (for prototyping)
 angular2-compilers
 practicalmeteor:mocha
 xolvio:cleaner
diff --git a/.meteor/versions b/.meteor/versions
index a935b08..749f684 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -2,7 +2,6 @@ accounts-base@1.2.11
 accounts-password@1.3.0
 allow-deny@1.0.5
 angular2-compilers@0.6.1
-autopublish@1.0.7
 autoupdate@1.2.11
 babel-compiler@6.9.1
 babel-runtime@0.1.11
-- 
2.7.4 (Apple Git-66)


From 40b65825d7a10ccf1576fb995a7362a8ca48c313 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 12:56:22 +0200
Subject: [PATCH 068/267] Step 9.2: Publish Parties collection

---
 server/imports/publications/parties.ts | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 server/imports/publications/parties.ts

diff --git a/server/imports/publications/parties.ts b/server/imports/publications/parties.ts
new file mode 100644
index 0000000..08ef863
--- /dev/null
+++ b/server/imports/publications/parties.ts
@@ -0,0 +1,4 @@
+import { Meteor } from 'meteor/meteor';
+import { Parties } from '../../../both/collections/parties.collection';
+
+Meteor.publish('parties', () => Parties.find());
-- 
2.7.4 (Apple Git-66)


From f84cf91436f30ac9f9bff7eea0bc8c6a52fa7b40 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 12:57:35 +0200
Subject: [PATCH 069/267] Step 9.3: Add publication to server-side entry point

---
 server/main.ts | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/server/main.ts b/server/main.ts
index cf58a8d..7f8e626 100644
--- a/server/main.ts
+++ b/server/main.ts
@@ -2,6 +2,8 @@ import { Meteor } from 'meteor/meteor';
 
 import { loadParties } from './imports/fixtures/parties';
 
+import './imports/publications/parties'; 
+
 Meteor.startup(() => {
   loadParties();
 });
-- 
2.7.4 (Apple Git-66)


From bd8e86f4868e4a0fd6757b721a19f1f4bdb74991 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 13:54:06 +0200
Subject: [PATCH 070/267] Step 9.4: Subscribe to Parties publication

---
 client/imports/app/parties/parties-list.component.ts | 14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index bb09b1c..93be382 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -1,5 +1,7 @@
-import { Component } from '@angular/core';
+import { Component, OnInit, OnDestroy } from '@angular/core';
 import { Observable } from 'rxjs/Observable';
+import { Subscription } from 'rxjs/Subscription';
+import { MeteorObservable } from 'meteor-rxjs';
 
 import { Parties } from '../../../../both/collections/parties.collection';
 import { Party } from '../../../../both/models/party.model';
@@ -10,14 +12,20 @@ import template from './parties-list.component.html';
   selector: 'parties-list',
   template
 })
-export class PartiesListComponent {
+export class PartiesListComponent implements OnInit, OnDestroy {
   parties: Observable<Party[]>;
+  partiesSub: Subscription;
 
-  constructor() {
+  ngOnInit() {
     this.parties = Parties.find({}).zone();
+    this.partiesSub = MeteorObservable.subscribe('parties').subscribe();
   }
 
   removeParty(party: Party): void {
     Parties.remove(party._id);
   }
+
+  ngOnDestroy() {
+    this.partiesSub.unsubscribe();
+  }
 }
-- 
2.7.4 (Apple Git-66)


From 4063e0675fc2d92feb89f6c806df05ba0a39b8dc Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:02:19 +0200
Subject: [PATCH 071/267] Step 9.5: Add checkbox for public property

---
 client/imports/app/parties/parties-form.component.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/imports/app/parties/parties-form.component.html b/client/imports/app/parties/parties-form.component.html
index 98f90ca..3cc8990 100644
--- a/client/imports/app/parties/parties-form.component.html
+++ b/client/imports/app/parties/parties-form.component.html
@@ -7,6 +7,9 @@
 
   <label>Location</label>
   <input type="text" formControlName="location">
+
+  <label>Public</label>
+  <input type="checkbox" formControlName="public">
   
   <button type="submit">Add</button>
 </form>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 3fc01445c3d92c5ac456418061b2576ef049a7e8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:05:09 +0200
Subject: [PATCH 072/267] Step 9.6: Update Party interface

---
 both/models/party.model.ts | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/both/models/party.model.ts b/both/models/party.model.ts
index 5b20610..2526c11 100644
--- a/both/models/party.model.ts
+++ b/both/models/party.model.ts
@@ -4,5 +4,6 @@ export interface Party extends CollectionObject {
   name: string;
   description: string;
   location: string;
-  owner?: string; 
+  owner?: string;
+  public: boolean;
 }
-- 
2.7.4 (Apple Git-66)


From a4bceb060dbbd4905ef6f844f6fc26095df86538 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:05:26 +0200
Subject: [PATCH 073/267] Step 9.7: Update parties initials

---
 server/imports/fixtures/parties.ts | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/server/imports/fixtures/parties.ts b/server/imports/fixtures/parties.ts
index 4f6d555..e49a665 100644
--- a/server/imports/fixtures/parties.ts
+++ b/server/imports/fixtures/parties.ts
@@ -6,15 +6,18 @@ export function loadParties() {
     const parties: Party[] = [{
       name: 'Dubstep-Free Zone',
       description: 'Can we please just for an evening not listen to dubstep.',
-      location: 'Palo Alto'
+      location: 'Palo Alto',
+      public: true
     }, {
       name: 'All dubstep all the time',
       description: 'Get it on!',
-      location: 'Palo Alto'
+      location: 'Palo Alto',
+      public: true
     }, {
       name: 'Savage lounging',
       description: 'Leisure suit required. And only fiercest manners.',
-      location: 'San Francisco'
+      location: 'San Francisco',
+      public: true
     }];
 
     parties.forEach((party: Party) => Parties.insert(party));
-- 
2.7.4 (Apple Git-66)


From c02856cdf74d6a2419af5a0714e31d8dc6601f95 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:06:19 +0200
Subject: [PATCH 074/267] Step 9.8: Add public property to form builder

---
 client/imports/app/parties/parties-form.component.ts | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-form.component.ts b/client/imports/app/parties/parties-form.component.ts
index 978f6e4..0823749 100644
--- a/client/imports/app/parties/parties-form.component.ts
+++ b/client/imports/app/parties/parties-form.component.ts
@@ -21,7 +21,8 @@ export class PartiesFormComponent implements OnInit {
     this.addForm = this.formBuilder.group({
       name: ['', Validators.required],
       description: [],
-      location: ['', Validators.required]
+      location: ['', Validators.required],
+      public: [false]
     });
   }
 
-- 
2.7.4 (Apple Git-66)


From db42519c1d3e1c734fc43ba4d997ad5dbe0bb42f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:09:53 +0200
Subject: [PATCH 075/267] Step 9.9: Limit data sent to the client

---
 server/imports/publications/parties.ts | 22 +++++++++++++++++++++-
 1 file changed, 21 insertions(+), 1 deletion(-)

diff --git a/server/imports/publications/parties.ts b/server/imports/publications/parties.ts
index 08ef863..b7652bb 100644
--- a/server/imports/publications/parties.ts
+++ b/server/imports/publications/parties.ts
@@ -1,4 +1,24 @@
 import { Meteor } from 'meteor/meteor';
 import { Parties } from '../../../both/collections/parties.collection';
 
-Meteor.publish('parties', () => Parties.find());
+Meteor.publish('parties', function() {
+  const selector = {
+    $or: [{
+      // party is public
+      public: true
+    },
+    // or
+    { 
+      // current user is the owner
+      $and: [{
+        owner: this.userId 
+      }, {
+        owner: {
+          $exists: true
+        }
+      }]
+    }]
+  };
+
+  return Parties.find(selector);
+});
-- 
2.7.4 (Apple Git-66)


From 30da14f08ce024db865757e20ac6ec2d53bb89c4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:13:28 +0200
Subject: [PATCH 076/267] Step 9.10: Add party publication

---
 server/imports/publications/parties.ts | 26 +++++++++++++++++++++++---
 1 file changed, 23 insertions(+), 3 deletions(-)

diff --git a/server/imports/publications/parties.ts b/server/imports/publications/parties.ts
index b7652bb..5314c57 100644
--- a/server/imports/publications/parties.ts
+++ b/server/imports/publications/parties.ts
@@ -2,7 +2,16 @@ import { Meteor } from 'meteor/meteor';
 import { Parties } from '../../../both/collections/parties.collection';
 
 Meteor.publish('parties', function() {
-  const selector = {
+  return Parties.find(buildQuery.call(this));
+});
+
+Meteor.publish('party', function(partyId: string) {
+  return Parties.find(buildQuery.call(this, partyId));
+});
+
+
+function buildQuery(partyId?: string): Object {
+  const isAvailable = {
     $or: [{
       // party is public
       public: true
@@ -20,5 +29,16 @@ Meteor.publish('parties', function() {
     }]
   };
 
-  return Parties.find(selector);
-});
+  if (partyId) {
+    return {
+      // only single party
+      $and: [{
+          _id: partyId
+        },
+        isAvailable
+      ]
+    };
+  }
+
+  return isAvailable;
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From a2e5f4603c2d69aa0c970afdb2af5f0c613660e6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:22:47 +0200
Subject: [PATCH 077/267] Step 9.11: Subscribe to the party publication

---
 client/imports/app/parties/party-details.component.ts | 15 ++++++++++++---
 1 file changed, 12 insertions(+), 3 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 0032c65..20bf309 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -1,7 +1,8 @@
 import { Component, OnInit, OnDestroy } from '@angular/core';
 import { ActivatedRoute } from '@angular/router';
 import { Subscription } from 'rxjs/Subscription';
-import { Meteor } from 'meteor/meteor'; 
+import { Meteor } from 'meteor/meteor';
+import { MeteorObservable } from 'meteor-rxjs';
 
 import 'rxjs/add/operator/map';
 
@@ -18,6 +19,7 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
   partyId: string;
   paramsSub: Subscription;
   party: Party;
+  partySub: Subscription;
 
   constructor(
     private route: ActivatedRoute
@@ -27,9 +29,15 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
     this.paramsSub = this.route.params
       .map(params => params['partyId'])
       .subscribe(partyId => {
-        this.partyId = partyId
+        this.partyId = partyId;
         
-        this.party = Parties.findOne(this.partyId);
+        if (this.partySub) {
+          this.partySub.unsubscribe();
+        }
+
+        this.partySub = MeteorObservable.subscribe('party', this.partyId).zone().subscribe(() => {
+          this.party = Parties.findOne(this.partyId);
+        });
       });
   }
 
@@ -50,5 +58,6 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
 
   ngOnDestroy() {
     this.paramsSub.unsubscribe();
+    this.partySub.unsubscribe();
   }
 }
-- 
2.7.4 (Apple Git-66)


From 5816ac0cd774ba0f02a1197d29e5886238b3c833 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:24:27 +0200
Subject: [PATCH 078/267] Step 9.12: Add search input

---
 client/imports/app/parties/parties-list.component.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index 20400c4..bd2f99c 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -1,5 +1,8 @@
 <div>
-  <parties-form></parties-form>
+  <parties-form style="float: left"></parties-form>
+  <input type="text" #searchtext placeholder="Search by Location">
+  <button type="button" (click)="search(searchtext.value)">Search</button>
+  
   <login-buttons></login-buttons>
 
   <ul>
-- 
2.7.4 (Apple Git-66)


From 0624d3096716dfef78707114b6ccd9c169f70071 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:37:54 +0200
Subject: [PATCH 079/267] Step 9.13: Add search method

---
 client/imports/app/parties/parties-list.component.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index 93be382..b80de38 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -25,6 +25,10 @@ export class PartiesListComponent implements OnInit, OnDestroy {
     Parties.remove(party._id);
   }
 
+  search(value: string): void {
+    this.parties = Parties.find(value ? { location: value } : {}).zone();
+  }
+
   ngOnDestroy() {
     this.partiesSub.unsubscribe();
   }
-- 
2.7.4 (Apple Git-66)


From cb0820b9b65c99540cbb7ed4c34e69e289033207 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Thu, 22 Sep 2016 14:37:40 +0200
Subject: [PATCH 080/267] Step 12.1: Add options to the parties publication

---
 server/imports/publications/parties.ts | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/server/imports/publications/parties.ts b/server/imports/publications/parties.ts
index 5314c57..1e5d5df 100644
--- a/server/imports/publications/parties.ts
+++ b/server/imports/publications/parties.ts
@@ -1,8 +1,12 @@
 import { Meteor } from 'meteor/meteor';
 import { Parties } from '../../../both/collections/parties.collection';
 
-Meteor.publish('parties', function() {
-  return Parties.find(buildQuery.call(this));
+interface Options {
+  [key: string]: any;
+}
+
+Meteor.publish('parties', function(options: Options) {
+  return Parties.find(buildQuery.call(this), options);
 });
 
 Meteor.publish('party', function(partyId: string) {
-- 
2.7.4 (Apple Git-66)


From 770cba9c4be3fcb5406da0de0e9baeea35cd8a9b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:24:11 +0200
Subject: [PATCH 081/267] Step 12.2: Define options and use it in the
 subscription

---
 .../imports/app/parties/parties-list.component.ts  | 23 ++++++++++++++++++++--
 1 file changed, 21 insertions(+), 2 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index b80de38..32991d7 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -8,6 +8,15 @@ import { Party } from '../../../../both/models/party.model';
 
 import template from './parties-list.component.html';
 
+interface Pagination {
+  limit: number;
+  skip: number;
+}
+
+interface Options extends Pagination {
+  [key: string]: any
+}
+
 @Component({
   selector: 'parties-list',
   template
@@ -15,10 +24,20 @@ import template from './parties-list.component.html';
 export class PartiesListComponent implements OnInit, OnDestroy {
   parties: Observable<Party[]>;
   partiesSub: Subscription;
+  pageSize: number = 10;
+  curPage: number = 1;
+  nameOrder: number = 1;
 
   ngOnInit() {
-    this.parties = Parties.find({}).zone();
-    this.partiesSub = MeteorObservable.subscribe('parties').subscribe();
+    const options: Options = {
+      limit: this.pageSize,
+      skip: (this.curPage - 1) * this.pageSize,
+      sort: { name: this.nameOrder }
+    };
+
+    this.partiesSub = MeteorObservable.subscribe('parties', options).zone().subscribe(() => {
+      this.parties = Parties.find({}).zone();
+    });
   }
 
   removeParty(party: Party): void {
-- 
2.7.4 (Apple Git-66)


From d11acbeed19c6dc316d9d4f4abf4403633a479c7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:27:05 +0200
Subject: [PATCH 082/267] Step 12.3: Add sorting by party name to PartiesList

---
 client/imports/app/parties/parties-list.component.ts | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index 32991d7..86edf99 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -36,7 +36,11 @@ export class PartiesListComponent implements OnInit, OnDestroy {
     };
 
     this.partiesSub = MeteorObservable.subscribe('parties', options).zone().subscribe(() => {
-      this.parties = Parties.find({}).zone();
+      this.parties = Parties.find({}, {
+        sort: {
+          name: this.nameOrder
+        }
+      }).zone();
     });
   }
 
-- 
2.7.4 (Apple Git-66)


From d464eb31e63cd2d186337bde2f8ca4678ea07c65 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:29:02 +0200
Subject: [PATCH 083/267] Step 12.4: Turn primitive values into Subjects

---
 client/imports/app/parties/parties-list.component.ts | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index 86edf99..1c6cb18 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -1,5 +1,6 @@
 import { Component, OnInit, OnDestroy } from '@angular/core';
 import { Observable } from 'rxjs/Observable';
+import { Subject } from 'rxjs/Subject';
 import { Subscription } from 'rxjs/Subscription';
 import { MeteorObservable } from 'meteor-rxjs';
 
@@ -24,9 +25,9 @@ interface Options extends Pagination {
 export class PartiesListComponent implements OnInit, OnDestroy {
   parties: Observable<Party[]>;
   partiesSub: Subscription;
-  pageSize: number = 10;
-  curPage: number = 1;
-  nameOrder: number = 1;
+  pageSize: Subject<number> = new Subject<number>();
+  curPage: Subject<number> = new Subject<number>();
+  nameOrder: Subject<number> = new Subject<number>();
 
   ngOnInit() {
     const options: Options = {
@@ -42,6 +43,10 @@ export class PartiesListComponent implements OnInit, OnDestroy {
         }
       }).zone();
     });
+
+    this.pageSize.next(10);
+    this.curPage.next(1);
+    this.nameOrder.next(1);
   }
 
   removeParty(party: Party): void {
-- 
2.7.4 (Apple Git-66)


From a25ad13a881a8d2dbed81b200c85ef1ebed8e1d7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:46:28 +0200
Subject: [PATCH 084/267] Step 12.5: Re-subscribe on current page changes

---
 .../imports/app/parties/parties-list.component.ts  | 38 +++++++++++++++-------
 1 file changed, 26 insertions(+), 12 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index 1c6cb18..33aec9d 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -4,6 +4,8 @@ import { Subject } from 'rxjs/Subject';
 import { Subscription } from 'rxjs/Subscription';
 import { MeteorObservable } from 'meteor-rxjs';
 
+import 'rxjs/add/operator/combineLatest';
+
 import { Parties } from '../../../../both/collections/parties.collection';
 import { Party } from '../../../../both/models/party.model';
 
@@ -28,20 +30,31 @@ export class PartiesListComponent implements OnInit, OnDestroy {
   pageSize: Subject<number> = new Subject<number>();
   curPage: Subject<number> = new Subject<number>();
   nameOrder: Subject<number> = new Subject<number>();
+  optionsSub: Subscription;
 
   ngOnInit() {
-    const options: Options = {
-      limit: this.pageSize,
-      skip: (this.curPage - 1) * this.pageSize,
-      sort: { name: this.nameOrder }
-    };
-
-    this.partiesSub = MeteorObservable.subscribe('parties', options).zone().subscribe(() => {
-      this.parties = Parties.find({}, {
-        sort: {
-          name: this.nameOrder
-        }
-      }).zone();
+    this.optionsSub = Observable.combineLatest(
+      this.pageSize,
+      this.curPage,
+      this.nameOrder
+    ).subscribe(([pageSize, curPage, nameOrder]) => {
+      const options: Options = {
+        limit: pageSize as number,
+        skip: ((curPage as number) - 1) * (pageSize as number),
+        sort: { name: nameOrder as number }
+      };
+
+      if (this.partiesSub) {
+        this.partiesSub.unsubscribe();
+      }
+      
+      this.partiesSub = MeteorObservable.subscribe('parties', options).zone().subscribe(() => {
+        this.parties = Parties.find({}, {
+          sort: {
+            name: nameOrder
+          }
+        }).zone();
+      });
     });
 
     this.pageSize.next(10);
@@ -59,5 +72,6 @@ export class PartiesListComponent implements OnInit, OnDestroy {
 
   ngOnDestroy() {
     this.partiesSub.unsubscribe();
+    this.optionsSub.unsubscribe();
   }
 }
-- 
2.7.4 (Apple Git-66)


From 35b108a7dc9ee09f14297f4bdb9a64d56d95cee1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:51:56 +0200
Subject: [PATCH 085/267] Step 12.6: Install ng2-pagination

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index ae890b2..2388711 100644
--- a/package.json
+++ b/package.json
@@ -30,6 +30,7 @@
     "angular2-meteor-tests-polyfills": "0.0.2",
     "meteor-node-stubs": "0.2.3",
     "meteor-rxjs": "0.2.3",
+    "ng2-pagination": "0.4.1",
     "reflect-metadata": "^0.1.8",
     "rxjs": "5.0.0-beta.12",
     "zone.js": "^0.6.21"
-- 
2.7.4 (Apple Git-66)


From 0e392dab044e404b14ddccce0430b945cd2a9e64 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:53:03 +0200
Subject: [PATCH 086/267] Step 12.7: Import Ng2PaginationModule

---
 client/imports/app/app.module.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 139b880..65145a8 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -3,6 +3,7 @@ import { BrowserModule } from '@angular/platform-browser';
 import { FormsModule, ReactiveFormsModule } from '@angular/forms';
 import { RouterModule } from '@angular/router';
 import { AccountsModule } from 'angular2-meteor-accounts-ui';
+import { Ng2PaginationModule } from 'ng2-pagination';
 
 import { AppComponent } from './app.component';
 import { routes, ROUTES_PROVIDERS } from './app.routes';
@@ -14,7 +15,8 @@ import { PARTIES_DECLARATIONS } from './parties';
     FormsModule,
     ReactiveFormsModule,
     RouterModule.forRoot(routes),
-    AccountsModule
+    AccountsModule,
+    Ng2PaginationModule
   ],
   declarations: [
     AppComponent,
-- 
2.7.4 (Apple Git-66)


From 6a267f8444328cbc29b1439343906a3e7810a044 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:54:54 +0200
Subject: [PATCH 087/267] Step 12.8: Register configuration of pagination

---
 client/imports/app/parties/parties-list.component.ts | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index 33aec9d..5f54bc6 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -3,6 +3,7 @@ import { Observable } from 'rxjs/Observable';
 import { Subject } from 'rxjs/Subject';
 import { Subscription } from 'rxjs/Subscription';
 import { MeteorObservable } from 'meteor-rxjs';
+import { PaginationService } from 'ng2-pagination';
 
 import 'rxjs/add/operator/combineLatest';
 
@@ -32,6 +33,10 @@ export class PartiesListComponent implements OnInit, OnDestroy {
   nameOrder: Subject<number> = new Subject<number>();
   optionsSub: Subscription;
 
+  constructor(
+    private paginationService: PaginationService
+  ) {}
+
   ngOnInit() {
     this.optionsSub = Observable.combineLatest(
       this.pageSize,
@@ -57,6 +62,13 @@ export class PartiesListComponent implements OnInit, OnDestroy {
       });
     });
 
+    this.paginationService.register({
+      id: this.paginationService.defaultId,
+      itemsPerPage: 10,
+      currentPage: 1,
+      totalItems: 30,
+    });
+
     this.pageSize.next(10);
     this.curPage.next(1);
     this.nameOrder.next(1);
-- 
2.7.4 (Apple Git-66)


From 4d15be8acdcaa49e05755078b64e1c65aa9b4b99 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:56:31 +0200
Subject: [PATCH 088/267] Step 12.9: Update current page when options change

---
 client/imports/app/parties/parties-list.component.ts | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index 5f54bc6..3a2d841 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -49,6 +49,8 @@ export class PartiesListComponent implements OnInit, OnDestroy {
         sort: { name: nameOrder as number }
       };
 
+      this.paginationService.setCurrentPage(this.paginationService.defaultId, curPage as number);
+
       if (this.partiesSub) {
         this.partiesSub.unsubscribe();
       }
-- 
2.7.4 (Apple Git-66)


From 612c9eac0ebc9e6dbbee488d516da3139762c4b8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:58:16 +0200
Subject: [PATCH 089/267] Step 12.10: Add pagination to the list

---
 client/imports/app/parties/parties-list.component.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index bd2f99c..d72d6f5 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -13,4 +13,6 @@
       <button (click)="removeParty(party)">X</button>
     </li>
   </ul>
+
+  <pagination-controls></pagination-controls>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 6b4465b3416f81dd2cf3799edd124071a7db2a7e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:58:41 +0200
Subject: [PATCH 090/267] Step 12.11: Add pageChange event binding

---
 client/imports/app/parties/parties-list.component.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index d72d6f5..4e998d4 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -14,5 +14,5 @@
     </li>
   </ul>
 
-  <pagination-controls></pagination-controls>
+  <pagination-controls (pageChange)="onPageChanged($event)"></pagination-controls>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From c7fdc3771fed6ac6893d713b70167a4ca5bc7110 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 12:59:27 +0200
Subject: [PATCH 091/267] Step 12.12: Add event handler for pageChange

---
 client/imports/app/parties/parties-list.component.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index 3a2d841..a4173f7 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -84,6 +84,10 @@ export class PartiesListComponent implements OnInit, OnDestroy {
     this.parties = Parties.find(value ? { location: value } : {}).zone();
   }
 
+  onPageChanged(page: number): void {
+    this.curPage.next(page);
+  }
+
   ngOnDestroy() {
     this.partiesSub.unsubscribe();
     this.optionsSub.unsubscribe();
-- 
2.7.4 (Apple Git-66)


From 08f41f4ab4a61105bfef8784c7bada330fb20989 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 13:01:25 +0200
Subject: [PATCH 092/267] Step 12.13: Add tmeasday:publish-counts

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 27a491b..4a92e64 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -22,3 +22,4 @@ hwillson:stub-collections
 dispatch:mocha-phantomjs
 shell-server
 accounts-password
+tmeasday:publish-counts
diff --git a/.meteor/versions b/.meteor/versions
index 749f684..f90fa45 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -84,6 +84,7 @@ standard-minifier-css@1.2.0
 standard-minifier-js@1.2.0
 templating@1.1.14
 templating-tools@1.0.5
+tmeasday:publish-counts@0.7.3
 tmeasday:test-reporter-helpers@0.2.1
 tracker@1.1.0
 ui@1.0.12
-- 
2.7.4 (Apple Git-66)


From b0b79a5a2a18edf853f6df11231942bb1c733561 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 13:15:05 +0200
Subject: [PATCH 093/267] Step 12.14: Publish total number of parties

---
 server/imports/publications/parties.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/server/imports/publications/parties.ts b/server/imports/publications/parties.ts
index 1e5d5df..f772e48 100644
--- a/server/imports/publications/parties.ts
+++ b/server/imports/publications/parties.ts
@@ -1,4 +1,6 @@
 import { Meteor } from 'meteor/meteor';
+import { Counts } from 'meteor/tmeasday:publish-counts';
+
 import { Parties } from '../../../both/collections/parties.collection';
 
 interface Options {
@@ -6,6 +8,8 @@ interface Options {
 }
 
 Meteor.publish('parties', function(options: Options) {
+  Counts.publish(this, 'numberOfParties', Parties.collection.find(buildQuery.call(this)), { noReady: true });
+
   return Parties.find(buildQuery.call(this), options);
 });
 
-- 
2.7.4 (Apple Git-66)


From 721eb135ed035ed33bb00c9c5965c3df81b1cb36 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 13:15:19 +0200
Subject: [PATCH 094/267] Step 12.15: Add declaration of counts package

---
 typings.d.ts | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/typings.d.ts b/typings.d.ts
index 1684801..b80dd63 100644
--- a/typings.d.ts
+++ b/typings.d.ts
@@ -1,4 +1,15 @@
 declare module '*.html' {
   const template: string;
   export default template;
-}
\ No newline at end of file
+}
+
+declare module 'meteor/tmeasday:publish-counts' {
+  import { Mongo } from 'meteor/mongo';
+  
+  interface CountsObject {
+    get(publicationName: string): number;
+    publish(context: any, publicationName: string, cursor: Mongo.Cursor, options: any): number;
+  }
+
+  export const Counts: CountsObject;
+}
-- 
2.7.4 (Apple Git-66)


From a65bf34c9bdd2c339d99e3863e2394f2ba216581 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 13:32:27 +0200
Subject: [PATCH 095/267] Step 12.16: Handle reactive updates of the parties
 total number

---
 client/imports/app/parties/parties-list.component.ts | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index a4173f7..fdff5b9 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -4,6 +4,7 @@ import { Subject } from 'rxjs/Subject';
 import { Subscription } from 'rxjs/Subscription';
 import { MeteorObservable } from 'meteor-rxjs';
 import { PaginationService } from 'ng2-pagination';
+import { Counts } from 'meteor/tmeasday:publish-counts';
 
 import 'rxjs/add/operator/combineLatest';
 
@@ -32,6 +33,8 @@ export class PartiesListComponent implements OnInit, OnDestroy {
   curPage: Subject<number> = new Subject<number>();
   nameOrder: Subject<number> = new Subject<number>();
   optionsSub: Subscription;
+  partiesSize: number = 0;
+  autorunSub: Subscription;
 
   constructor(
     private paginationService: PaginationService
@@ -68,12 +71,17 @@ export class PartiesListComponent implements OnInit, OnDestroy {
       id: this.paginationService.defaultId,
       itemsPerPage: 10,
       currentPage: 1,
-      totalItems: 30,
+      totalItems: this.partiesSize
     });
 
     this.pageSize.next(10);
     this.curPage.next(1);
     this.nameOrder.next(1);
+
+    this.autorunSub = MeteorObservable.autorun().zone().subscribe(() => {
+      this.partiesSize = Counts.get('numberOfParties');
+      this.paginationService.setTotalItems(this.paginationService.defaultId, this.partiesSize);
+    });
   }
 
   removeParty(party: Party): void {
@@ -91,5 +99,6 @@ export class PartiesListComponent implements OnInit, OnDestroy {
   ngOnDestroy() {
     this.partiesSub.unsubscribe();
     this.optionsSub.unsubscribe();
+    this.autorunSub.unsubscribe();
   }
 }
-- 
2.7.4 (Apple Git-66)


From e085cc05cd25cc213402fd8f400880073ba82b8b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 14:07:04 +0200
Subject: [PATCH 096/267] Step 12.17: Add the sort order dropdown

---
 client/imports/app/parties/parties-list.component.html | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index 4e998d4..f1083e3 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -5,6 +5,15 @@
   
   <login-buttons></login-buttons>
 
+  <h1>Parties:</h1>
+
+  <div>
+    <select #sort (change)="changeSortOrder(sort.value)">
+      <option value="1" selected>Ascending</option>
+      <option value="-1">Descending</option>
+    </select>
+  </div>
+
   <ul>
     <li *ngFor="let party of parties | async">
       <a [routerLink]="['/party', party._id]">{{party.name}}</a>
-- 
2.7.4 (Apple Git-66)


From 0b0cc6be56ddcbdb249303cf9127408344ffdb14 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 14:18:38 +0200
Subject: [PATCH 097/267] Step 12.18: Re-subscribe when sort order changes

---
 client/imports/app/parties/parties-list.component.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index fdff5b9..f764115 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -96,6 +96,10 @@ export class PartiesListComponent implements OnInit, OnDestroy {
     this.curPage.next(page);
   }
 
+  changeSortOrder(nameOrder: string): void {
+    this.nameOrder.next(parseInt(nameOrder));
+  }
+
   ngOnDestroy() {
     this.partiesSub.unsubscribe();
     this.optionsSub.unsubscribe();
-- 
2.7.4 (Apple Git-66)


From eb8058e421ea1a35f25b0cb5e68035b651093a00 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 14:30:35 +0200
Subject: [PATCH 098/267] Step 12.19: Add search by the party location using
 regex

---
 server/imports/publications/parties.ts | 20 +++++++++++++++-----
 1 file changed, 15 insertions(+), 5 deletions(-)

diff --git a/server/imports/publications/parties.ts b/server/imports/publications/parties.ts
index f772e48..34c9470 100644
--- a/server/imports/publications/parties.ts
+++ b/server/imports/publications/parties.ts
@@ -7,10 +7,12 @@ interface Options {
   [key: string]: any;
 }
 
-Meteor.publish('parties', function(options: Options) {
-  Counts.publish(this, 'numberOfParties', Parties.collection.find(buildQuery.call(this)), { noReady: true });
+Meteor.publish('parties', function(options: Options, location?: string) {
+  const selector = buildQuery.call(this, null, location);
 
-  return Parties.find(buildQuery.call(this), options);
+  Counts.publish(this, 'numberOfParties', Parties.collection.find(selector), { noReady: true });
+
+  return Parties.find(selector, options);
 });
 
 Meteor.publish('party', function(partyId: string) {
@@ -18,7 +20,7 @@ Meteor.publish('party', function(partyId: string) {
 });
 
 
-function buildQuery(partyId?: string): Object {
+function buildQuery(partyId?: string, location?: string): Object {
   const isAvailable = {
     $or: [{
       // party is public
@@ -48,5 +50,13 @@ function buildQuery(partyId?: string): Object {
     };
   }
 
-  return isAvailable;
+  const searchRegEx = { '$regex': '.*' + (location || '') + '.*', '$options': 'i' };
+
+  return {
+    $and: [{
+        location: searchRegEx
+      },
+      isAvailable
+    ]
+  };
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 36a50915fd1c24ce970d8777948dda3957c2e2d0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 14:33:46 +0200
Subject: [PATCH 099/267] Step 12.20: Add reactive search by location

---
 client/imports/app/parties/parties-list.component.ts | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index f764115..c992344 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -35,6 +35,7 @@ export class PartiesListComponent implements OnInit, OnDestroy {
   optionsSub: Subscription;
   partiesSize: number = 0;
   autorunSub: Subscription;
+  location: Subject<string> = new Subject<string>();
 
   constructor(
     private paginationService: PaginationService
@@ -44,8 +45,9 @@ export class PartiesListComponent implements OnInit, OnDestroy {
     this.optionsSub = Observable.combineLatest(
       this.pageSize,
       this.curPage,
-      this.nameOrder
-    ).subscribe(([pageSize, curPage, nameOrder]) => {
+      this.nameOrder,
+      this.location
+    ).subscribe(([pageSize, curPage, nameOrder, location]) => {
       const options: Options = {
         limit: pageSize as number,
         skip: ((curPage as number) - 1) * (pageSize as number),
@@ -58,7 +60,7 @@ export class PartiesListComponent implements OnInit, OnDestroy {
         this.partiesSub.unsubscribe();
       }
       
-      this.partiesSub = MeteorObservable.subscribe('parties', options).zone().subscribe(() => {
+      this.partiesSub = MeteorObservable.subscribe('parties', options, location).zone().subscribe(() => {
         this.parties = Parties.find({}, {
           sort: {
             name: nameOrder
@@ -77,6 +79,7 @@ export class PartiesListComponent implements OnInit, OnDestroy {
     this.pageSize.next(10);
     this.curPage.next(1);
     this.nameOrder.next(1);
+    this.location.next('');
 
     this.autorunSub = MeteorObservable.autorun().zone().subscribe(() => {
       this.partiesSize = Counts.get('numberOfParties');
@@ -89,7 +92,8 @@ export class PartiesListComponent implements OnInit, OnDestroy {
   }
 
   search(value: string): void {
-    this.parties = Parties.find(value ? { location: value } : {}).zone();
+    this.curPage.next(1);
+    this.location.next(value);
   }
 
   onPageChanged(page: number): void {
-- 
2.7.4 (Apple Git-66)


From 37e21e505dea2f52c3e37d694891ad22db4bb0b9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:27:03 +0200
Subject: [PATCH 100/267] Step 13.1: Add uninvited users publication

---
 server/imports/publications/users.ts | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
 create mode 100644 server/imports/publications/users.ts

diff --git a/server/imports/publications/users.ts b/server/imports/publications/users.ts
new file mode 100644
index 0000000..c320f41
--- /dev/null
+++ b/server/imports/publications/users.ts
@@ -0,0 +1,18 @@
+import { Meteor } from 'meteor/meteor';
+
+import { Parties } from '../../../both/collections/parties.collection';
+
+Meteor.publish('uninvited', function (partyId: string) {
+  const party = Parties.findOne(partyId);
+
+  if (!party) {
+    throw new Meteor.Error('404', 'No such party!');
+  }
+
+  return Meteor.users.find({
+    _id: {
+      $nin: party.invited || [],
+      $ne: this.userId
+    }
+  });
+});
-- 
2.7.4 (Apple Git-66)


From 87626e8f20a5572a3576d225ae98304d89e5ef37 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:28:24 +0200
Subject: [PATCH 101/267] Step 13.2: Add invited to Party interface

---
 both/models/party.model.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/both/models/party.model.ts b/both/models/party.model.ts
index 2526c11..64e6ae1 100644
--- a/both/models/party.model.ts
+++ b/both/models/party.model.ts
@@ -6,4 +6,5 @@ export interface Party extends CollectionObject {
   location: string;
   owner?: string;
   public: boolean;
+  invited?: string[];
 }
-- 
2.7.4 (Apple Git-66)


From dc6dd734513ed95d5278d2f29319a5431a7ef03d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:28:59 +0200
Subject: [PATCH 102/267] Step 13.3: Use it on the server

---
 server/main.ts | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/server/main.ts b/server/main.ts
index 7f8e626..f6356dd 100644
--- a/server/main.ts
+++ b/server/main.ts
@@ -2,7 +2,8 @@ import { Meteor } from 'meteor/meteor';
 
 import { loadParties } from './imports/fixtures/parties';
 
-import './imports/publications/parties'; 
+import './imports/publications/parties';
+import './imports/publications/users'; 
 
 Meteor.startup(() => {
   loadParties();
-- 
2.7.4 (Apple Git-66)


From 2f2d0bad470d2e638e5f380d2a78b1461b57ce7a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:42:28 +0200
Subject: [PATCH 103/267] Step 13.4: Create Users collection from Meteor.users

---
 both/collections/users.collection.ts | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 both/collections/users.collection.ts

diff --git a/both/collections/users.collection.ts b/both/collections/users.collection.ts
new file mode 100644
index 0000000..dbd121b
--- /dev/null
+++ b/both/collections/users.collection.ts
@@ -0,0 +1,4 @@
+import { MongoObservable } from 'meteor-rxjs';
+import { Meteor } from 'meteor/meteor';
+
+export const Users = MongoObservable.fromExisting(Meteor.users);
-- 
2.7.4 (Apple Git-66)


From ed2b822a38ad1031b3a7f31f4a0351bc9b6db219 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:42:57 +0200
Subject: [PATCH 104/267] Step 13.5: Create also User interface

---
 both/models/user.model.ts | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 both/models/user.model.ts

diff --git a/both/models/user.model.ts b/both/models/user.model.ts
new file mode 100644
index 0000000..08eeec5
--- /dev/null
+++ b/both/models/user.model.ts
@@ -0,0 +1,3 @@
+import { Meteor } from 'meteor/meteor';
+
+export interface User extends Meteor.User {}
-- 
2.7.4 (Apple Git-66)


From 70c3251f23be485ccd8a3831155b5645d13ac88a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:45:17 +0200
Subject: [PATCH 105/267] Step 13.6: Implement subscription of uninvited users

---
 client/imports/app/parties/party-details.component.ts | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 20bf309..545a812 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -1,5 +1,6 @@
 import { Component, OnInit, OnDestroy } from '@angular/core';
 import { ActivatedRoute } from '@angular/router';
+import { Observable } from 'rxjs/Observable';
 import { Subscription } from 'rxjs/Subscription';
 import { Meteor } from 'meteor/meteor';
 import { MeteorObservable } from 'meteor-rxjs';
@@ -8,6 +9,8 @@ import 'rxjs/add/operator/map';
 
 import { Parties } from '../../../../both/collections/parties.collection';
 import { Party } from '../../../../both/models/party.model';
+import { Users } from '../../../../both/collections/users.collection';
+import { User } from '../../../../both/models/user.model';
 
 import template from './party-details.component.html';
 
@@ -20,6 +23,8 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
   paramsSub: Subscription;
   party: Party;
   partySub: Subscription;
+  users: Observable<User>;
+  uninvitedSub: Subscription;
 
   constructor(
     private route: ActivatedRoute
@@ -38,6 +43,18 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
         this.partySub = MeteorObservable.subscribe('party', this.partyId).zone().subscribe(() => {
           this.party = Parties.findOne(this.partyId);
         });
+
+        if (this.uninvitedSub) {
+          this.uninvitedSub.unsubscribe();
+        }
+
+        this.uninvitedSub = MeteorObservable.subscribe('uninvited', this.partyId).zone().subscribe(() => {
+           this.users = Users.find({
+             _id: {
+               $ne: Meteor.userId()
+              }
+            });
+        });
       });
   }
 
@@ -59,5 +76,6 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
   ngOnDestroy() {
     this.paramsSub.unsubscribe();
     this.partySub.unsubscribe();
+    this.uninvitedSub.unsubscribe();
   }
 }
-- 
2.7.4 (Apple Git-66)


From b73e45e2a5b9273a41a23628557234d8d0281ef4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:46:28 +0200
Subject: [PATCH 106/267] Step 13.7: Display list of uninvited users

---
 client/imports/app/parties/party-details.component.html | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index aef5bae..2ce1e72 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -10,4 +10,11 @@
 
   <button type="submit">Save</button>
   <a [routerLink]="['/']">Cancel</a>
-</form>
\ No newline at end of file
+</form>
+
+<p>Users to invite:</p>
+<ul>
+  <li *ngFor="let user of users | async">
+    <div>{{user.emails[0].address}}</div>
+  </li>
+</ul>
-- 
2.7.4 (Apple Git-66)


From e376f38c2b871a81865bf1cd8ecb2a5d57725243 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:50:06 +0200
Subject: [PATCH 107/267] Step 13.8: Create DisplayNamePipe

---
 client/imports/app/shared/display-name.pipe.ts | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)
 create mode 100644 client/imports/app/shared/display-name.pipe.ts

diff --git a/client/imports/app/shared/display-name.pipe.ts b/client/imports/app/shared/display-name.pipe.ts
new file mode 100644
index 0000000..40efbb6
--- /dev/null
+++ b/client/imports/app/shared/display-name.pipe.ts
@@ -0,0 +1,25 @@
+import { Pipe, PipeTransform } from '@angular/core';
+import { Meteor } from 'meteor/meteor';
+
+import { User } from '../../../../both/models/user.model';
+
+@Pipe({
+  name: 'displayName'
+})
+export class DisplayNamePipe implements PipeTransform {
+  transform(user: User): string {
+    if (!user) {
+      return '';
+    }
+
+    if (user.username) {
+      return user.username;
+    }
+
+    if (user.emails) {
+      return user.emails[0].address;
+    }
+
+    return '';
+  }
+}
-- 
2.7.4 (Apple Git-66)


From 85ddec70067964911f7933af74cf897cd244d0be Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:51:10 +0200
Subject: [PATCH 108/267] Step 13.9: Make space for shared declarations

---
 client/imports/app/shared/index.ts | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 client/imports/app/shared/index.ts

diff --git a/client/imports/app/shared/index.ts b/client/imports/app/shared/index.ts
new file mode 100644
index 0000000..d9104e8
--- /dev/null
+++ b/client/imports/app/shared/index.ts
@@ -0,0 +1,5 @@
+import { DisplayNamePipe } from './display-name.pipe';
+
+export const SHARED_DECLARATIONS: any[] = [
+  DisplayNamePipe
+];
-- 
2.7.4 (Apple Git-66)


From 20d91645de3d840ec88cd61846a5508f41f6a353 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:51:49 +0200
Subject: [PATCH 109/267] Step 13.10: Import those declarations to AppModule

---
 client/imports/app/app.module.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 65145a8..383ed58 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -8,6 +8,7 @@ import { Ng2PaginationModule } from 'ng2-pagination';
 import { AppComponent } from './app.component';
 import { routes, ROUTES_PROVIDERS } from './app.routes';
 import { PARTIES_DECLARATIONS } from './parties';
+import { SHARED_DECLARATIONS } from './shared';
 
 @NgModule({
   imports: [
@@ -20,7 +21,8 @@ import { PARTIES_DECLARATIONS } from './parties';
   ],
   declarations: [
     AppComponent,
-    ...PARTIES_DECLARATIONS
+    ...PARTIES_DECLARATIONS,
+    ...SHARED_DECLARATIONS
   ],
   providers: [
     ...ROUTES_PROVIDERS
-- 
2.7.4 (Apple Git-66)


From 066fc57da422a66d08f781ee7ff7b52493129c64 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@gmail.com>
Date: Fri, 23 Sep 2016 17:54:00 +0200
Subject: [PATCH 110/267] Step 13.11: Use this Pipe in PartyDetails

---
 client/imports/app/parties/party-details.component.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index 2ce1e72..78e0c41 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -15,6 +15,6 @@
 <p>Users to invite:</p>
 <ul>
   <li *ngFor="let user of users | async">
-    <div>{{user.emails[0].address}}</div>
+    <div>{{user | displayName}}</div>
   </li>
 </ul>
-- 
2.7.4 (Apple Git-66)


From 40a9708a579410e1436b4ea8fb85ec6a66e091ef Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:24:02 +0300
Subject: [PATCH 111/267] Step 14.1: Add a party invitation method

---
 both/methods/parties.methods.ts | 47 +++++++++++++++++++++++++++++++++++++++++
 1 file changed, 47 insertions(+)
 create mode 100644 both/methods/parties.methods.ts

diff --git a/both/methods/parties.methods.ts b/both/methods/parties.methods.ts
new file mode 100644
index 0000000..cc324f9
--- /dev/null
+++ b/both/methods/parties.methods.ts
@@ -0,0 +1,47 @@
+import {Parties} from '../collections/parties.collection';
+import {Email} from 'meteor/email';
+import {check} from 'meteor/check';
+import {Meteor} from 'meteor/meteor';
+
+function getContactEmail(user:Meteor.User):string {
+  if (user.emails && user.emails.length)
+    return user.emails[0].address;
+
+  return null;
+}
+
+Meteor.methods({
+  invite: function (partyId:string, userId:string) {
+    check(partyId, String);
+    check(userId, String);
+
+    let party = Parties.collection.findOne(partyId);
+
+    if (!party)
+      throw new Meteor.Error('404', 'No such party!');
+
+    if (party.public)
+      throw new Meteor.Error('400', 'That party is public. No need to invite people.');
+
+    if (party.owner !== this.userId)
+      throw new Meteor.Error('403', 'No permissions!');
+
+    if (userId !== party.owner && (party.invited || []).indexOf(userId) == -1) {
+      Parties.collection.update(partyId, {$addToSet: {invited: userId}});
+
+      let from = getContactEmail(Meteor.users.findOne(this.userId));
+      let to = getContactEmail(Meteor.users.findOne(userId));
+
+      if (Meteor.isServer && to) {
+        Email.send({
+          from: 'noreply@socially.com',
+          to: to,
+          replyTo: from || undefined,
+          subject: 'PARTY: ' + party.name,
+          text: `Hi, I just invited you to ${party.name} on Socially.
+                        \n\nCome check it out: ${Meteor.absoluteUrl()}\n`
+        });
+      }
+    }
+  }
+});
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From fe2ae27dce9d420ed16187760f5aa978926a7f05 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:24:34 +0300
Subject: [PATCH 112/267] Step 14.2: Import methods on the server side

---
 server/main.ts | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/server/main.ts b/server/main.ts
index f6356dd..7979c05 100644
--- a/server/main.ts
+++ b/server/main.ts
@@ -3,7 +3,8 @@ import { Meteor } from 'meteor/meteor';
 import { loadParties } from './imports/fixtures/parties';
 
 import './imports/publications/parties';
-import './imports/publications/users'; 
+import './imports/publications/users';
+import '../both/methods/parties.methods';
 
 Meteor.startup(() => {
   loadParties();
-- 
2.7.4 (Apple Git-66)


From 2a317e29f96698e6dc7de68a6ea06450e924121c Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:25:20 +0300
Subject: [PATCH 113/267] Step 14.3: Import methods on the client side

---
 client/main.ts | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/main.ts b/client/main.ts
index c5323fd..45d1530 100644
--- a/client/main.ts
+++ b/client/main.ts
@@ -4,5 +4,7 @@ import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
 
 import { AppModule } from './imports/app/app.module';
 
+import '../both/methods/parties.methods';
+
 const platform = platformBrowserDynamic();
 platform.bootstrapModule(AppModule);
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 187be05fe5d48e02d850e8b3d2ce500b860ee2d7 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:27:04 +0300
Subject: [PATCH 114/267] Step 14.4: Add check and email packages

---
 .meteor/packages | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 4a92e64..6c5c67f 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -23,3 +23,5 @@ dispatch:mocha-phantomjs
 shell-server
 accounts-password
 tmeasday:publish-counts
+check
+email
-- 
2.7.4 (Apple Git-66)


From 6e3a1e8b68ce67f11e261f8fc7361613c052af8b Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:29:09 +0300
Subject: [PATCH 115/267] Step 14.5: Add invite method

---
 client/imports/app/parties/party-details.component.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index 78e0c41..28c9588 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -16,5 +16,6 @@
 <ul>
   <li *ngFor="let user of users | async">
     <div>{{user | displayName}}</div>
+    <button (click)="invite(user)">Invite</button>
   </li>
 </ul>
-- 
2.7.4 (Apple Git-66)


From fd92649f346ad589132d39d78131ca8d64516521 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:31:02 +0300
Subject: [PATCH 116/267] Step 14.6: Add the click handler in the Component

---
 client/imports/app/parties/party-details.component.ts | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 545a812..2efd3c5 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -73,6 +73,14 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
     });
   }
 
+  invite(user: Meteor.User) {
+    MeteorObservable.call('invite', this.party._id, user._id).subscribe(() => {
+      alert('User successfully invited.');
+    }, (error) => {
+      alert(`Failed to invite due to ${error}`);
+    });
+  }
+
   ngOnDestroy() {
     this.paramsSub.unsubscribe();
     this.partySub.unsubscribe();
-- 
2.7.4 (Apple Git-66)


From 12aaa595596d171989df067c6f60307ccf40f4aa Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:42:39 +0300
Subject: [PATCH 117/267] Step 14.7: Get the party reactively

---
 client/imports/app/parties/party-details.component.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 2efd3c5..cce3d31 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -41,7 +41,9 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
         }
 
         this.partySub = MeteorObservable.subscribe('party', this.partyId).zone().subscribe(() => {
-          this.party = Parties.findOne(this.partyId);
+          MeteorObservable.autorun().zone().subscribe(() => {
+            this.party = Parties.findOne(this.partyId);
+          });
         });
 
         if (this.uninvitedSub) {
-- 
2.7.4 (Apple Git-66)


From 270b1163b1d9b3b9fb89de17a80f77ee51d9c26e Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:44:39 +0300
Subject: [PATCH 118/267] Step 14.8: Update the users list reactively

---
 client/imports/app/parties/party-details.component.ts | 18 +++++++++++++-----
 1 file changed, 13 insertions(+), 5 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index cce3d31..9c4b95b 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -43,6 +43,7 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
         this.partySub = MeteorObservable.subscribe('party', this.partyId).zone().subscribe(() => {
           MeteorObservable.autorun().zone().subscribe(() => {
             this.party = Parties.findOne(this.partyId);
+            this.getUsers(this.party);
           });
         });
 
@@ -51,15 +52,22 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
         }
 
         this.uninvitedSub = MeteorObservable.subscribe('uninvited', this.partyId).zone().subscribe(() => {
-           this.users = Users.find({
-             _id: {
-               $ne: Meteor.userId()
-              }
-            });
+          this.getUsers(this.party);
         });
       });
   }
 
+  getUsers(party: Party) {
+    if (party) {
+      this.users = Users.find({
+        _id: {
+          $nin: party.invited || [],
+          $ne: Meteor.userId()
+        }
+      });
+    }
+  }
+
   saveParty() {
     if (!Meteor.userId()) {
       alert('Please log in to change this party');
-- 
2.7.4 (Apple Git-66)


From d95f2dda74219f861ca876d7062c95dc0828bb40 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:47:08 +0300
Subject: [PATCH 119/267] Step 14.9: Show private parties to the invited and
 owners only

---
 server/imports/publications/parties.ts | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/server/imports/publications/parties.ts b/server/imports/publications/parties.ts
index 34c9470..4742280 100644
--- a/server/imports/publications/parties.ts
+++ b/server/imports/publications/parties.ts
@@ -36,6 +36,12 @@ function buildQuery(partyId?: string, location?: string): Object {
           $exists: true
         }
       }]
+    },
+    {
+      $and: [
+        { invited: this.userId },
+        { invited: { $exists: true } }
+      ]
     }]
   };
 
-- 
2.7.4 (Apple Git-66)


From 9e9ea60144bab235c6a3237455e616de57d2315b Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:48:03 +0300
Subject: [PATCH 120/267] Step 14.10: Add a reply method

---
 both/methods/parties.methods.ts | 45 +++++++++++++++++++++++++++++++++++++++++
 1 file changed, 45 insertions(+)

diff --git a/both/methods/parties.methods.ts b/both/methods/parties.methods.ts
index cc324f9..ac0bfc7 100644
--- a/both/methods/parties.methods.ts
+++ b/both/methods/parties.methods.ts
@@ -43,5 +43,50 @@ Meteor.methods({
         });
       }
     }
+  },
+  reply: function(partyId: string, rsvp: string) {
+    check(partyId, String);
+    check(rsvp, String);
+
+    if (!this.userId)
+      throw new Meteor.Error('403', 'You must be logged-in to reply');
+
+    if (['yes', 'no', 'maybe'].indexOf(rsvp) === -1)
+      throw new Meteor.Error('400', 'Invalid RSVP');
+
+    let party = Parties.findOne({ _id: partyId });
+
+    if (!party)
+      throw new Meteor.Error('404', 'No such party');
+
+    if (party.owner === this.userId)
+      throw new Meteor.Error('500', 'You are the owner!');
+
+    if (!party.public && (!party.invited || party.invited.indexOf(this.userId) == -1))
+      throw new Meteor.Error('403', 'No such party'); // its private, but let's not tell this to the user
+
+    let rsvpIndex = party.rsvps ? party.rsvps.findIndex((rsvp) => rsvp.userId === this.userId) : -1;
+
+    if (rsvpIndex !== -1) {
+      // update existing rsvp entry
+      if (Meteor.isServer) {
+        // update the appropriate rsvp entry with $
+        Parties.update(
+          { _id: partyId, 'rsvps.userId': this.userId },
+          { $set: { 'rsvps.$.response': rsvp } });
+      } else {
+        // minimongo doesn't yet support $ in modifier. as a temporary
+        // workaround, make a modifier that uses an index. this is
+        // safe on the client since there's only one thread.
+        let modifier = { $set: {} };
+        modifier.$set['rsvps.' + rsvpIndex + '.response'] = rsvp;
+
+        Parties.update(partyId, modifier);
+      }
+    } else {
+      // add new rsvp entry
+      Parties.update(partyId,
+        { $push: { rsvps: { userId: this.userId, response: rsvp } } });
+    }
   }
 });
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 94bd1a2a26b04fb4ba096865b221fdad1c71b877 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:48:46 +0300
Subject: [PATCH 121/267] Step 14.11: Add RSVP interface

---
 both/models/party.model.ts | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/both/models/party.model.ts b/both/models/party.model.ts
index 64e6ae1..9f7c41e 100644
--- a/both/models/party.model.ts
+++ b/both/models/party.model.ts
@@ -7,4 +7,10 @@ export interface Party extends CollectionObject {
   owner?: string;
   public: boolean;
   invited?: string[];
+  rsvps?: RSVP[];
 }
+
+interface RSVP {
+  userId: string;
+  response: string;
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 3e9bc311c6d573b8d93fe4eb6b78c53fcb3d215c Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:49:22 +0300
Subject: [PATCH 122/267] Step 14.12: Add reponse buttons

---
 client/imports/app/parties/party-details.component.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index 28c9588..a3e173d 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -19,3 +19,10 @@
     <button (click)="invite(user)">Invite</button>
   </li>
 </ul>
+
+<div>
+  <h2>Reply to the invitation</h2>
+  <input type="button" value="I'm going!" (click)="reply('yes')">
+  <input type="button" value="Maybe" (click)="reply('maybe')">
+  <input type="button" value="No" (click)="reply('no')">
+</div>
-- 
2.7.4 (Apple Git-66)


From 1de053ef863a375359c7c3bac3a7ffe60a2ef624 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:51:03 +0300
Subject: [PATCH 123/267] Step 14.13: Add reply method to PartyDetails
 component

---
 client/imports/app/parties/party-details.component.ts | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 9c4b95b..91882c9 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -91,6 +91,14 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
     });
   }
 
+  reply(rsvp: string) {
+    MeteorObservable.call('reply', this.party._id, rsvp).subscribe(() => {
+      alert('You successfully replied.');
+    }, (error) => {
+      alert(`Failed to reply due to ${error}`);
+    });
+  }
+
   ngOnDestroy() {
     this.paramsSub.unsubscribe();
     this.partySub.unsubscribe();
-- 
2.7.4 (Apple Git-66)


From ac45d6c59dd2d6f4de783504393c8964c86bd172 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:59:23 +0300
Subject: [PATCH 124/267] Step 14.14: Add a new response counting pipe

---
 client/imports/app/shared/rsvp.pipe.ts | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
 create mode 100644 client/imports/app/shared/rsvp.pipe.ts

diff --git a/client/imports/app/shared/rsvp.pipe.ts b/client/imports/app/shared/rsvp.pipe.ts
new file mode 100644
index 0000000..5b5938c
--- /dev/null
+++ b/client/imports/app/shared/rsvp.pipe.ts
@@ -0,0 +1,22 @@
+import {Pipe, PipeTransform} from '@angular/core';
+import {Party} from "../../../../both/models/party.model";
+import {Parties} from "../../../../both/collections/parties.collection";
+
+@Pipe({
+  name: 'rsvp'
+})
+export class RsvpPipe implements PipeTransform {
+  transform(party: Party, type: string): number {
+    if (!type) {
+      return 0;
+    }
+
+    let total = 0;
+    const found = Parties.findOne(party._id);
+
+    if (found)
+      total = found.rsvps ? found.rsvps.filter(rsvp => rsvp.response === type).length : 0;
+
+    return total;
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 436ec400ada00fe5cf9519ecac40b62777b31c68 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:59:34 +0300
Subject: [PATCH 125/267] Step 14.15: Display response statistics on the list

---
 client/imports/app/parties/parties-list.component.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index f1083e3..40e51d2 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -20,6 +20,12 @@
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
       <button (click)="removeParty(party)">X</button>
+      <div>
+        Who is coming:
+        Yes - {{party | rsvp:'yes'}}
+        Maybe - {{party | rsvp:'maybe'}}
+        No - {{party | rsvp:'no'}}
+      </div>
     </li>
   </ul>
 
-- 
2.7.4 (Apple Git-66)


From 7ecae54e4a68dfcccf1ac9f4170b53e9c077a960 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 10:59:44 +0300
Subject: [PATCH 126/267] Step 14.16: Import RsvpPipe

---
 client/imports/app/shared/index.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/shared/index.ts b/client/imports/app/shared/index.ts
index d9104e8..12c7d64 100644
--- a/client/imports/app/shared/index.ts
+++ b/client/imports/app/shared/index.ts
@@ -1,5 +1,7 @@
 import { DisplayNamePipe } from './display-name.pipe';
+import {RsvpPipe} from "./rsvp.pipe";
 
 export const SHARED_DECLARATIONS: any[] = [
-  DisplayNamePipe
+  DisplayNamePipe,
+  RsvpPipe
 ];
-- 
2.7.4 (Apple Git-66)


From 499b04aaa7051e73536b10702887f9814959bf35 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:42:55 +0300
Subject: [PATCH 127/267] Step 15.1: Inject Meteor User and add isOwner method

---
 client/imports/app/parties/parties-list.component.ts | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index c992344..1b93c26 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -5,6 +5,7 @@ import { Subscription } from 'rxjs/Subscription';
 import { MeteorObservable } from 'meteor-rxjs';
 import { PaginationService } from 'ng2-pagination';
 import { Counts } from 'meteor/tmeasday:publish-counts';
+import { InjectUser } from "angular2-meteor-accounts-ui";
 
 import 'rxjs/add/operator/combineLatest';
 
@@ -26,6 +27,7 @@ interface Options extends Pagination {
   selector: 'parties-list',
   template
 })
+@InjectUser('user')
 export class PartiesListComponent implements OnInit, OnDestroy {
   parties: Observable<Party[]>;
   partiesSub: Subscription;
@@ -36,6 +38,7 @@ export class PartiesListComponent implements OnInit, OnDestroy {
   partiesSize: number = 0;
   autorunSub: Subscription;
   location: Subject<string> = new Subject<string>();
+  user: Meteor.User;
 
   constructor(
     private paginationService: PaginationService
@@ -104,6 +107,10 @@ export class PartiesListComponent implements OnInit, OnDestroy {
     this.nameOrder.next(parseInt(nameOrder));
   }
 
+  isOwner(party: Party): boolean {
+    return this.user && this.user._id === party.owner;
+  }
+
   ngOnDestroy() {
     this.partiesSub.unsubscribe();
     this.optionsSub.unsubscribe();
-- 
2.7.4 (Apple Git-66)


From 49c99d980073f64cbd26a41c84fc83647d98856d Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:43:04 +0300
Subject: [PATCH 128/267] Step 15.2: Use the hidden attribute in the
 PartiestList

---
 client/imports/app/parties/parties-list.component.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index 40e51d2..a94ea42 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -1,5 +1,5 @@
 <div>
-  <parties-form style="float: left"></parties-form>
+  <parties-form [hidden]="!user" style="float: left"></parties-form>
   <input type="text" #searchtext placeholder="Search by Location">
   <button type="button" (click)="search(searchtext.value)">Search</button>
   
@@ -19,7 +19,7 @@
       <a [routerLink]="['/party', party._id]">{{party.name}}</a>
       <p>{{party.description}}</p>
       <p>{{party.location}}</p>
-      <button (click)="removeParty(party)">X</button>
+      <button [hidden]="!isOwner(party)" (click)="removeParty(party)">X</button>
       <div>
         Who is coming:
         Yes - {{party | rsvp:'yes'}}
-- 
2.7.4 (Apple Git-66)


From bc61405c42ae9f9e1a5470880326d45116e88223 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:43:14 +0300
Subject: [PATCH 129/267] Step 15.3: Add isOwner property

---
 client/imports/app/parties/party-details.component.ts | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 91882c9..311a8ea 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -4,6 +4,7 @@ import { Observable } from 'rxjs/Observable';
 import { Subscription } from 'rxjs/Subscription';
 import { Meteor } from 'meteor/meteor';
 import { MeteorObservable } from 'meteor-rxjs';
+import { InjectUser } from "angular2-meteor-accounts-ui";
 
 import 'rxjs/add/operator/map';
 
@@ -18,6 +19,7 @@ import template from './party-details.component.html';
   selector: 'party-details',
   template
 })
+@InjectUser('user')
 export class PartyDetailsComponent implements OnInit, OnDestroy {
   partyId: string;
   paramsSub: Subscription;
@@ -25,6 +27,7 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
   partySub: Subscription;
   users: Observable<User>;
   uninvitedSub: Subscription;
+  user: Meteor.User;
 
   constructor(
     private route: ActivatedRoute
@@ -99,6 +102,10 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
     });
   }
 
+  get isOwner(): boolean {
+    return this.party && this.user && this.user._id === this.party.owner;
+  }
+
   ngOnDestroy() {
     this.paramsSub.unsubscribe();
     this.partySub.unsubscribe();
-- 
2.7.4 (Apple Git-66)


From 19f79c4df935b51707d5f7418c291e20509320fb Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:43:20 +0300
Subject: [PATCH 130/267] Step 15.4: Add disabled attribute bindings

---
 client/imports/app/parties/party-details.component.html | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index a3e173d..a00a045 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -1,14 +1,14 @@
 <form *ngIf="party" (submit)="saveParty()">
   <label>Name</label>
-  <input type="text" [(ngModel)]="party.name" name="name">
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.name" name="name">
 
   <label>Description</label>
-  <input type="text" [(ngModel)]="party.description" name="description">
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.description" name="description">
 
   <label>Location</label>
-  <input type="text" [(ngModel)]="party.location" name="location">
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location" name="location">
 
-  <button type="submit">Save</button>
+  <button [disabled]="!isOwner" type="submit">Save</button>
   <a [routerLink]="['/']">Cancel</a>
 </form>
 
-- 
2.7.4 (Apple Git-66)


From 622604bd7e19e2b218ab35eb5eec80ed80c0dc02 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:44:34 +0300
Subject: [PATCH 131/267] Step 15.5: Add isPublic and isInvited properties

---
 client/imports/app/parties/party-details.component.ts | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index 311a8ea..ae6ae9e 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -106,6 +106,20 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
     return this.party && this.user && this.user._id === this.party.owner;
   }
 
+  get isPublic(): boolean {
+    return this.party && this.party.public;
+  }
+
+  get isInvited(): boolean {
+    if (this.party && this.user) {
+      const invited = this.party.invited || [];
+
+      return invited.indexOf(this.user._id) !== -1;
+    }
+
+    return false;
+  }
+
   ngOnDestroy() {
     this.paramsSub.unsubscribe();
     this.partySub.unsubscribe();
-- 
2.7.4 (Apple Git-66)


From 55f984639016c25ac37e3ff6b3527f692b1b0d32 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:46:12 +0300
Subject: [PATCH 132/267] Step 15.6: Make use of properties in the template

---
 .../imports/app/parties/party-details.component.html   | 18 ++++++++++--------
 1 file changed, 10 insertions(+), 8 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index a00a045..7abe835 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -12,15 +12,17 @@
   <a [routerLink]="['/']">Cancel</a>
 </form>
 
-<p>Users to invite:</p>
-<ul>
-  <li *ngFor="let user of users | async">
-    <div>{{user | displayName}}</div>
-    <button (click)="invite(user)">Invite</button>
-  </li>
-</ul>
+<div *ngIf="isOwner || isPublic">
+  <p>Users to invite:</p>
+  <ul>
+    <li *ngFor="let user of users | async">
+      <div>{{user | displayName}}</div>
+      <button (click)="invite(user)">Invite</button>
+    </li>
+  </ul>
+</div>
 
-<div>
+<div *ngIf="isInvited">
   <h2>Reply to the invitation</h2>
   <input type="button" value="I'm going!" (click)="reply('yes')">
   <input type="button" value="Maybe" (click)="reply('maybe')">
-- 
2.7.4 (Apple Git-66)


From 4ade07ea5afb1c7d6d87ff6b92046020b31416bb Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:48:18 +0300
Subject: [PATCH 133/267] Step 16.1: Extend party location with coords

---
 both/models/party.model.ts | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/both/models/party.model.ts b/both/models/party.model.ts
index 9f7c41e..5e62f1b 100644
--- a/both/models/party.model.ts
+++ b/both/models/party.model.ts
@@ -3,7 +3,7 @@ import { CollectionObject } from './collection-object.model';
 export interface Party extends CollectionObject {
   name: string;
   description: string;
-  location: string;
+  location: Location;
   owner?: string;
   public: boolean;
   invited?: string[];
@@ -13,4 +13,10 @@ export interface Party extends CollectionObject {
 interface RSVP {
   userId: string;
   response: string;
+}
+
+interface Location {
+  name: string;
+  lat?: number;
+  lng?: number;
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From dbff5d2a1906d60ef9eda421d728a9e6861bb0a9 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:49:10 +0300
Subject: [PATCH 134/267] Step 16.2: Change initial parties accordingly

---
 server/imports/fixtures/parties.ts | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

diff --git a/server/imports/fixtures/parties.ts b/server/imports/fixtures/parties.ts
index e49a665..10168af 100644
--- a/server/imports/fixtures/parties.ts
+++ b/server/imports/fixtures/parties.ts
@@ -6,17 +6,23 @@ export function loadParties() {
     const parties: Party[] = [{
       name: 'Dubstep-Free Zone',
       description: 'Can we please just for an evening not listen to dubstep.',
-      location: 'Palo Alto',
+      location: {
+        name: 'Palo Alto'
+      },
       public: true
     }, {
       name: 'All dubstep all the time',
       description: 'Get it on!',
-      location: 'Palo Alto',
+      location: {
+        name: 'Palo Alto'
+      },
       public: true
     }, {
       name: 'Savage lounging',
       description: 'Leisure suit required. And only fiercest manners.',
-      location: 'San Francisco',
+      location: {
+        name: 'San Francisco'
+      },
       public: true
     }];
 
-- 
2.7.4 (Apple Git-66)


From 7823c50e3d0ff143a02191798f32ac1163565109 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:50:53 +0300
Subject: [PATCH 135/267] Step 16.3: Change party creation component

---
 client/imports/app/parties/parties-form.component.ts | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-form.component.ts b/client/imports/app/parties/parties-form.component.ts
index 0823749..3a213f0 100644
--- a/client/imports/app/parties/parties-form.component.ts
+++ b/client/imports/app/parties/parties-form.component.ts
@@ -33,7 +33,15 @@ export class PartiesFormComponent implements OnInit {
     }
 
     if (this.addForm.valid) {
-      Parties.insert(Object.assign({}, this.addForm.value, { owner: Meteor.userId() }));
+      Parties.insert({
+        name: this.addForm.value.name,
+        description: this.addForm.value.description,
+        location: {
+          name: this.addForm.value.location
+        },
+        public: this.addForm.value.public,
+        owner: Meteor.userId()
+      });
 
       this.addForm.reset();
     }
-- 
2.7.4 (Apple Git-66)


From 14f4d17551b5da1a6a7f982ee8b04791c391bedd Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:51:39 +0300
Subject: [PATCH 136/267] Step 16.4: Reflect type changes in the parties search

---
 server/imports/publications/parties.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/server/imports/publications/parties.ts b/server/imports/publications/parties.ts
index 4742280..d1c8e00 100644
--- a/server/imports/publications/parties.ts
+++ b/server/imports/publications/parties.ts
@@ -60,7 +60,7 @@ function buildQuery(partyId?: string, location?: string): Object {
 
   return {
     $and: [{
-        location: searchRegEx
+        'location.name': searchRegEx
       },
       isAvailable
     ]
-- 
2.7.4 (Apple Git-66)


From 51d7901e2ee0c9fb882913855556bbab4b9c90fe Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:53:13 +0300
Subject: [PATCH 137/267] Step 16.5: Install angular2-google-maps

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 2388711..cd88387 100644
--- a/package.json
+++ b/package.json
@@ -24,6 +24,7 @@
     "@angular/platform-browser": "2.0.1",
     "@angular/platform-browser-dynamic": "2.0.1",
     "@angular/router": "3.0.1",
+    "angular2-google-maps": "0.15.0",
     "angular2-meteor": "0.7.0",
     "angular2-meteor-accounts-ui": "0.8.0",
     "angular2-meteor-polyfills": "^0.1.1",
-- 
2.7.4 (Apple Git-66)


From 346e40ab691591b7247b84f873f3e8ee3ddf469e Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:55:17 +0300
Subject: [PATCH 138/267] Step 16.6: Import google maps module

---
 client/imports/app/app.module.ts | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 383ed58..0240ddf 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -4,6 +4,7 @@ import { FormsModule, ReactiveFormsModule } from '@angular/forms';
 import { RouterModule } from '@angular/router';
 import { AccountsModule } from 'angular2-meteor-accounts-ui';
 import { Ng2PaginationModule } from 'ng2-pagination';
+import { AgmCoreModule } from 'angular2-google-maps/core';
 
 import { AppComponent } from './app.component';
 import { routes, ROUTES_PROVIDERS } from './app.routes';
@@ -17,7 +18,10 @@ import { SHARED_DECLARATIONS } from './shared';
     ReactiveFormsModule,
     RouterModule.forRoot(routes),
     AccountsModule,
-    Ng2PaginationModule
+    Ng2PaginationModule,
+    AgmCoreModule.forRoot({
+      apiKey: 'AIzaSyAWoBdZHCNh5R-hB5S5ZZ2oeoYyfdDgniA'
+    })
   ],
   declarations: [
     AppComponent,
-- 
2.7.4 (Apple Git-66)


From 5cea195391d7118798b0937297f414edf2336f22 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 11:55:43 +0300
Subject: [PATCH 139/267] Step 16.7: Change ngModel to location.name

---
 client/imports/app/parties/party-details.component.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index 7abe835..26f21ca 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -6,7 +6,7 @@
   <input [disabled]="!isOwner" type="text" [(ngModel)]="party.description" name="description">
 
   <label>Location</label>
-  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location" name="location">
+  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location.name" name="location">
 
   <button [disabled]="!isOwner" type="submit">Save</button>
   <a [routerLink]="['/']">Cancel</a>
-- 
2.7.4 (Apple Git-66)


From 7cb0ac5be3b8e0223afd6c3e54e8a7585ef552e4 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:19:47 +0300
Subject: [PATCH 140/267] Step 16.8: Use in a template

---
 client/imports/app/parties/party-details.component.html | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index 26f21ca..151fb03 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -28,3 +28,15 @@
   <input type="button" value="Maybe" (click)="reply('maybe')">
   <input type="button" value="No" (click)="reply('no')">
 </div>
+
+<sebm-google-map
+  [latitude]="lat || centerLat"
+  [longitude]="lng || centerLng"
+  [zoom]="8"
+  (mapClick)="mapClicked($event)">
+  <sebm-google-map-marker
+    *ngIf="lat && lng"
+    [latitude]="lat"
+    [longitude]="lng">
+  </sebm-google-map-marker>
+</sebm-google-map>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From f1a1c1267dbace51be5f37a83352ff2cc13aec48 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:19:54 +0300
Subject: [PATCH 141/267] Step 16.9: Add maps logic to the component

---
 client/imports/app/parties/party-details.component.ts | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/client/imports/app/parties/party-details.component.ts b/client/imports/app/parties/party-details.component.ts
index ae6ae9e..7b9d565 100644
--- a/client/imports/app/parties/party-details.component.ts
+++ b/client/imports/app/parties/party-details.component.ts
@@ -5,6 +5,7 @@ import { Subscription } from 'rxjs/Subscription';
 import { Meteor } from 'meteor/meteor';
 import { MeteorObservable } from 'meteor-rxjs';
 import { InjectUser } from "angular2-meteor-accounts-ui";
+import { MouseEvent } from "angular2-google-maps/core";
 
 import 'rxjs/add/operator/map';
 
@@ -28,6 +29,9 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
   users: Observable<User>;
   uninvitedSub: Subscription;
   user: Meteor.User;
+  // Default center Palo Alto coordinates.
+  centerLat: number = 37.4292;
+  centerLng: number = -122.1381;
 
   constructor(
     private route: ActivatedRoute
@@ -120,6 +124,20 @@ export class PartyDetailsComponent implements OnInit, OnDestroy {
     return false;
   }
 
+
+  get lat(): number {
+    return this.party && this.party.location.lat;
+  }
+
+  get lng(): number {
+    return this.party && this.party.location.lng;
+  }
+
+  mapClicked($event: MouseEvent) {
+    this.party.location.lat = $event.coords.lat;
+    this.party.location.lng = $event.coords.lng;
+  }
+
   ngOnDestroy() {
     this.paramsSub.unsubscribe();
     this.partySub.unsubscribe();
-- 
2.7.4 (Apple Git-66)


From d56421171ad69eece327a900ba958929116751d4 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:22:56 +0300
Subject: [PATCH 142/267] Step 16.10: Add maps styles

---
 client/main.scss | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/client/main.scss b/client/main.scss
index ac0e5ee..b32e376 100644
--- a/client/main.scss
+++ b/client/main.scss
@@ -1 +1,6 @@
-@import "{}/node_modules/angular2-meteor-accounts-ui/build/login-buttons.scss";
\ No newline at end of file
+@import "{}/node_modules/angular2-meteor-accounts-ui/build/login-buttons.scss";
+
+.sebm-google-map-container {
+  width: 400px;
+  height: 400px;
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 54cee5fac2b684aab2be31c8359c772396ca172f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:25:46 +0300
Subject: [PATCH 143/267] Step 16.11: Add all parties locations on the map

---
 client/imports/app/parties/parties-list.component.html | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index a94ea42..043f2ff 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -18,7 +18,7 @@
     <li *ngFor="let party of parties | async">
       <a [routerLink]="['/party', party._id]">{{party.name}}</a>
       <p>{{party.description}}</p>
-      <p>{{party.location}}</p>
+      <p>{{party.location.name}}</p>
       <button [hidden]="!isOwner(party)" (click)="removeParty(party)">X</button>
       <div>
         Who is coming:
@@ -29,5 +29,18 @@
     </li>
   </ul>
 
+  <sebm-google-map
+    [latitude]="0"
+    [longitude]="0"
+    [zoom]="1">
+    <div *ngFor="let party of parties | async">
+      <sebm-google-map-marker
+        *ngIf="party.location.lat"
+        [latitude]="party.location.lat"
+        [longitude]="party.location.lng">
+      </sebm-google-map-marker>
+    </div>
+  </sebm-google-map>
+
   <pagination-controls (pageChange)="onPageChanged($event)"></pagination-controls>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 85c49cc5a7fb0154ef229401aa5dfdf7084cebcc Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:43:17 +0300
Subject: [PATCH 144/267] Step 17.1: Install Bootstrap 4

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index cd88387..fa20c9c 100644
--- a/package.json
+++ b/package.json
@@ -29,6 +29,7 @@
     "angular2-meteor-accounts-ui": "0.8.0",
     "angular2-meteor-polyfills": "^0.1.1",
     "angular2-meteor-tests-polyfills": "0.0.2",
+    "bootstrap": "^4.0.0-alpha.4",
     "meteor-node-stubs": "0.2.3",
     "meteor-rxjs": "0.2.3",
     "ng2-pagination": "0.4.1",
-- 
2.7.4 (Apple Git-66)


From dc5e00474ded01b098856462050f905ea46d73e6 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:44:18 +0300
Subject: [PATCH 145/267] Step 17.2: Import bootstrap style into the main style
 file

---
 client/main.scss | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/main.scss b/client/main.scss
index b32e376..5c3a0d0 100644
--- a/client/main.scss
+++ b/client/main.scss
@@ -1,4 +1,6 @@
 @import "{}/node_modules/angular2-meteor-accounts-ui/build/login-buttons.scss";
+@import "{}/node_modules/bootstrap/scss/bootstrap.scss";
+
 
 .sebm-google-map-container {
   width: 400px;
-- 
2.7.4 (Apple Git-66)


From 6ac3aad7f422e7636e5c140e3a38fe8c51e3430b Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:44:23 +0300
Subject: [PATCH 146/267] Step 17.3: Add bootstrap navbar

---
 client/imports/app/app.component.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index b426778..b3c49f0 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1,3 +1,6 @@
-<div>
+<nav class="navbar navbar-light bg-faded">
+  <a class="navbar-brand" href="#">Socially</a>
+</nav>
+<div class="container-fluid">
   <router-outlet></router-outlet>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 95c07b4d612cf25447f438bd9c1b1150c41e4868 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:49:04 +0300
Subject: [PATCH 147/267] Step 17.4: Remove LoginButtons from a template

---
 client/imports/app/parties/parties-list.component.html | 2 --
 1 file changed, 2 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index 043f2ff..96fd80f 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -2,8 +2,6 @@
   <parties-form [hidden]="!user" style="float: left"></parties-form>
   <input type="text" #searchtext placeholder="Search by Location">
   <button type="button" (click)="search(searchtext.value)">Search</button>
-  
-  <login-buttons></login-buttons>
 
   <h1>Parties:</h1>
 
-- 
2.7.4 (Apple Git-66)


From 68f70ad87b3ba704e7a3beb3a8682f7d98d41d29 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:49:33 +0300
Subject: [PATCH 148/267] Step 17.5: Add login buttons to the navigation bar

---
 client/imports/app/app.component.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index b3c49f0..dffc2ea 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1,5 +1,6 @@
 <nav class="navbar navbar-light bg-faded">
   <a class="navbar-brand" href="#">Socially</a>
+  <login-buttons class="pull-right"></login-buttons>
 </nav>
 <div class="container-fluid">
   <router-outlet></router-outlet>
-- 
2.7.4 (Apple Git-66)


From 53f40a0e2d1687a172b4c4b62e9ed952309dd474 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:50:05 +0300
Subject: [PATCH 149/267] Step 17.6: Add fonts and FontAwesome

---
 client/index.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/index.html b/client/index.html
index 4e8596c..264730d 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,5 +1,8 @@
 <head>
+  <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
+  <link href='http://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
+  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
 </head>
 <body>
   <app>Loading...</app>
-- 
2.7.4 (Apple Git-66)


From f44d0b715a76fb5d17a9e4de0fc2195d57d4d133 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:53:42 +0300
Subject: [PATCH 150/267] Step 17.7: Update the new party form

---
 .../app/parties/parties-form.component.html        | 30 +++++++++++++---------
 1 file changed, 18 insertions(+), 12 deletions(-)

diff --git a/client/imports/app/parties/parties-form.component.html b/client/imports/app/parties/parties-form.component.html
index 3cc8990..c791629 100644
--- a/client/imports/app/parties/parties-form.component.html
+++ b/client/imports/app/parties/parties-form.component.html
@@ -1,15 +1,21 @@
-<form [formGroup]="addForm" (ngSubmit)="addParty()">
-  <label>Name</label>
-  <input type="text" formControlName="name">
+<form [formGroup]="addForm" (ngSubmit)="addParty()" class="form-inline">
+  <fieldset class="form-group">
+    <label for="partyName">Party name</label>
+    <input id="partyName" class="form-control" type="text" formControlName="name" placeholder="Party name" />
 
-  <label>Description</label>
-  <input type="text" formControlName="description">
+    <label for="description">Description</label>
+    <input id="description" class="form-control" type="text" formControlName="description" placeholder="Description">
 
-  <label>Location</label>
-  <input type="text" formControlName="location">
+    <label for="location_name">Location</label>
+    <input id="location_name" class="form-control" type="text" formControlName="location" placeholder="Location name">
 
-  <label>Public</label>
-  <input type="checkbox" formControlName="public">
-  
-  <button type="submit">Add</button>
-</form>
\ No newline at end of file
+    <div class="checkbox">
+      <label>
+        <input type="checkbox" formControlName="public">
+        Public
+      </label>
+    </div>
+
+    <button type="submit" class="btn btn-primary">Add</button>
+  </fieldset>
+</form>
-- 
2.7.4 (Apple Git-66)


From d4b8299fe5a76bbeb1ac63e767cab0e2598818ae Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:55:08 +0300
Subject: [PATCH 151/267] Step 17.8: Update parties list layout

---
 .../app/parties/parties-list.component.html        | 134 +++++++++++++++------
 1 file changed, 95 insertions(+), 39 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index 96fd80f..0629b28 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -1,44 +1,100 @@
-<div>
-  <parties-form [hidden]="!user" style="float: left"></parties-form>
-  <input type="text" #searchtext placeholder="Search by Location">
-  <button type="button" (click)="search(searchtext.value)">Search</button>
-
-  <h1>Parties:</h1>
-
-  <div>
-    <select #sort (change)="changeSortOrder(sort.value)">
+<div class="row">
+  <div class="col-md-12">
+    <div class="jumbotron">
+      <h3>Create a new party!</h3>
+      <parties-form [hidden]="!user"></parties-form>
+      <div [hidden]="user">You need to login to create new parties!</div>
+    </div>
+  </div>
+</div>
+<div class="row ma-filters">
+  <div class="col-md-6">
+    <h3>All Parties:</h3>
+    <form class="form-inline">
+      <input type="text" class="form-control" #searchtext placeholder="Search by Location">
+      <button type="button" class="btn btn-primary" (click)="search(searchtext.value)">Search</button>
+      Sort by name: <select class="form-control" #sort (change)="changeSortOrder(sort.value)">
       <option value="1" selected>Ascending</option>
       <option value="-1">Descending</option>
     </select>
+    </form>
+  </div>
+</div>
+<div class="row">
+  <div class="col-md-6">
+    <ul class="list-group">
+      <li class="list-group-item">
+        <pagination-controls (pageChange)="onPageChanged($event)"></pagination-controls>
+      </li>
+      <li *ngFor="let party of parties | async"
+          class="list-group-item ma-party-item">
+        <div class="row">
+          <div class="col-sm-8">
+            <h2 class="ma-party-name">
+              <a [routerLink]="['/party', party._id]">{{party.name}}</a>
+            </h2>
+            @ {{party.location.name}}
+            <p class="ma-party-description">
+              {{party.description}}
+            </p>
+          </div>
+          <div class="col-sm-4">
+            <button class="btn btn-danger pull-right" [hidden]="!isOwner(party)" (click)="removeParty(party)"><i
+              class="fa fa-times"></i></button>
+          </div>
+        </div>
+        <div class="row ma-party-item-bottom">
+          <div class="col-sm-4">
+            <div class="ma-rsvp-sum">
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{party | rsvp:'yes'}}
+                </div>
+                <div class="ma-rsvp-title">
+                  YES
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{party | rsvp:'maybe'}}
+                </div>
+                <div class="ma-rsvp-title">
+                  MAYBE
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{party | rsvp:'no'}}
+                </div>
+                <div class="ma-rsvp-title">
+                  NO
+                </div>
+              </div>
+            </div>
+          </div>
+        </div>
+      </li>
+      <li class="list-group-item">
+        <pagination-controls (pageChange)="onPageChanged($event)"></pagination-controls>
+      </li>
+    </ul>
+  </div>
+  <div class="col-md-6">
+    <ul class="list-group">
+      <li class="list-group-item">
+        <sebm-google-map
+          [latitude]="0"
+          [longitude]="0"
+          [zoom]="1">
+          <div *ngFor="let party of parties | async">
+            <sebm-google-map-marker
+              *ngIf="party.location.lat"
+              [latitude]="party.location.lat"
+              [longitude]="party.location.lng">
+            </sebm-google-map-marker>
+          </div>
+        </sebm-google-map>
+      </li>
+    </ul>
   </div>
-
-  <ul>
-    <li *ngFor="let party of parties | async">
-      <a [routerLink]="['/party', party._id]">{{party.name}}</a>
-      <p>{{party.description}}</p>
-      <p>{{party.location.name}}</p>
-      <button [hidden]="!isOwner(party)" (click)="removeParty(party)">X</button>
-      <div>
-        Who is coming:
-        Yes - {{party | rsvp:'yes'}}
-        Maybe - {{party | rsvp:'maybe'}}
-        No - {{party | rsvp:'no'}}
-      </div>
-    </li>
-  </ul>
-
-  <sebm-google-map
-    [latitude]="0"
-    [longitude]="0"
-    [zoom]="1">
-    <div *ngFor="let party of parties | async">
-      <sebm-google-map-marker
-        *ngIf="party.location.lat"
-        [latitude]="party.location.lat"
-        [longitude]="party.location.lng">
-      </sebm-google-map-marker>
-    </div>
-  </sebm-google-map>
-
-  <pagination-controls (pageChange)="onPageChanged($event)"></pagination-controls>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From d3a4b84f2394fec977780ae8f3e8c3fe7eda63a3 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:56:18 +0300
Subject: [PATCH 152/267] Step 17.9: Add styles for PartiesList

---
 .../app/parties/parties-list.component.scss        | 125 +++++++++++++++++++++
 1 file changed, 125 insertions(+)
 create mode 100644 client/imports/app/parties/parties-list.component.scss

diff --git a/client/imports/app/parties/parties-list.component.scss b/client/imports/app/parties/parties-list.component.scss
new file mode 100644
index 0000000..2cd8d06
--- /dev/null
+++ b/client/imports/app/parties/parties-list.component.scss
@@ -0,0 +1,125 @@
+.ma-add-button-container {
+  button.btn {
+    background: $color3;
+    float: right;
+    margin-right: 5px;
+    outline: none;
+    i {
+      color: $color5;
+    }
+  }
+}
+
+.ma-parties-col {
+  padding-top: 20px;
+}
+
+.ma-filters {
+  margin-bottom: 10px;
+}
+
+.ma-party-item {
+  .ma-party-name {
+    margin-bottom: 20px;
+    a {
+      color: $color6;
+      text-decoration: none !important;
+      font-weight: 400;
+    }
+  }
+  .ma-party-description {
+    color: $color6;
+    font-weight: 300;
+    padding-left: 18px;
+    font-size: 14px;
+  }
+
+  .ma-remove {
+    color: lighten($color7, 20%);
+    position: absolute;
+    right: 20px;
+    top: 20px;
+    &:hover {
+      color: $color7;
+    }
+  }
+
+  .ma-party-item-bottom {
+    padding-top: 10px;
+    .ma-posted-by-col {
+      .ma-posted-by {
+        color: darken($color4, 30%);
+        font-size: 12px;
+      }
+      .ma-everyone-invited {
+        @media (max-width: 400px) {
+          display: block;
+          i {
+            margin-left: 0px !important;
+          }
+        }
+        font-size: 12px;
+        color: darken($color4, 10%);
+        i {
+          color: darken($color4, 10%);
+          margin-left: 5px;
+        }
+      }
+    }
+
+    .ma-rsvp-buttons {
+      input.btn {
+        color: darken($color3, 20%);
+        background: transparent !important;
+        outline: none;
+        padding-left: 0;
+        &:active {
+          box-shadow: none;
+        }
+        &:hover {
+          color: darken($color3, 30%);
+        }
+        &.btn-primary {
+          color: lighten($color3, 10%);
+          border: 0;
+          background: transparent !important;
+        }
+      }
+    }
+
+    .ma-rsvp-sum {
+      width: 160px;
+      @media (min-width: 400px) {
+        float: right;
+      }
+      @media (max-width: 400px) {
+        margin: 0 auto;
+      }
+    }
+    .ma-rsvp-amount {
+      display: inline-block;
+      text-align: center;
+      width: 50px;
+      .ma-amount {
+        font-weight: bold;
+        font-size: 20px;
+      }
+      .ma-rsvp-title {
+        font-size: 11px;
+        color: #aaa;
+        text-transform: uppercase;
+      }
+    }
+  }
+}
+
+.ma-angular-map-col {
+  .angular-google-map-container, .angular-google-map {
+    height: 100%;
+    width: 100%;
+  }
+}
+
+.search-form {
+  margin-bottom: 1em;
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From c6a412c0d9401e4af695ce9b84ad1051623492e2 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:56:48 +0300
Subject: [PATCH 153/267] Step 17.10: Add styles for the party details page

---
 .../app/parties/party-details.component.scss       | 32 ++++++++++++++++++++++
 1 file changed, 32 insertions(+)
 create mode 100644 client/imports/app/parties/party-details.component.scss

diff --git a/client/imports/app/parties/party-details.component.scss b/client/imports/app/parties/party-details.component.scss
new file mode 100644
index 0000000..82dcfc3
--- /dev/null
+++ b/client/imports/app/parties/party-details.component.scss
@@ -0,0 +1,32 @@
+.ma-party-details-container {
+  padding: 20px;
+
+  .angular-google-map-container {
+    width: 100%;
+    height: 100%;
+  }
+
+  .angular-google-map {
+    width: 100%;
+    height: 400px;
+  }
+
+  .ma-map-title {
+    font-size: 16px;
+    font-weight: bolder;
+  }
+
+  .ma-invite-list {
+    margin-top: 20px;
+    margin-bottom: 20px;
+
+    h3 {
+      font-size: 16px;
+      font-weight: bolder;
+    }
+
+    ul {
+      padding: 0;
+    }
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From c504405b8c351e7f612b8435721abe7e10cdf52b Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:57:37 +0300
Subject: [PATCH 154/267] Step 17.11: Add components styles in main style entry
 point

---
 client/main.scss | 42 +++++++++++++++++++++++++++++++++++++++---
 1 file changed, 39 insertions(+), 3 deletions(-)

diff --git a/client/main.scss b/client/main.scss
index 5c3a0d0..1b0b7da 100644
--- a/client/main.scss
+++ b/client/main.scss
@@ -1,8 +1,44 @@
 @import "{}/node_modules/angular2-meteor-accounts-ui/build/login-buttons.scss";
 @import "{}/node_modules/bootstrap/scss/bootstrap.scss";
 
+$color1 : #2F2933;
+$color2 : #01A2A6;
+$color3 : #29D9C2;
+$color4 : #BDF271;
+$color5 : #FFFFA6;
+$color6 : #2F2933;
+$color7 : #FF6F69;
+
+html, body {
+  height: 100%;
+}
+
+body {
+  background-color: #f8f8f8;
+  font-family: 'Muli', sans-serif;
+}
 
 .sebm-google-map-container {
-  width: 400px;
-  height: 400px;
-}
\ No newline at end of file
+  width: 450px;
+  height: 450px;
+}
+
+.navbar {
+  background-color: #ffffff;
+  border-bottom: #eee 1px solid;
+  color: $color3;
+  font-family: 'Muli', sans-serif;
+  a {
+    color: $color3;
+    text-decoration: none !important;
+  }
+
+  .navbar-right-container {
+    position: absolute;
+    top: 17px;
+    right: 17px;
+  }
+}
+
+@import "./imports/app/parties/parties-list.component";
+@import "./imports/app/parties/party-details.component";
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 982167f4f6d52a23628c4e8d2f82e09a5620472f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:58:27 +0300
Subject: [PATCH 155/267] Step 17.12: Update the layout of the party details
 page

---
 .../app/parties/party-details.component.html       | 91 +++++++++++++---------
 1 file changed, 55 insertions(+), 36 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index 151fb03..c7fc234 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -1,42 +1,61 @@
-<form *ngIf="party" (submit)="saveParty()">
-  <label>Name</label>
-  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.name" name="name">
+<div class="row ma-party-details-container">
+  <div class="col-sm-6 col-sm-offset-3">
+    <legend>View and Edit Your Party Details:</legend>
+    <form class="form-horizontal" *ngIf="party" (submit)="saveParty()">
+      <div class="form-group">
+        <label>Party Name</label>
+        <input [disabled]="!isOwner" type="text" [(ngModel)]="party.name" name="name" class="form-control">
+      </div>
 
-  <label>Description</label>
-  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.description" name="description">
+      <div class="form-group">
+        <label>Description</label>
+        <input [disabled]="!isOwner" type="text" [(ngModel)]="party.description" name="description" class="form-control">
+      </div>
 
-  <label>Location</label>
-  <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location.name" name="location">
+      <div class="form-group">
+        <label>Location name</label>
+        <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location.name" name="location" class="form-control">
+      </div>
 
-  <button [disabled]="!isOwner" type="submit">Save</button>
-  <a [routerLink]="['/']">Cancel</a>
-</form>
+      <div class="form-group">
+        <button [disabled]="!isOwner" type="submit" class="btn btn-primary">Save</button>
+        <a [routerLink]="['/']" class="btn">Back</a>
+      </div>
+    </form>
 
-<div *ngIf="isOwner || isPublic">
-  <p>Users to invite:</p>
-  <ul>
-    <li *ngFor="let user of users | async">
-      <div>{{user | displayName}}</div>
-      <button (click)="invite(user)">Invite</button>
-    </li>
-  </ul>
-</div>
+    <ul class="ma-invite-list" *ngIf="isOwner || isPublic">
+      <h3>
+        Users to invite:
+      </h3>
+      <li *ngFor="let user of users | async">
+        <div>{{ user | displayName }}</div>
+        <button (click)="invite(user)" class="btn btn-primary btn-sm">Invite</button>
+      </li>
+    </ul>
 
-<div *ngIf="isInvited">
-  <h2>Reply to the invitation</h2>
-  <input type="button" value="I'm going!" (click)="reply('yes')">
-  <input type="button" value="Maybe" (click)="reply('maybe')">
-  <input type="button" value="No" (click)="reply('no')">
-</div>
+    <div *ngIf="isInvited">
+      <h2>Reply to the invitation</h2>
+      <input type="button" class="btn btn-primary" value="I'm going!" (click)="reply('yes')">
+      <input type="button" class="btn btn-warning" value="Maybe" (click)="reply('maybe')">
+      <input type="button" class="btn btn-danger" value="No" (click)="reply('no')">
+    </div>
 
-<sebm-google-map
-  [latitude]="lat || centerLat"
-  [longitude]="lng || centerLng"
-  [zoom]="8"
-  (mapClick)="mapClicked($event)">
-  <sebm-google-map-marker
-    *ngIf="lat && lng"
-    [latitude]="lat"
-    [longitude]="lng">
-  </sebm-google-map-marker>
-</sebm-google-map>
\ No newline at end of file
+    <h3 class="ma-map-title">
+      Click the map to set the party location
+    </h3>
+
+    <div class="angular-google-map-container">
+      <sebm-google-map
+        [latitude]="lat || centerLat"
+        [longitude]="lng || centerLng"
+        [zoom]="8"
+        (mapClick)="mapClicked($event)">
+        <sebm-google-map-marker
+          *ngIf="lat && lng"
+          [latitude]="lat"
+          [longitude]="lng">
+        </sebm-google-map-marker>
+      </sebm-google-map>
+    </div>
+  </div>
+</div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From b6c754c855fb9496b28c675fbedba3ff41106f10 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:59:21 +0300
Subject: [PATCH 156/267] Step 18.1: Uninstall bootstrap

---
 package.json | 1 -
 1 file changed, 1 deletion(-)

diff --git a/package.json b/package.json
index fa20c9c..cd88387 100644
--- a/package.json
+++ b/package.json
@@ -29,7 +29,6 @@
     "angular2-meteor-accounts-ui": "0.8.0",
     "angular2-meteor-polyfills": "^0.1.1",
     "angular2-meteor-tests-polyfills": "0.0.2",
-    "bootstrap": "^4.0.0-alpha.4",
     "meteor-node-stubs": "0.2.3",
     "meteor-rxjs": "0.2.3",
     "ng2-pagination": "0.4.1",
-- 
2.7.4 (Apple Git-66)


From 19d0f19d57414cf92757819729c789538a76ce95 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 12:59:34 +0300
Subject: [PATCH 157/267] Step 18.2: Remove bootstrap scss

---
 client/main.scss | 1 -
 1 file changed, 1 deletion(-)

diff --git a/client/main.scss b/client/main.scss
index 1b0b7da..16e869c 100644
--- a/client/main.scss
+++ b/client/main.scss
@@ -1,5 +1,4 @@
 @import "{}/node_modules/angular2-meteor-accounts-ui/build/login-buttons.scss";
-@import "{}/node_modules/bootstrap/scss/bootstrap.scss";
 
 $color1 : #2F2933;
 $color2 : #01A2A6;
-- 
2.7.4 (Apple Git-66)


From dd0eed2526f32be658b8b2b37f718c72108bec51 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:00:35 +0300
Subject: [PATCH 158/267] Step 18.3: Install @angular-material2 packages

---
 package.json | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/package.json b/package.json
index cd88387..5bcfc5b 100644
--- a/package.json
+++ b/package.json
@@ -24,6 +24,13 @@
     "@angular/platform-browser": "2.0.1",
     "@angular/platform-browser-dynamic": "2.0.1",
     "@angular/router": "3.0.1",
+    "@angular2-material/button": "2.0.0-alpha.8-2",
+    "@angular2-material/card": "2.0.0-alpha.8-2",
+    "@angular2-material/checkbox": "2.0.0-alpha.8-2",
+    "@angular2-material/core": "2.0.0-alpha.8-2",
+    "@angular2-material/input": "2.0.0-alpha.8-2",
+    "@angular2-material/list": "2.0.0-alpha.8-2",
+    "@angular2-material/toolbar": "2.0.0-alpha.8-2",
     "angular2-google-maps": "0.15.0",
     "angular2-meteor": "0.7.0",
     "angular2-meteor-accounts-ui": "0.8.0",
-- 
2.7.4 (Apple Git-66)


From ff94b7a86706fbd29fab18f0203ce64cb30708da Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:02:15 +0300
Subject: [PATCH 159/267] Step 18.4: Imported the angular2-material modules

---
 client/imports/app/app.module.ts | 16 +++++++++++++++-
 1 file changed, 15 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 0240ddf..2adac35 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -10,6 +10,13 @@ import { AppComponent } from './app.component';
 import { routes, ROUTES_PROVIDERS } from './app.routes';
 import { PARTIES_DECLARATIONS } from './parties';
 import { SHARED_DECLARATIONS } from './shared';
+import { MdButtonModule } from "@angular2-material/button";
+import { MdToolbarModule } from "@angular2-material/toolbar";
+import { MdInputModule } from "@angular2-material/input";
+import { MdCardModule } from "@angular2-material/card";
+import { MdCoreModule } from "@angular2-material/core";
+import { MdCheckboxModule } from "@angular2-material/checkbox";
+import {MdListModule} from "@angular2-material/list";
 
 @NgModule({
   imports: [
@@ -21,7 +28,14 @@ import { SHARED_DECLARATIONS } from './shared';
     Ng2PaginationModule,
     AgmCoreModule.forRoot({
       apiKey: 'AIzaSyAWoBdZHCNh5R-hB5S5ZZ2oeoYyfdDgniA'
-    })
+    }),
+    MdCoreModule.forRoot(),
+    MdButtonModule.forRoot(),
+    MdToolbarModule.forRoot(),
+    MdInputModule.forRoot(),
+    MdCardModule.forRoot(),
+    MdCheckboxModule.forRoot(),
+    MdListModule.forRoot()
   ],
   declarations: [
     AppComponent,
-- 
2.7.4 (Apple Git-66)


From 3f1f7036ee2034bc15307c9ab3035d57389251e2 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:21:11 +0300
Subject: [PATCH 160/267] Step 18.5: Change the nav bar and the layout

---
 client/imports/app/app.component.html | 13 ++++++-------
 1 file changed, 6 insertions(+), 7 deletions(-)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index dffc2ea..a021e59 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1,7 +1,6 @@
-<nav class="navbar navbar-light bg-faded">
-  <a class="navbar-brand" href="#">Socially</a>
-  <login-buttons class="pull-right"></login-buttons>
-</nav>
-<div class="container-fluid">
-  <router-outlet></router-outlet>
-</div>
\ No newline at end of file
+<md-toolbar color="primary">
+  <a routerLink="/" class="md-title">Socially</a>
+  <span class="fill-remaining-space"></span>
+  <login-buttons></login-buttons>
+</md-toolbar>
+<router-outlet></router-outlet>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From fe3cb387cf9399e6fce373e6f66c2fb14e1ed66e Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:21:21 +0300
Subject: [PATCH 161/267] Step 18.6: Added the missing css

---
 client/main.scss | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/main.scss b/client/main.scss
index 16e869c..d86c9f5 100644
--- a/client/main.scss
+++ b/client/main.scss
@@ -8,6 +8,10 @@ $color5 : #FFFFA6;
 $color6 : #2F2933;
 $color7 : #FF6F69;
 
+.fill-remaining-space {
+  flex: 1 1 auto;
+}
+
 html, body {
   height: 100%;
 }
-- 
2.7.4 (Apple Git-66)


From 73e3ea3c46d4e9e544868bd44edf9f6fd27f1b45 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:22:18 +0300
Subject: [PATCH 162/267] Step 18.7: Update the view of the parties form

---
 .../app/parties/parties-form.component.html        | 22 +++++++---------------
 1 file changed, 7 insertions(+), 15 deletions(-)

diff --git a/client/imports/app/parties/parties-form.component.html b/client/imports/app/parties/parties-form.component.html
index c791629..0318fa5 100644
--- a/client/imports/app/parties/parties-form.component.html
+++ b/client/imports/app/parties/parties-form.component.html
@@ -1,21 +1,13 @@
-<form [formGroup]="addForm" (ngSubmit)="addParty()" class="form-inline">
+<form [formGroup]="addForm" (ngSubmit)="addParty()">
   <fieldset class="form-group">
-    <label for="partyName">Party name</label>
-    <input id="partyName" class="form-control" type="text" formControlName="name" placeholder="Party name" />
-
-    <label for="description">Description</label>
-    <input id="description" class="form-control" type="text" formControlName="description" placeholder="Description">
-
-    <label for="location_name">Location</label>
-    <input id="location_name" class="form-control" type="text" formControlName="location" placeholder="Location name">
+    <md-input formControlName="name" placeholder="Party name"></md-input>
+    <md-input formControlName="description" placeholder="Description"></md-input>
+    <md-input formControlName="location" placeholder="Location name"></md-input>
 
     <div class="checkbox">
-      <label>
-        <input type="checkbox" formControlName="public">
-        Public
-      </label>
+      <md-checkbox formControlName="public">Public</md-checkbox>
     </div>
 
-    <button type="submit" class="btn btn-primary">Add</button>
+    <button md-raised-button type="submit">Add</button>
   </fieldset>
-</form>
+</form>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 97c48a038a52d9b97088c0938e325d3882be97c4 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:25:12 +0300
Subject: [PATCH 163/267] Step 18.8: Change the layout of the parties list

---
 .../app/parties/parties-list.component.html        | 141 +++++++++------------
 1 file changed, 59 insertions(+), 82 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index 0629b28..8ca6bf0 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -1,88 +1,65 @@
-<div class="row">
-  <div class="col-md-12">
-    <div class="jumbotron">
-      <h3>Create a new party!</h3>
-      <parties-form [hidden]="!user"></parties-form>
-      <div [hidden]="user">You need to login to create new parties!</div>
-    </div>
-  </div>
-</div>
-<div class="row ma-filters">
-  <div class="col-md-6">
-    <h3>All Parties:</h3>
-    <form class="form-inline">
-      <input type="text" class="form-control" #searchtext placeholder="Search by Location">
-      <button type="button" class="btn btn-primary" (click)="search(searchtext.value)">Search</button>
-      Sort by name: <select class="form-control" #sort (change)="changeSortOrder(sort.value)">
-      <option value="1" selected>Ascending</option>
-      <option value="-1">Descending</option>
-    </select>
-    </form>
-  </div>
-</div>
-<div class="row">
-  <div class="col-md-6">
-    <ul class="list-group">
-      <li class="list-group-item">
-        <pagination-controls (pageChange)="onPageChanged($event)"></pagination-controls>
-      </li>
-      <li *ngFor="let party of parties | async"
-          class="list-group-item ma-party-item">
-        <div class="row">
-          <div class="col-sm-8">
-            <h2 class="ma-party-name">
-              <a [routerLink]="['/party', party._id]">{{party.name}}</a>
-            </h2>
-            @ {{party.location.name}}
-            <p class="ma-party-description">
-              {{party.description}}
-            </p>
-          </div>
-          <div class="col-sm-4">
-            <button class="btn btn-danger pull-right" [hidden]="!isOwner(party)" (click)="removeParty(party)"><i
-              class="fa fa-times"></i></button>
-          </div>
+<div flex layout="row" class="div ma-parties-list">
+  <div layout="row" flex>
+    <div flex="50">
+      <div>
+        <div class="div new-party-form-container">
+          <md-toolbar>
+            <div class="md-toolbar-tools">
+              <h3>Create a new party!</h3>
+            </div>
+          </md-toolbar>
+          <parties-form [hidden]="!user"></parties-form>
+          <div [hidden]="user">You need to login to create new parties!</div>
         </div>
-        <div class="row ma-party-item-bottom">
-          <div class="col-sm-4">
-            <div class="ma-rsvp-sum">
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{party | rsvp:'yes'}}
-                </div>
-                <div class="ma-rsvp-title">
-                  YES
-                </div>
-              </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{party | rsvp:'maybe'}}
-                </div>
-                <div class="ma-rsvp-title">
-                  MAYBE
-                </div>
-              </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{party | rsvp:'no'}}
-                </div>
-                <div class="ma-rsvp-title">
-                  NO
+        <div layout-padding layout="row">
+          <md-input #searchtext placeholder="Search by Location"></md-input>
+        </div>
+        <div layout-padding layout="row">
+          Sort by name:
+          <select class="form-control" #sort (change)="changeSortOrder(sort.value)">
+            <option value="1" selected>Ascending</option>
+            <option value="-1">Descending</option>
+          </select>
+        </div>
+
+        <div class="div md-padding" style="padding-top:0;">
+          <pagination-controls (pageChange)="onPageChanged($event)"></pagination-controls>
+          <div *ngFor="let party of parties | async">
+            <md-card>
+              <md-card-content>
+                <h2 class="md-title ma-name">
+                  <a [routerLink]="['/party', party._id]">{{party.name}}</a>
+                </h2>
+                <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">
+                  {{party.description}}
+                </p>
+                <div layout="row">
+                  <div layout="row" layout-align="end end">
+                    <div>
+                      <div class="rsvps-sum">
+                        <div class="rsvps-amount">{{party | rsvp:'yes'}}</div>
+                        <div class="rsvps-title">Yes</div>
+                      </div>
+                      <div class="rsvps-sum">
+                        <div class="rsvps-amount">{{party | rsvp:'maybe'}}</div>
+                        <div class="rsvps-title">Maybe</div>
+                      </div>
+                      <div class="rsvps-sum">
+                        <div class="rsvps-amount">{{party | rsvp:'no'}}</div>
+                        <div class="rsvps-title">No</div>
+                      </div>
+                    </div>
+                  </div>
                 </div>
-              </div>
-            </div>
+              </md-card-content>
+            </md-card>
           </div>
         </div>
-      </li>
-      <li class="list-group-item">
-        <pagination-controls (pageChange)="onPageChanged($event)"></pagination-controls>
-      </li>
-    </ul>
-  </div>
-  <div class="col-md-6">
-    <ul class="list-group">
-      <li class="list-group-item">
+      </div>
+      <div flex="50" layout="row" style="min-height:300px;">
         <sebm-google-map
+          style="width: 100%; min-height:300px;"
+          flex layout="row"
           [latitude]="0"
           [longitude]="0"
           [zoom]="1">
@@ -94,7 +71,7 @@
             </sebm-google-map-marker>
           </div>
         </sebm-google-map>
-      </li>
-    </ul>
+      </div>
+    </div>
   </div>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 684e3a297deb918a55129b721d439f3390fdfa2f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:25:40 +0300
Subject: [PATCH 164/267] Step 18.10: Add some style to the parties list

---
 .../app/parties/parties-list.component.scss        | 148 ++++++---------------
 1 file changed, 42 insertions(+), 106 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.scss b/client/imports/app/parties/parties-list.component.scss
index 2cd8d06..60f77b1 100644
--- a/client/imports/app/parties/parties-list.component.scss
+++ b/client/imports/app/parties/parties-list.component.scss
@@ -1,125 +1,61 @@
-.ma-add-button-container {
-  button.btn {
-    background: $color3;
-    float: right;
-    margin-right: 5px;
-    outline: none;
-    i {
-      color: $color5;
-    }
-  }
-}
-
-.ma-parties-col {
-  padding-top: 20px;
-}
-
-.ma-filters {
-  margin-bottom: 10px;
+.new-party-form-container {
+  margin: 20px;
+  border: 1px gainsboro solid;
 }
-
-.ma-party-item {
-  .ma-party-name {
-    margin-bottom: 20px;
-    a {
-      color: $color6;
-      text-decoration: none !important;
-      font-weight: 400;
-    }
+.ma-parties-list {
+  .sebm-google-map {
+    box-sizing: border-box;
+    -webkit-flex: 1;
+    -ms-flex: 1;
+    flex: 1;
+    -webkit-flex-direction: row;
+    -ms-flex-direction: row;
+    flex-direction: row;
+    box-sizing: border-box;
+    display: -webkit-flex;
+    display: -ms-flexbox;
+    display: flex;
   }
-  .ma-party-description {
-    color: $color6;
-    font-weight: 300;
-    padding-left: 18px;
-    font-size: 14px;
+
+  .angular-google-map-container {
+    box-sizing: border-box;
+    -webkit-flex: 1;
+    -ms-flex: 1;
+    flex: 1;
   }
 
-  .ma-remove {
-    color: lighten($color7, 20%);
-    position: absolute;
-    right: 20px;
-    top: 20px;
-    &:hover {
-      color: $color7;
+  .rsvps-sum {
+    display: inline-block;
+    width: 50px;
+    text-align: center;
+    .rsvps-amount {
+      font-size: 24px;
+    }
+    .rsvps-title {
+      font-size: 13px;
+      color: #aaa;
     }
   }
 
-  .ma-party-item-bottom {
-    padding-top: 10px;
-    .ma-posted-by-col {
-      .ma-posted-by {
-        color: darken($color4, 30%);
-        font-size: 12px;
-      }
-      .ma-everyone-invited {
-        @media (max-width: 400px) {
-          display: block;
-          i {
-            margin-left: 0px !important;
-          }
-        }
-        font-size: 12px;
-        color: darken($color4, 10%);
-        i {
-          color: darken($color4, 10%);
-          margin-left: 5px;
-        }
-      }
+  .ma-party {
+    .party-image {
+      background-size: cover;
+      width: 100%;
+      height: 200px;
     }
 
-    .ma-rsvp-buttons {
-      input.btn {
-        color: darken($color3, 20%);
-        background: transparent !important;
-        outline: none;
-        padding-left: 0;
-        &:active {
-          box-shadow: none;
-        }
-        &:hover {
-          color: darken($color3, 30%);
-        }
-        &.btn-primary {
-          color: lighten($color3, 10%);
-          border: 0;
-          background: transparent !important;
-        }
+    .ma-name {
+      a {
+        text-decoration: none;
+        color: #333;
       }
     }
+    .ma-description {
 
-    .ma-rsvp-sum {
-      width: 160px;
-      @media (min-width: 400px) {
-        float: right;
-      }
-      @media (max-width: 400px) {
-        margin: 0 auto;
-      }
-    }
-    .ma-rsvp-amount {
-      display: inline-block;
-      text-align: center;
-      width: 50px;
-      .ma-amount {
-        font-weight: bold;
-        font-size: 20px;
-      }
-      .ma-rsvp-title {
-        font-size: 11px;
-        color: #aaa;
-        text-transform: uppercase;
-      }
     }
   }
 }
 
-.ma-angular-map-col {
-  .angular-google-map-container, .angular-google-map {
-    height: 100%;
-    width: 100%;
-  }
-}
-
 .search-form {
   margin-bottom: 1em;
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From bc08d7cda9a85f421e4c33851a6e80bf42df6e8e Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:34:03 +0300
Subject: [PATCH 165/267] Step 18.11: Update the layout of the party details

---
 .../app/parties/party-details.component.html       | 97 ++++++++++------------
 1 file changed, 43 insertions(+), 54 deletions(-)

diff --git a/client/imports/app/parties/party-details.component.html b/client/imports/app/parties/party-details.component.html
index c7fc234..ff5e42b 100644
--- a/client/imports/app/parties/party-details.component.html
+++ b/client/imports/app/parties/party-details.component.html
@@ -1,61 +1,50 @@
-<div class="row ma-party-details-container">
-  <div class="col-sm-6 col-sm-offset-3">
-    <legend>View and Edit Your Party Details:</legend>
-    <form class="form-horizontal" *ngIf="party" (submit)="saveParty()">
-      <div class="form-group">
-        <label>Party Name</label>
-        <input [disabled]="!isOwner" type="text" [(ngModel)]="party.name" name="name" class="form-control">
-      </div>
-
-      <div class="form-group">
-        <label>Description</label>
-        <input [disabled]="!isOwner" type="text" [(ngModel)]="party.description" name="description" class="form-control">
-      </div>
-
-      <div class="form-group">
+<div layout="row" flex class="ma-party-details">
+  <div flex="33" offset="33">
+    <div class="md-content new-party-form-container">
+      <md-toolbar>
+        <div class="md-toolbar-tools">
+          <h3>Your party details:</h3>
+        </div>
+      </md-toolbar>
+      <form layout="column" *ngIf="party" (submit)="saveParty()">
+        <label>Party Name: </label>
+        <md-input [disabled]="!isOwner" [(ngModel)]="party.name" name="name"></md-input>
+        <label>Party Description</label>
+        <md-input [disabled]="!isOwner" [(ngModel)]="party.description" name="description"></md-input>
         <label>Location name</label>
-        <input [disabled]="!isOwner" type="text" [(ngModel)]="party.location.name" name="location" class="form-control">
-      </div>
-
-      <div class="form-group">
-        <button [disabled]="!isOwner" type="submit" class="btn btn-primary">Save</button>
-        <a [routerLink]="['/']" class="btn">Back</a>
-      </div>
-    </form>
+        <md-input [disabled]="!isOwner" [(ngModel)]="party.location.name" name="location"></md-input>
+        <md-checkbox [disabled]="!isOwner" [(checked)]="party.public" name="public" aria-label="Public">
+          Is public
+        </md-checkbox>
 
-    <ul class="ma-invite-list" *ngIf="isOwner || isPublic">
-      <h3>
-        Users to invite:
-      </h3>
-      <li *ngFor="let user of users | async">
-        <div>{{ user | displayName }}</div>
-        <button (click)="invite(user)" class="btn btn-primary btn-sm">Invite</button>
-      </li>
-    </ul>
-
-    <div *ngIf="isInvited">
-      <h2>Reply to the invitation</h2>
-      <input type="button" class="btn btn-primary" value="I'm going!" (click)="reply('yes')">
-      <input type="button" class="btn btn-warning" value="Maybe" (click)="reply('maybe')">
-      <input type="button" class="btn btn-danger" value="No" (click)="reply('no')">
-    </div>
+        <div layout="row" layout-align="left">
+          <button [disabled]="!isOwner" type="submit" md-raised-button class="md-raised md-primary">Save</button>
+          <a [routerLink]="['/']" md-raised-button class="md-raised">Back</a>
+        </div>
 
-    <h3 class="ma-map-title">
-      Click the map to set the party location
-    </h3>
+        <md-list>
+          <div class="md-no-sticky">Users to invite:</div>
+          <md-list-item *ngFor="let user of users | async">
+            <div>{{ user | displayName }}</div>
+            <button (click)="invite(user)" md-raised-button class="md-raised">Invite</button>
+          </md-list-item>
+        </md-list>
 
-    <div class="angular-google-map-container">
-      <sebm-google-map
-        [latitude]="lat || centerLat"
-        [longitude]="lng || centerLng"
-        [zoom]="8"
-        (mapClick)="mapClicked($event)">
-        <sebm-google-map-marker
-          *ngIf="lat && lng"
-          [latitude]="lat"
-          [longitude]="lng">
-        </sebm-google-map-marker>
-      </sebm-google-map>
+        <div class="angular-google-map-container">
+          <sebm-google-map
+            style="height: 300px;"
+            [latitude]="lat || centerLat"
+            [longitude]="lng || centerLng"
+            [zoom]="8"
+            (mapClick)="mapClicked($event)">
+            <sebm-google-map-marker
+              *ngIf="lat && lng"
+              [latitude]="lat"
+              [longitude]="lng">
+            </sebm-google-map-marker>
+          </sebm-google-map>
+        </div>
+      </form>
     </div>
   </div>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 3ae60f4c24b187a49f09b7197ebff0189280f72f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:34:54 +0300
Subject: [PATCH 166/267] Step 18.12: Replace login buttons with custom buttons

---
 client/imports/app/app.component.html | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
index a021e59..f6c5855 100644
--- a/client/imports/app/app.component.html
+++ b/client/imports/app/app.component.html
@@ -1,6 +1,13 @@
 <md-toolbar color="primary">
   <a routerLink="/" class="md-title">Socially</a>
   <span class="fill-remaining-space"></span>
-  <login-buttons></login-buttons>
+  <div [hidden]="user">
+    <a md-button [routerLink]="['/login']" >Login</a>
+    <a md-button [routerLink]="['/signup']">Sign up</a>
+  </div>
+  <div [hidden]="!user">
+    <span>{{ user | displayName }}</span>
+    <button md-button (click)="logout()">Logout</button>
+  </div>
 </md-toolbar>
 <router-outlet></router-outlet>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 9e115044d93c097d3ffddb5877cb9a8b91f531a8 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:35:54 +0300
Subject: [PATCH 167/267] Step 18.13: Add auth logic to the App component

---
 client/imports/app/app.component.ts | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
index 91e1a06..ba12be4 100644
--- a/client/imports/app/app.component.ts
+++ b/client/imports/app/app.component.ts
@@ -1,9 +1,19 @@
 import { Component } from '@angular/core';
 
 import template from './app.component.html';
+import {InjectUser} from "angular2-meteor-accounts-ui";
 
 @Component({
   selector: 'app',
   template
 })
-export class AppComponent {}
+@InjectUser('user')
+export class AppComponent {
+  constructor() {
+
+  }
+
+  logout() {
+    Meteor.logout();
+  }
+}
-- 
2.7.4 (Apple Git-66)


From e0a1dd4c622aa82c3c22c66fb1512954f8bb8bfe Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:46:12 +0300
Subject: [PATCH 168/267] Step 18.14: Create LoginComponent

---
 client/imports/app/auth/login.component.ts | 40 ++++++++++++++++++++++++++++++
 1 file changed, 40 insertions(+)
 create mode 100644 client/imports/app/auth/login.component.ts

diff --git a/client/imports/app/auth/login.component.ts b/client/imports/app/auth/login.component.ts
new file mode 100644
index 0000000..ed740de
--- /dev/null
+++ b/client/imports/app/auth/login.component.ts
@@ -0,0 +1,40 @@
+import {Component, OnInit, NgZone} from '@angular/core';
+import { FormBuilder, FormGroup, Validators } from '@angular/forms';
+import { Router } from '@angular/router';
+import { Meteor } from 'meteor/meteor';
+
+import template from './login.component.html';
+
+@Component({
+  selector: 'login',
+  template
+})
+export class LoginComponent implements OnInit {
+  loginForm: FormGroup;
+  error: string;
+
+  constructor(private router: Router, private zone: NgZone, private formBuilder: FormBuilder) {}
+
+  ngOnInit() {
+    this.loginForm = this.formBuilder.group({
+      email: ['', Validators.required],
+      password: ['', Validators.required]
+    });
+
+    this.error = '';
+  }
+
+  login() {
+    if (this.loginForm.valid) {
+      Meteor.loginWithPassword(this.loginForm.value.email, this.loginForm.value.password, (err) => {
+        if (err) {
+          this.zone.run(() => {
+            this.error = err;
+          });
+        } else {
+          this.router.navigate(['/']);
+        }
+      });
+    }
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From d6695954c43ea398f137a3afa0c0fcaab67f3f30 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:46:21 +0300
Subject: [PATCH 169/267] Step 18.15: Create a template for LoginComponent

---
 client/imports/app/auth/login.component.html | 37 ++++++++++++++++++++++++++++
 1 file changed, 37 insertions(+)
 create mode 100644 client/imports/app/auth/login.component.html

diff --git a/client/imports/app/auth/login.component.html b/client/imports/app/auth/login.component.html
new file mode 100644
index 0000000..04fe11c
--- /dev/null
+++ b/client/imports/app/auth/login.component.html
@@ -0,0 +1,37 @@
+<div class="md-content" layout="row" layout-align="center start" layout-fill layout-margin>
+  <div layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+    <md-toolbar class="md-primary" color="primary">
+      Sign in
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Sign in with your email</p>
+      </div>
+
+      <form [formGroup]="loginForm" #f="ngForm" (ngSubmit)="login()"
+            layout="column" layout-fill layout-padding layout-margin>
+
+        <md-input formControlName="email" type="email" placeholder="Email"></md-input>
+        <md-input formControlName="password" type="password" placeholder="Password"></md-input>
+
+        <div layout="row" layout-align="space-between center">
+          <a md-button [routerLink]="['/recover']">Forgot password?</a>
+          <button md-raised-button class="md-primary" type="submit" aria-label="login">Sign In</button>
+        </div>
+      </form>
+
+      <div [hidden]="error == ''">
+        <md-toolbar class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+          <p class="md-body-1">{{ error }}</p>
+        </md-toolbar>
+      </div>
+
+      <md-divider></md-divider>
+
+      <div layout="row" layout-align="center">
+        <a md-button [routerLink]="['/signup']">Need an account?</a>
+      </div>
+    </div>
+  </div>
+</div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 1c36823b1511fe2e3b8449090c590bf5a59f8733 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:46:33 +0300
Subject: [PATCH 170/267] Step 18.16: Add the login route

---
 client/imports/app/app.routes.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.routes.ts b/client/imports/app/app.routes.ts
index c5812a4..83e37a2 100644
--- a/client/imports/app/app.routes.ts
+++ b/client/imports/app/app.routes.ts
@@ -3,10 +3,12 @@ import { Meteor } from 'meteor/meteor';
 
 import { PartiesListComponent } from './parties/parties-list.component';
 import { PartyDetailsComponent } from './parties/party-details.component';
+import {LoginComponent} from "./auth/login.component";
 
 export const routes: Route[] = [
   { path: '', component: PartiesListComponent },
-  { path: 'party/:partyId', component: PartyDetailsComponent, canActivate: ['canActivateForLoggedIn'] }
+  { path: 'party/:partyId', component: PartyDetailsComponent, canActivate: ['canActivateForLoggedIn'] },
+  { path: 'login', component: LoginComponent }
 ];
 
 export const ROUTES_PROVIDERS = [{
-- 
2.7.4 (Apple Git-66)


From 55ba50995815c5ffad58cf8ebe700ace61c98aea Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:46:49 +0300
Subject: [PATCH 171/267] Step 18.17: Create the index file for auth component

---
 client/imports/app/auth/index.ts | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 client/imports/app/auth/index.ts

diff --git a/client/imports/app/auth/index.ts b/client/imports/app/auth/index.ts
new file mode 100644
index 0000000..c8c17d6
--- /dev/null
+++ b/client/imports/app/auth/index.ts
@@ -0,0 +1,5 @@
+import {LoginComponent} from "./login.component";
+
+export const AUTH_DECLARATIONS = [
+  LoginComponent
+];
-- 
2.7.4 (Apple Git-66)


From 54a095364ab0c396ad744dd888531780e2be88bb Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:47:01 +0300
Subject: [PATCH 172/267] Step 18.18: Updated the NgModule imports

---
 client/imports/app/app.module.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 2adac35..32d4df7 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -17,6 +17,7 @@ import { MdCardModule } from "@angular2-material/card";
 import { MdCoreModule } from "@angular2-material/core";
 import { MdCheckboxModule } from "@angular2-material/checkbox";
 import {MdListModule} from "@angular2-material/list";
+import {AUTH_DECLARATIONS} from "./auth/index";
 
 @NgModule({
   imports: [
@@ -40,7 +41,8 @@ import {MdListModule} from "@angular2-material/list";
   declarations: [
     AppComponent,
     ...PARTIES_DECLARATIONS,
-    ...SHARED_DECLARATIONS
+    ...SHARED_DECLARATIONS,
+    ...AUTH_DECLARATIONS
   ],
   providers: [
     ...ROUTES_PROVIDERS
-- 
2.7.4 (Apple Git-66)


From 50eb65957a98ad912db37348311947d9acb17829 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:50:22 +0300
Subject: [PATCH 173/267] Step 18.19: Added the signup component

---
 client/imports/app/auth/singup.component.ts | 43 +++++++++++++++++++++++++++++
 1 file changed, 43 insertions(+)
 create mode 100644 client/imports/app/auth/singup.component.ts

diff --git a/client/imports/app/auth/singup.component.ts b/client/imports/app/auth/singup.component.ts
new file mode 100644
index 0000000..eed82b2
--- /dev/null
+++ b/client/imports/app/auth/singup.component.ts
@@ -0,0 +1,43 @@
+import {Component, OnInit, NgZone} from '@angular/core';
+import { FormBuilder, FormGroup, Validators } from '@angular/forms';
+import { Router } from '@angular/router';
+import { Accounts } from 'meteor/accounts-base';
+
+import template from './signup.component.html';
+
+@Component({
+  selector: 'signup',
+  template
+})
+export class SignupComponent implements OnInit {
+  signupForm: FormGroup;
+  error: string;
+
+  constructor(private router: Router, private zone: NgZone, private formBuilder: FormBuilder) {}
+
+  ngOnInit() {
+    this.signupForm = this.formBuilder.group({
+      email: ['', Validators.required],
+      password: ['', Validators.required]
+    });
+
+    this.error = '';
+  }
+
+  signup() {
+    if (this.signupForm.valid) {
+      Accounts.createUser({
+        email: this.signupForm.value.email,
+        password: this.signupForm.value.password
+      }, (err) => {
+        if (err) {
+          this.zone.run(() => {
+            this.error = err;
+          });
+        } else {
+          this.router.navigate(['/']);
+        }
+      });
+    }
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 4749bbf42ac2e3f2f1c12185088e9dfbffefcb52 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:50:30 +0300
Subject: [PATCH 174/267] Step 18.20: Added the signup view

---
 client/imports/app/auth/signup.component.html | 32 +++++++++++++++++++++++++++
 1 file changed, 32 insertions(+)
 create mode 100644 client/imports/app/auth/signup.component.html

diff --git a/client/imports/app/auth/signup.component.html b/client/imports/app/auth/signup.component.html
new file mode 100644
index 0000000..eccbff8
--- /dev/null
+++ b/client/imports/app/auth/signup.component.html
@@ -0,0 +1,32 @@
+<div class="md-content" layout="row" layout-align="center start" layout-fill layout-margin>
+  <div layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+    <md-toolbar class="md-primary" color="primary">
+      Sign up
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <form [formGroup]="signupForm" #f="ngForm" (ngSubmit)="signup()"
+            layout="column" layout-fill layout-padding layout-margin>
+
+        <md-input formControlName="email" type="email" placeholder="Email"></md-input>
+        <md-input formControlName="password" type="password" placeholder="Password"></md-input>
+
+        <div layout="row" layout-align="space-between center">
+          <button md-raised-button class="md-primary" type="submit" aria-label="login">Sign Up</button>
+        </div>
+      </form>
+
+      <div [hidden]="error == ''">
+        <md-toolbar class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+          <p class="md-body-1">{{ error }}</p>
+        </md-toolbar>
+      </div>
+
+      <md-divider></md-divider>
+
+      <div layout="row" layout-align="center">
+        <a md-button [routerLink]="['/login']">Already a user?</a>
+      </div>
+    </div>
+  </div>
+</div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 7287c89875d5e7acf733b9d293f262f4222b3c73 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:50:49 +0300
Subject: [PATCH 175/267] Step 18.21: Added signup component to the index file

---
 client/imports/app/auth/index.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/auth/index.ts b/client/imports/app/auth/index.ts
index c8c17d6..fa4ee3e 100644
--- a/client/imports/app/auth/index.ts
+++ b/client/imports/app/auth/index.ts
@@ -1,5 +1,7 @@
 import {LoginComponent} from "./login.component";
+import {SignupComponent} from "./singup.component";
 
 export const AUTH_DECLARATIONS = [
-  LoginComponent
+  LoginComponent,
+  SignupComponent
 ];
-- 
2.7.4 (Apple Git-66)


From 832adb962cfabb35e10420e7ecbc381bf7e225bc Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:51:05 +0300
Subject: [PATCH 176/267] Step 18.22: Added signup route

---
 client/imports/app/app.routes.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.routes.ts b/client/imports/app/app.routes.ts
index 83e37a2..d9ad40c 100644
--- a/client/imports/app/app.routes.ts
+++ b/client/imports/app/app.routes.ts
@@ -4,11 +4,13 @@ import { Meteor } from 'meteor/meteor';
 import { PartiesListComponent } from './parties/parties-list.component';
 import { PartyDetailsComponent } from './parties/party-details.component';
 import {LoginComponent} from "./auth/login.component";
+import {SignupComponent} from "./auth/singup.component";
 
 export const routes: Route[] = [
   { path: '', component: PartiesListComponent },
   { path: 'party/:partyId', component: PartyDetailsComponent, canActivate: ['canActivateForLoggedIn'] },
-  { path: 'login', component: LoginComponent }
+  { path: 'login', component: LoginComponent },
+  { path: 'signup', component: SignupComponent }
 ];
 
 export const ROUTES_PROVIDERS = [{
-- 
2.7.4 (Apple Git-66)


From 0a53a7fa37fa0323fb3ae122be3152e68962b83f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:53:55 +0300
Subject: [PATCH 177/267] Step 18.23: Create the recover component

---
 client/imports/app/auth/recover.component.ts | 41 ++++++++++++++++++++++++++++
 1 file changed, 41 insertions(+)
 create mode 100644 client/imports/app/auth/recover.component.ts

diff --git a/client/imports/app/auth/recover.component.ts b/client/imports/app/auth/recover.component.ts
new file mode 100644
index 0000000..6b520c6
--- /dev/null
+++ b/client/imports/app/auth/recover.component.ts
@@ -0,0 +1,41 @@
+import {Component, OnInit, NgZone} from '@angular/core';
+import { FormBuilder, FormGroup, Validators } from '@angular/forms';
+import { Router } from '@angular/router';
+import { Accounts } from 'meteor/accounts-base';
+
+import template from './recover.component.html';
+
+@Component({
+  selector: 'recover',
+  template
+})
+export class RecoverComponent implements OnInit {
+  recoverForm: FormGroup;
+  error: string;
+
+  constructor(private router: Router, private zone: NgZone, private formBuilder: FormBuilder) {}
+
+  ngOnInit() {
+    this.recoverForm = this.formBuilder.group({
+      email: ['', Validators.required]
+    });
+
+    this.error = '';
+  }
+
+  recover() {
+    if (this.recoverForm.valid) {
+      Accounts.forgotPassword({
+        email: this.recoverForm.value.email
+      }, (err) => {
+        if (err) {
+          this.zone.run(() => {
+            this.error = err;
+          });
+        } else {
+          this.router.navigate(['/']);
+        }
+      });
+    }
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 3976a2117ff444b4aa9dd69ad8241e2f43ced888 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:54:00 +0300
Subject: [PATCH 178/267] Step 18.24: Create the recover component view

---
 client/imports/app/auth/recover.component.html | 31 ++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 client/imports/app/auth/recover.component.html

diff --git a/client/imports/app/auth/recover.component.html b/client/imports/app/auth/recover.component.html
new file mode 100644
index 0000000..192629d
--- /dev/null
+++ b/client/imports/app/auth/recover.component.html
@@ -0,0 +1,31 @@
+<div class="md-content" layout="row" layout-align="center start" layout-fill layout-margin>
+  <div layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+    <md-toolbar class="md-primary" color="primary">
+      Recover Your Password
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <form [formGroup]="recoverForm" #f="ngForm" (ngSubmit)="recover()"
+            layout="column" layout-fill layout-padding layout-margin>
+
+        <md-input formControlName="email" type="email" placeholder="Email"></md-input>
+
+        <div layout="row" layout-align="space-between center">
+          <button md-raised-button class="md-primary" type="submit" aria-label="Recover">Recover</button>
+        </div>
+      </form>
+
+      <div [hidden]="error == ''">
+        <md-toolbar class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+          <p class="md-body-1">{{ error }}</p>
+        </md-toolbar>
+      </div>
+
+      <md-divider></md-divider>
+
+      <div layout="row" layout-align="center">
+        <a md-button [routerLink]="['/login']">Remember your password?</a>
+      </div>
+    </div>
+  </div>
+</divt>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 6f0241d3666c512c75ec8ce715827e5d1b41a1ed Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:54:09 +0300
Subject: [PATCH 179/267] Step 18.25: Added the recover component to the index
 file

---
 client/imports/app/auth/index.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/auth/index.ts b/client/imports/app/auth/index.ts
index fa4ee3e..7e5754e 100644
--- a/client/imports/app/auth/index.ts
+++ b/client/imports/app/auth/index.ts
@@ -1,7 +1,9 @@
 import {LoginComponent} from "./login.component";
 import {SignupComponent} from "./singup.component";
+import {RecoverComponent} from "./recover.component";
 
 export const AUTH_DECLARATIONS = [
   LoginComponent,
-  SignupComponent
+  SignupComponent,
+  RecoverComponent
 ];
-- 
2.7.4 (Apple Git-66)


From b7834f3a43d280663b8c84b95be24d592e3a3622 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:54:19 +0300
Subject: [PATCH 180/267] Step 18.26: Added the recover route

---
 client/imports/app/app.routes.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.routes.ts b/client/imports/app/app.routes.ts
index d9ad40c..efefd60 100644
--- a/client/imports/app/app.routes.ts
+++ b/client/imports/app/app.routes.ts
@@ -5,12 +5,14 @@ import { PartiesListComponent } from './parties/parties-list.component';
 import { PartyDetailsComponent } from './parties/party-details.component';
 import {LoginComponent} from "./auth/login.component";
 import {SignupComponent} from "./auth/singup.component";
+import {RecoverComponent} from "./auth/recover.component";
 
 export const routes: Route[] = [
   { path: '', component: PartiesListComponent },
   { path: 'party/:partyId', component: PartyDetailsComponent, canActivate: ['canActivateForLoggedIn'] },
   { path: 'login', component: LoginComponent },
-  { path: 'signup', component: SignupComponent }
+  { path: 'signup', component: SignupComponent },
+  { path: 'recover', component: RecoverComponent }
 ];
 
 export const ROUTES_PROVIDERS = [{
-- 
2.7.4 (Apple Git-66)


From a52be45e1e2587a9c15bacf206a166a4c18f9577 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:57:57 +0300
Subject: [PATCH 181/267] Step 20.1: Added jalik:ufs and jalik:ufs-gridfs

---
 .meteor/packages | 2 ++
 .meteor/versions | 3 +++
 2 files changed, 5 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 6c5c67f..2d94ff6 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -25,3 +25,5 @@ accounts-password
 tmeasday:publish-counts
 check
 email
+jalik:ufs
+jalik:ufs-gridfs
diff --git a/.meteor/versions b/.meteor/versions
index f90fa45..c3f660f 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -42,11 +42,14 @@ htmljs@1.0.11
 http@1.1.8
 hwillson:stub-collections@1.0.1
 id-map@1.0.8
+jalik:ufs@0.6.9_1
+jalik:ufs-gridfs@0.1.2
 jquery@1.11.9
 launch-screen@1.0.12
 livedata@1.0.18
 localstorage@1.0.11
 logging@1.1.15
+matb33:collection-hooks@0.7.15
 meteor@1.2.17
 meteor-base@1.0.4
 minifier-css@1.2.14
-- 
2.7.4 (Apple Git-66)


From af2732db1295611c873960ad59ab561a6b8c320a Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:59:30 +0300
Subject: [PATCH 182/267] Step 20.2: Create Images and Thumbs collections

---
 both/collections/images.collection.ts | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)
 create mode 100644 both/collections/images.collection.ts

diff --git a/both/collections/images.collection.ts b/both/collections/images.collection.ts
new file mode 100644
index 0000000..b4b56a7
--- /dev/null
+++ b/both/collections/images.collection.ts
@@ -0,0 +1,21 @@
+import { MongoObservable } from 'meteor-rxjs';
+import { Meteor } from 'meteor/meteor';
+
+export const Images = new MongoObservable.Collection('images');
+export const Thumbs = new MongoObservable.Collection('thumbs');
+
+function loggedIn(userId) {
+  return !!userId;
+}
+
+Thumbs.collection.allow({
+  insert: loggedIn,
+  update: loggedIn,
+  remove: loggedIn
+});
+
+Images.collection.allow({
+  insert: loggedIn,
+  update: loggedIn,
+  remove: loggedIn
+});
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From f6670caa720990f86346e57f90ed6443f855ba63 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 13:59:58 +0300
Subject: [PATCH 183/267] Step 20.3: Define Image interface

---
 both/models/image.model.ts | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 both/models/image.model.ts

diff --git a/both/models/image.model.ts b/both/models/image.model.ts
new file mode 100644
index 0000000..c4918e1
--- /dev/null
+++ b/both/models/image.model.ts
@@ -0,0 +1,15 @@
+export interface Image {
+  _id?: string;
+  complete: boolean;
+  extension: string;
+  name: string;
+  progress: number;
+  size: number;
+  store: string;
+  token: string;
+  type: string;
+  uploadedAt: Date;
+  uploading: boolean;
+  url: string;
+  userId?: string;
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 2fe06b47dcb77ac846230259de9408c2724c1cdb Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:00:20 +0300
Subject: [PATCH 184/267] Step 20.4: Define Thumbs interface

---
 both/models/image.model.ts | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/both/models/image.model.ts b/both/models/image.model.ts
index c4918e1..9464d8a 100644
--- a/both/models/image.model.ts
+++ b/both/models/image.model.ts
@@ -12,4 +12,9 @@ export interface Image {
   uploading: boolean;
   url: string;
   userId?: string;
+}
+
+export interface Thumb extends Image  {
+  originalStore?: string;
+  originalId?: string;
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 06d22ea59f15d5e00c92c8767535869bfda3ae4b Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:00:46 +0300
Subject: [PATCH 185/267] Step 20.5: Add interfaces to Mongo Collections

---
 both/collections/images.collection.ts | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/both/collections/images.collection.ts b/both/collections/images.collection.ts
index b4b56a7..29844fd 100644
--- a/both/collections/images.collection.ts
+++ b/both/collections/images.collection.ts
@@ -1,8 +1,9 @@
 import { MongoObservable } from 'meteor-rxjs';
 import { Meteor } from 'meteor/meteor';
+import {Thumb, Image} from "../models/image.model";
 
-export const Images = new MongoObservable.Collection('images');
-export const Thumbs = new MongoObservable.Collection('thumbs');
+export const Images = new MongoObservable.Collection<Image>('images');
+export const Thumbs = new MongoObservable.Collection<Thumb>('thumbs');
 
 function loggedIn(userId) {
   return !!userId;
-- 
2.7.4 (Apple Git-66)


From d742441e7944be610c86b859f13404a0aa4c2808 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:01:42 +0300
Subject: [PATCH 186/267] Step 20.6: Create stores for Images and Thumbs

---
 both/collections/images.collection.ts | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/both/collections/images.collection.ts b/both/collections/images.collection.ts
index 29844fd..d40cdee 100644
--- a/both/collections/images.collection.ts
+++ b/both/collections/images.collection.ts
@@ -1,10 +1,27 @@
 import { MongoObservable } from 'meteor-rxjs';
 import { Meteor } from 'meteor/meteor';
 import {Thumb, Image} from "../models/image.model";
+import { UploadFS } from 'meteor/jalik:ufs';
 
 export const Images = new MongoObservable.Collection<Image>('images');
 export const Thumbs = new MongoObservable.Collection<Thumb>('thumbs');
 
+export const ThumbsStore = new UploadFS.store.GridFS({
+  collection: Thumbs.collection,
+  name: 'thumbs'
+});
+
+export const ImagesStore = new UploadFS.store.GridFS({
+  collection: Images.collection,
+  name: 'images',
+  filter: new UploadFS.Filter({
+    contentTypes: ['image/*']
+  }),
+  copyTo: [
+    ThumbsStore
+  ]
+});
+
 function loggedIn(userId) {
   return !!userId;
 }
-- 
2.7.4 (Apple Git-66)


From 1b7107bcf1d53ef2b2b4fa8efe528c035319a6b2 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:02:18 +0300
Subject: [PATCH 187/267] Step 20.7: Resize images

---
 both/collections/images.collection.ts | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/both/collections/images.collection.ts b/both/collections/images.collection.ts
index d40cdee..259aa85 100644
--- a/both/collections/images.collection.ts
+++ b/both/collections/images.collection.ts
@@ -8,7 +8,19 @@ export const Thumbs = new MongoObservable.Collection<Thumb>('thumbs');
 
 export const ThumbsStore = new UploadFS.store.GridFS({
   collection: Thumbs.collection,
-  name: 'thumbs'
+  name: 'thumbs',
+  transformWrite(from, to, fileId, file) {
+    // Resize to 32x32
+    const gm = require('gm');
+
+    gm(from, file.name)
+      .resize(32, 32)
+      .gravity('Center')
+      .extent(32, 32)
+      .quality(75)
+      .stream()
+      .pipe(to);
+  }
 });
 
 export const ImagesStore = new UploadFS.store.GridFS({
-- 
2.7.4 (Apple Git-66)


From 41aa95badcd501f505ae802df93088a31708a106 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:02:54 +0300
Subject: [PATCH 188/267] Step 20.8: Install gm

---
 package.json | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/package.json b/package.json
index 5bcfc5b..7f7303d 100644
--- a/package.json
+++ b/package.json
@@ -36,11 +36,13 @@
     "angular2-meteor-accounts-ui": "0.8.0",
     "angular2-meteor-polyfills": "^0.1.1",
     "angular2-meteor-tests-polyfills": "0.0.2",
+    "gm": "^1.23.0",
     "meteor-node-stubs": "0.2.3",
     "meteor-rxjs": "0.2.3",
     "ng2-pagination": "0.4.1",
     "reflect-metadata": "^0.1.8",
     "rxjs": "5.0.0-beta.12",
+    "spawn-sync": "^1.0.15",
     "zone.js": "^0.6.21"
   }
 }
-- 
2.7.4 (Apple Git-66)


From 95e1a99203e84d18f9468711b85486b614c23f52 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:24:07 +0300
Subject: [PATCH 189/267] Step 20.9: Install angular2-file-drop

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 7f7303d..b4194fc 100644
--- a/package.json
+++ b/package.json
@@ -31,6 +31,7 @@
     "@angular2-material/input": "2.0.0-alpha.8-2",
     "@angular2-material/list": "2.0.0-alpha.8-2",
     "@angular2-material/toolbar": "2.0.0-alpha.8-2",
+    "angular2-file-drop": "github:dotansimha/angular2-file-drop#a3569f1abdb6c61739d93456758479901bc41557",
     "angular2-google-maps": "0.15.0",
     "angular2-meteor": "0.7.0",
     "angular2-meteor-accounts-ui": "0.8.0",
-- 
2.7.4 (Apple Git-66)


From 440299417b80b70d07b93ed3c9f60c736b1feea2 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:24:19 +0300
Subject: [PATCH 190/267] Step 20.10: Include file drop module

---
 client/imports/app/app.module.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 32d4df7..7faa03b 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -18,6 +18,7 @@ import { MdCoreModule } from "@angular2-material/core";
 import { MdCheckboxModule } from "@angular2-material/checkbox";
 import {MdListModule} from "@angular2-material/list";
 import {AUTH_DECLARATIONS} from "./auth/index";
+import {FileDropModule} from "angular2-file-drop";
 
 @NgModule({
   imports: [
@@ -36,7 +37,8 @@ import {AUTH_DECLARATIONS} from "./auth/index";
     MdInputModule.forRoot(),
     MdCardModule.forRoot(),
     MdCheckboxModule.forRoot(),
-    MdListModule.forRoot()
+    MdListModule.forRoot(),
+    FileDropModule
   ],
   declarations: [
     AppComponent,
-- 
2.7.4 (Apple Git-66)


From a594fb14a3f19bb6fcee82793d3f1d3bd431bb26 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:25:01 +0300
Subject: [PATCH 191/267] Step 20.11: Create a view for an upload

---
 client/imports/app/parties/parties-upload.component.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 client/imports/app/parties/parties-upload.component.html

diff --git a/client/imports/app/parties/parties-upload.component.html b/client/imports/app/parties/parties-upload.component.html
new file mode 100644
index 0000000..936b188
--- /dev/null
+++ b/client/imports/app/parties/parties-upload.component.html
@@ -0,0 +1,5 @@
+<div layout="column">
+  <div>
+    <div>Drop an image to here</div>
+  </div>
+</div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 96ccff3ec44263180c75f7acea6259bb751b7adf Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:25:46 +0300
Subject: [PATCH 192/267] Step 20.12: Create a PartiesUpload component

---
 client/imports/app/parties/parties-upload.component.ts | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 client/imports/app/parties/parties-upload.component.ts

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
new file mode 100644
index 0000000..36a61be
--- /dev/null
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -0,0 +1,11 @@
+import { Component } from '@angular/core';
+
+import template from './parties-upload.component.html';
+
+@Component({
+  selector: 'parties-upload',
+  template
+})
+export class PartiesUploadComponent {
+  constructor() {}
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 5234f01ca38f70d6e619fd853932dd918ff42efd Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:25:59 +0300
Subject: [PATCH 193/267] Step 20.13: Added  PartiesUpload component to the
 index file

---
 client/imports/app/parties/index.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/index.ts b/client/imports/app/parties/index.ts
index ae09066..7a1b315 100644
--- a/client/imports/app/parties/index.ts
+++ b/client/imports/app/parties/index.ts
@@ -1,9 +1,11 @@
 import { PartiesFormComponent } from './parties-form.component';
 import { PartiesListComponent } from './parties-list.component';
 import { PartyDetailsComponent } from './party-details.component';
+import {PartiesUploadComponent} from "./parties-upload.component";
 
 export const PARTIES_DECLARATIONS = [
   PartiesFormComponent,
   PartiesListComponent,
-  PartyDetailsComponent
+  PartyDetailsComponent,
+  PartiesUploadComponent
 ];
-- 
2.7.4 (Apple Git-66)


From 03abab0f2b2f604970e4ae369cbbf43709d55f7c Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:26:53 +0300
Subject: [PATCH 194/267] Step 20.14: Use PartiesUploadComponent inside the
 form

---
 client/imports/app/parties/parties-form.component.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/imports/app/parties/parties-form.component.html b/client/imports/app/parties/parties-form.component.html
index 0318fa5..82e2f51 100644
--- a/client/imports/app/parties/parties-form.component.html
+++ b/client/imports/app/parties/parties-form.component.html
@@ -8,6 +8,8 @@
       <md-checkbox formControlName="public">Public</md-checkbox>
     </div>
 
+    <parties-upload></parties-upload>
+
     <button md-raised-button type="submit">Add</button>
   </fieldset>
 </form>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From bbbe9251309c92093e5ee5736ff4bc459204d86c Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:27:41 +0300
Subject: [PATCH 195/267] Step 20.15: Add bindings to FileDrop

---
 client/imports/app/parties/parties-upload.component.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-upload.component.html b/client/imports/app/parties/parties-upload.component.html
index 936b188..b71c11c 100644
--- a/client/imports/app/parties/parties-upload.component.html
+++ b/client/imports/app/parties/parties-upload.component.html
@@ -1,5 +1,8 @@
 <div layout="column">
-  <div>
+  <div fileDrop
+       [ngClass]="{'file-is-over': fileIsOver}"
+       (fileOver)="fileOver($event)"
+       (onFileDrop)="onFileDrop($event)">
     <div>Drop an image to here</div>
   </div>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 69423015babac00f58816a4acc973622a28209b3 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:28:09 +0300
Subject: [PATCH 196/267] Step 20.16: Handle fileIsOver

---
 client/imports/app/parties/parties-upload.component.ts | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
index 36a61be..48d42e0 100644
--- a/client/imports/app/parties/parties-upload.component.ts
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -7,5 +7,11 @@ import template from './parties-upload.component.html';
   template
 })
 export class PartiesUploadComponent {
+  fileIsOver: boolean = false;
+
   constructor() {}
+
+  fileOver(fileIsOver: boolean): void {
+    this.fileIsOver = fileIsOver;
+  }
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From d40661d0219f8fdc1a59be9c5f5edb4ba458a33f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:28:34 +0300
Subject: [PATCH 197/267] Step 20.17: Implement onFileDrop method

---
 client/imports/app/parties/parties-upload.component.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
index 48d42e0..1e95a62 100644
--- a/client/imports/app/parties/parties-upload.component.ts
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -14,4 +14,8 @@ export class PartiesUploadComponent {
   fileOver(fileIsOver: boolean): void {
     this.fileIsOver = fileIsOver;
   }
+
+  onFileDrop(file: File): void {
+    console.log('Got file');
+  }
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 955b3c657ad5b07d175ee634b679151fd1aa39eb Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:30:38 +0300
Subject: [PATCH 198/267] Step 20.18: Implement the upload method

---
 both/methods/images.methods.ts | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 both/methods/images.methods.ts

diff --git a/both/methods/images.methods.ts b/both/methods/images.methods.ts
new file mode 100644
index 0000000..8bfb27e
--- /dev/null
+++ b/both/methods/images.methods.ts
@@ -0,0 +1,23 @@
+import { UploadFS } from 'meteor/jalik:ufs';
+import { ImagesStore } from '../collections/images.collection';
+
+export function upload(data: File): Promise<any> {
+  return new Promise((resolve, reject) => {
+    // pick from an object only: name, type and size
+    const file = {
+      name: data.name,
+      type: data.type,
+      size: data.size,
+    };
+
+    const upload = new UploadFS.Uploader({
+      data,
+      file,
+      store: ImagesStore,
+      onError: reject,
+      onComplete: resolve
+    });
+
+    upload.start();
+  });
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 0ba75b55d9e8ff2e9b0a18a5d794d201c48bb32c Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:31:37 +0300
Subject: [PATCH 199/267] Step 20.19: Use the upload function

---
 client/imports/app/parties/parties-upload.component.ts | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
index 1e95a62..8e6180b 100644
--- a/client/imports/app/parties/parties-upload.component.ts
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -2,12 +2,15 @@ import { Component } from '@angular/core';
 
 import template from './parties-upload.component.html';
 
+import { upload } from '../../../../both/methods/images.methods';
+
 @Component({
   selector: 'parties-upload',
   template
 })
 export class PartiesUploadComponent {
   fileIsOver: boolean = false;
+  uploading: boolean = false;
 
   constructor() {}
 
@@ -16,6 +19,15 @@ export class PartiesUploadComponent {
   }
 
   onFileDrop(file: File): void {
-    console.log('Got file');
+    this.uploading = true;
+
+    upload(file)
+      .then(() => {
+        this.uploading = false;
+      })
+      .catch((error) => {
+        this.uploading = false;
+        console.log(`Something went wrong!`, error);
+      });
   }
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From fef229e3bade5c74e229b6526a51b748fab9d1a7 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:32:31 +0300
Subject: [PATCH 200/267] Step 20.20: Declare meteor/jalik:ufs module

---
 typings/jalik-ufs.d.ts | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 typings/jalik-ufs.d.ts

diff --git a/typings/jalik-ufs.d.ts b/typings/jalik-ufs.d.ts
new file mode 100644
index 0000000..f2d4383
--- /dev/null
+++ b/typings/jalik-ufs.d.ts
@@ -0,0 +1,11 @@
+declare module "meteor/jalik:ufs" {
+  interface Uploader {
+    start: () => void;
+  }
+
+  interface UploadFS {
+    Uploader: (options: any) => Uploader;
+  }
+
+  export var UploadFS;
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From d18df2efc9fa93add748698bf7001890f225d8d6 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:33:39 +0300
Subject: [PATCH 201/267] Step 20.21: Install definitions of NodeJS

---
 typings.json | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/typings.json b/typings.json
index 4a62321..d57f625 100644
--- a/typings.json
+++ b/typings.json
@@ -5,6 +5,7 @@
     "chai-spies": "registry:npm/chai-spies#0.7.1+20160614064916"
   },
   "globalDependencies": {
-    "meteor": "github:meteor-typings/meteor/1.3#955b89a4e2af892d1736bc570b490a97e860d5b7"
+    "meteor": "github:meteor-typings/meteor/1.3#955b89a4e2af892d1736bc570b490a97e860d5b7",
+    "node": "registry:dt/node#6.0.0+20160925070332"
   }
 }
-- 
2.7.4 (Apple Git-66)


From ce1483674318e06a2782d05b9447ecc19ab8db96 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:34:11 +0300
Subject: [PATCH 202/267] Step 20.22: Implement classes

---
 client/imports/app/parties/parties-upload.component.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-upload.component.html b/client/imports/app/parties/parties-upload.component.html
index b71c11c..1dad975 100644
--- a/client/imports/app/parties/parties-upload.component.html
+++ b/client/imports/app/parties/parties-upload.component.html
@@ -1,6 +1,6 @@
 <div layout="column">
   <div fileDrop
-       [ngClass]="{'file-is-over': fileIsOver}"
+       [ngClass]="{'file-is-over': fileIsOver, 'file-uploading': uploading}"
        (fileOver)="fileOver($event)"
        (onFileDrop)="onFileDrop($event)">
     <div>Drop an image to here</div>
-- 
2.7.4 (Apple Git-66)


From 70fbe115df71ad27a35a7a3ef6783957250d419d Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:34:51 +0300
Subject: [PATCH 203/267] Step 20.23: Implement publications of Images and
 Thumbs

---
 server/imports/publications/images.ts | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 server/imports/publications/images.ts

diff --git a/server/imports/publications/images.ts b/server/imports/publications/images.ts
new file mode 100644
index 0000000..1367a0c
--- /dev/null
+++ b/server/imports/publications/images.ts
@@ -0,0 +1,15 @@
+import { Meteor } from 'meteor/meteor';
+import { Thumbs, Images } from '../../../both/collections/images.collection';
+
+Meteor.publish('thumbs', function(ids: string[]) {
+  return Thumbs.collection.find({
+    originalStore: 'images',
+    originalId: {
+      $in: ids
+    }
+  });
+});
+
+Meteor.publish('images', function() {
+  return Images.collection.find({});
+});
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 46cd137b3c21732b370d436388213b8be6a69715 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:35:15 +0300
Subject: [PATCH 204/267] Step 20.24: Import those publications in the server
 entry point

---
 server/main.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/main.ts b/server/main.ts
index 7979c05..92ff846 100644
--- a/server/main.ts
+++ b/server/main.ts
@@ -5,6 +5,7 @@ import { loadParties } from './imports/fixtures/parties';
 import './imports/publications/parties';
 import './imports/publications/users';
 import '../both/methods/parties.methods';
+import './imports/publications/images';
 
 Meteor.startup(() => {
   loadParties();
-- 
2.7.4 (Apple Git-66)


From 6f8024de8f71096f79fae0c1acfa2583ff5332dc Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:41:14 +0300
Subject: [PATCH 205/267] Step 20.25: Use RxJS to keep track of files

---
 client/imports/app/parties/parties-upload.component.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
index 8e6180b..f51ae47 100644
--- a/client/imports/app/parties/parties-upload.component.ts
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -1,9 +1,11 @@
-import { Component } from '@angular/core';
+import {Component} from '@angular/core';
 
 import template from './parties-upload.component.html';
 
 import { upload } from '../../../../both/methods/images.methods';
 
+import {Subject, Subscription} from "rxjs";
+
 @Component({
   selector: 'parties-upload',
   template
@@ -11,6 +13,7 @@ import { upload } from '../../../../both/methods/images.methods';
 export class PartiesUploadComponent {
   fileIsOver: boolean = false;
   uploading: boolean = false;
+  files: Subject<string[]> = new Subject<string[]>();
 
   constructor() {}
 
-- 
2.7.4 (Apple Git-66)


From 0a41a23082d775598c4c86fbd9b4a7528ce95ee1 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:41:55 +0300
Subject: [PATCH 206/267] Step 20.26: Subscribe to the thumbs publication

---
 .../imports/app/parties/parties-upload.component.ts  | 20 +++++++++++++++++---
 1 file changed, 17 insertions(+), 3 deletions(-)

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
index f51ae47..073c29c 100644
--- a/client/imports/app/parties/parties-upload.component.ts
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -1,22 +1,36 @@
-import {Component} from '@angular/core';
+import {Component, OnInit} from '@angular/core';
 
 import template from './parties-upload.component.html';
 
 import { upload } from '../../../../both/methods/images.methods';
-
 import {Subject, Subscription} from "rxjs";
+import {MeteorObservable} from "meteor-rxjs";
 
 @Component({
   selector: 'parties-upload',
   template
 })
-export class PartiesUploadComponent {
+export class PartiesUploadComponent implements OnInit {
   fileIsOver: boolean = false;
   uploading: boolean = false;
   files: Subject<string[]> = new Subject<string[]>();
+  thumbsSubscription: Subscription;
 
   constructor() {}
 
+  ngOnInit() {
+    this.files.subscribe((filesArray) => {
+      MeteorObservable.autorun().zone().subscribe(() => {
+        if (this.thumbsSubscription) {
+          this.thumbsSubscription.unsubscribe();
+          this.thumbsSubscription = undefined;
+        }
+
+        this.thumbsSubscription = MeteorObservable.subscribe("thumbs", filesArray).zone().subscribe();
+      });
+    });
+  }
+
   fileOver(fileIsOver: boolean): void {
     this.fileIsOver = fileIsOver;
   }
-- 
2.7.4 (Apple Git-66)


From c330d1d4429cb587f8668e21943c6d8a1e794331 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:45:34 +0300
Subject: [PATCH 207/267] Step 20.27: Look for the thumbnails

---
 client/imports/app/parties/parties-upload.component.ts | 16 +++++++++++++---
 1 file changed, 13 insertions(+), 3 deletions(-)

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
index 073c29c..5aa03b9 100644
--- a/client/imports/app/parties/parties-upload.component.ts
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -3,8 +3,10 @@ import {Component, OnInit} from '@angular/core';
 import template from './parties-upload.component.html';
 
 import { upload } from '../../../../both/methods/images.methods';
-import {Subject, Subscription} from "rxjs";
-import {MeteorObservable} from "meteor-rxjs";
+import {Subject, Subscription, Observable} from "rxjs";
+import {MeteorObservable, ObservableCursor} from "meteor-rxjs";
+import {Thumb} from "../../../../both/models/image.model";
+import {Thumbs} from "../../../../both/collections/images.collection";
 
 @Component({
   selector: 'parties-upload',
@@ -15,6 +17,7 @@ export class PartiesUploadComponent implements OnInit {
   uploading: boolean = false;
   files: Subject<string[]> = new Subject<string[]>();
   thumbsSubscription: Subscription;
+  thumbs: ObservableCursor<Thumb>;
 
   constructor() {}
 
@@ -26,7 +29,14 @@ export class PartiesUploadComponent implements OnInit {
           this.thumbsSubscription = undefined;
         }
 
-        this.thumbsSubscription = MeteorObservable.subscribe("thumbs", filesArray).zone().subscribe();
+        this.thumbsSubscription = MeteorObservable.subscribe("thumbs", filesArray).zone().subscribe(() => {
+          this.thumbs = Thumbs.find({
+            originalStore: 'images',
+            originalId: {
+              $in: filesArray
+            }
+          });
+        });
       });
     });
   }
-- 
2.7.4 (Apple Git-66)


From 99c2c28995f2ad8caa17b3806928ff20dac4219d Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:46:04 +0300
Subject: [PATCH 208/267] Step 20.28: Implement the thumbnails in the view

---
 client/imports/app/parties/parties-upload.component.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/imports/app/parties/parties-upload.component.html b/client/imports/app/parties/parties-upload.component.html
index 1dad975..d2d7f22 100644
--- a/client/imports/app/parties/parties-upload.component.html
+++ b/client/imports/app/parties/parties-upload.component.html
@@ -5,4 +5,10 @@
        (onFileDrop)="onFileDrop($event)">
     <div>Drop an image to here</div>
   </div>
+
+  <div layout="row" *ngIf="thumbs">
+    <div *ngFor="let thumb of thumbs | async">
+      <img [src]="thumb.url"/>
+    </div>
+  </div>
 </div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From c7a66e8f6a61a05412bae75cf377880848ca4cc0 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:46:34 +0300
Subject: [PATCH 209/267] Step 20.29: Basic styles

---
 client/imports/app/parties/parties-upload.component.scss | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
 create mode 100644 client/imports/app/parties/parties-upload.component.scss

diff --git a/client/imports/app/parties/parties-upload.component.scss b/client/imports/app/parties/parties-upload.component.scss
new file mode 100644
index 0000000..1f53d72
--- /dev/null
+++ b/client/imports/app/parties/parties-upload.component.scss
@@ -0,0 +1,16 @@
+.file-uploading {
+  opacity: 0.3;
+}
+
+.file-is-over {
+  opacity: 0.7;
+}
+
+[filedrop] {
+  width: 100%;
+  height: 100px;
+  line-height: 100px;
+  text-align: center;
+  background-color: #f1f1f1;
+  margin: 10px 0;
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From c081239f3c33742fdb0a8ff058d734c0fa665100 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:46:59 +0300
Subject: [PATCH 210/267] Step 20.30: Import styles inside main.scss

---
 client/main.scss | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/main.scss b/client/main.scss
index d86c9f5..40113ec 100644
--- a/client/main.scss
+++ b/client/main.scss
@@ -44,4 +44,5 @@ body {
 }
 
 @import "./imports/app/parties/parties-list.component";
-@import "./imports/app/parties/party-details.component";
\ No newline at end of file
+@import "./imports/app/parties/party-details.component";
+@import "./imports/app/parties/parties-upload.component";
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From ed6e19287b31249456e0ed27dd4fb264b614fc13 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 14:49:01 +0300
Subject: [PATCH 211/267] Step 20.31: Handle file upload

---
 client/imports/app/parties/parties-upload.component.ts | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
index 5aa03b9..cfdecd0 100644
--- a/client/imports/app/parties/parties-upload.component.ts
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -15,6 +15,7 @@ import {Thumbs} from "../../../../both/collections/images.collection";
 export class PartiesUploadComponent implements OnInit {
   fileIsOver: boolean = false;
   uploading: boolean = false;
+  filesArray: string[] = [];
   files: Subject<string[]> = new Subject<string[]>();
   thumbsSubscription: Subscription;
   thumbs: ObservableCursor<Thumb>;
@@ -49,12 +50,18 @@ export class PartiesUploadComponent implements OnInit {
     this.uploading = true;
 
     upload(file)
-      .then(() => {
+      .then((result) => {
         this.uploading = false;
+        this.addFile(result);
       })
       .catch((error) => {
         this.uploading = false;
         console.log(`Something went wrong!`, error);
       });
   }
+
+  addFile(file) {
+    this.filesArray.push(file._id);
+    this.files.next(this.filesArray);
+  }
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 749f8176e45a888240317eb062553347e5edf876 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:10:26 +0300
Subject: [PATCH 212/267] Step 20.32: Emit event with the new file

---
 client/imports/app/parties/parties-upload.component.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
index cfdecd0..6765dc6 100644
--- a/client/imports/app/parties/parties-upload.component.ts
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -1,4 +1,4 @@
-import {Component, OnInit} from '@angular/core';
+import {Component, OnInit, EventEmitter, Output} from '@angular/core';
 
 import template from './parties-upload.component.html';
 
@@ -19,6 +19,7 @@ export class PartiesUploadComponent implements OnInit {
   files: Subject<string[]> = new Subject<string[]>();
   thumbsSubscription: Subscription;
   thumbs: ObservableCursor<Thumb>;
+  @Output() onFile: EventEmitter<string> = new EventEmitter<string>();
 
   constructor() {}
 
@@ -63,5 +64,6 @@ export class PartiesUploadComponent implements OnInit {
   addFile(file) {
     this.filesArray.push(file._id);
     this.files.next(this.filesArray);
+    this.onFile.emit(file._id);
   }
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From af28b7d33e83e9202152185813584dae0f667129 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:11:01 +0300
Subject: [PATCH 213/267] Step 20.33: Add images to the PartiesForm component

---
 client/imports/app/parties/parties-form.component.ts | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/imports/app/parties/parties-form.component.ts b/client/imports/app/parties/parties-form.component.ts
index 3a213f0..ccd2ed1 100644
--- a/client/imports/app/parties/parties-form.component.ts
+++ b/client/imports/app/parties/parties-form.component.ts
@@ -12,6 +12,7 @@ import template from './parties-form.component.html';
 })
 export class PartiesFormComponent implements OnInit {
   addForm: FormGroup;
+  images: string[] = [];
 
   constructor(
     private formBuilder: FormBuilder
@@ -39,6 +40,7 @@ export class PartiesFormComponent implements OnInit {
         location: {
           name: this.addForm.value.location
         },
+        images: this.images,
         public: this.addForm.value.public,
         owner: Meteor.userId()
       });
@@ -46,4 +48,8 @@ export class PartiesFormComponent implements OnInit {
       this.addForm.reset();
     }
   }
+
+  onImage(imageId: string) {
+    this.images.push(imageId);
+  }
 }
-- 
2.7.4 (Apple Git-66)


From 4eb40b31ae885e651ba68cd333e9b54b2dea6d26 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:11:29 +0300
Subject: [PATCH 214/267] Step 20.34: Add images property to the Party
 interface

---
 both/models/party.model.ts | 1 +
 1 file changed, 1 insertion(+)

diff --git a/both/models/party.model.ts b/both/models/party.model.ts
index 5e62f1b..eb4b3e4 100644
--- a/both/models/party.model.ts
+++ b/both/models/party.model.ts
@@ -8,6 +8,7 @@ export interface Party extends CollectionObject {
   public: boolean;
   invited?: string[];
   rsvps?: RSVP[];
+  images?: string[];
 }
 
 interface RSVP {
-- 
2.7.4 (Apple Git-66)


From 4f1a479c50e9d976d2a71f4333bfb690bcace34e Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:11:51 +0300
Subject: [PATCH 215/267] Step 20.35: Bind the onFile event

---
 client/imports/app/parties/parties-form.component.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/parties/parties-form.component.html b/client/imports/app/parties/parties-form.component.html
index 82e2f51..a4f1fc4 100644
--- a/client/imports/app/parties/parties-form.component.html
+++ b/client/imports/app/parties/parties-form.component.html
@@ -8,7 +8,7 @@
       <md-checkbox formControlName="public">Public</md-checkbox>
     </div>
 
-    <parties-upload></parties-upload>
+    <parties-upload (onFile)="onImage($event)"></parties-upload>
 
     <button md-raised-button type="submit">Add</button>
   </fieldset>
-- 
2.7.4 (Apple Git-66)


From d9a9c76b03d1ab8677a5a847a782d8bb91762a72 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:14:00 +0300
Subject: [PATCH 216/267] Step 20.36: Create DisplayMainImage pipe

---
 .../imports/app/shared/display-main-image.pipe.ts  | 25 ++++++++++++++++++++++
 1 file changed, 25 insertions(+)
 create mode 100644 client/imports/app/shared/display-main-image.pipe.ts

diff --git a/client/imports/app/shared/display-main-image.pipe.ts b/client/imports/app/shared/display-main-image.pipe.ts
new file mode 100644
index 0000000..c98e952
--- /dev/null
+++ b/client/imports/app/shared/display-main-image.pipe.ts
@@ -0,0 +1,25 @@
+import {Pipe, PipeTransform} from '@angular/core';
+import { Images } from '../../../../both/collections/images.collection';
+import { Party } from '../../../../both/models/party.model';
+
+@Pipe({
+  name: 'displayMainImage'
+})
+export class DisplayMainImagePipe implements PipeTransform {
+  transform(party: Party) {
+    if (!party) {
+      return;
+    }
+
+    let imageUrl: string;
+    let imageId: string = (party.images || [])[0];
+
+    const found = Images.findOne(imageId);
+
+    if (found) {
+      imageUrl = found.url;
+    }
+
+    return imageUrl;
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From cf34eee0c016f1778270f324b1c01adc25449ec4 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:14:26 +0300
Subject: [PATCH 217/267] Step 20.37: Add DisplayMainImage pipe

---
 client/imports/app/shared/index.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/shared/index.ts b/client/imports/app/shared/index.ts
index 12c7d64..37c6cf1 100644
--- a/client/imports/app/shared/index.ts
+++ b/client/imports/app/shared/index.ts
@@ -1,7 +1,9 @@
 import { DisplayNamePipe } from './display-name.pipe';
 import {RsvpPipe} from "./rsvp.pipe";
+import {DisplayMainImagePipe} from "./display-main-image.pipe";
 
 export const SHARED_DECLARATIONS: any[] = [
   DisplayNamePipe,
-  RsvpPipe
+  RsvpPipe,
+  DisplayMainImagePipe
 ];
-- 
2.7.4 (Apple Git-66)


From be02c9c63d9eedcb15bc3007198d7384a421d81b Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:15:56 +0300
Subject: [PATCH 218/267] Step 20.38: Subscribe to the images publication

---
 client/imports/app/parties/parties-list.component.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index 1b93c26..f392a12 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -39,6 +39,7 @@ export class PartiesListComponent implements OnInit, OnDestroy {
   autorunSub: Subscription;
   location: Subject<string> = new Subject<string>();
   user: Meteor.User;
+  imagesSubs: Subscription;
 
   constructor(
     private paginationService: PaginationService
@@ -88,6 +89,8 @@ export class PartiesListComponent implements OnInit, OnDestroy {
       this.partiesSize = Counts.get('numberOfParties');
       this.paginationService.setTotalItems(this.paginationService.defaultId, this.partiesSize);
     });
+
+    this.imagesSubs = MeteorObservable.subscribe('images').zone().subscribe();
   }
 
   removeParty(party: Party): void {
@@ -115,5 +118,6 @@ export class PartiesListComponent implements OnInit, OnDestroy {
     this.partiesSub.unsubscribe();
     this.optionsSub.unsubscribe();
     this.autorunSub.unsubscribe();
+    this.imagesSubs.unsubscribe();
   }
 }
-- 
2.7.4 (Apple Git-66)


From 07d0fa172807ea22cfb450cb167f88634a1dd920 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:16:31 +0300
Subject: [PATCH 219/267] Step 20.39: Implement the pipe

---
 client/imports/app/parties/parties-list.component.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/imports/app/parties/parties-list.component.html b/client/imports/app/parties/parties-list.component.html
index 8ca6bf0..b742f88 100644
--- a/client/imports/app/parties/parties-list.component.html
+++ b/client/imports/app/parties/parties-list.component.html
@@ -27,6 +27,7 @@
           <div *ngFor="let party of parties | async">
             <md-card>
               <md-card-content>
+                <img *ngIf="party.images" class="party-main-image" [src]="party | displayMainImage">
                 <h2 class="md-title ma-name">
                   <a [routerLink]="['/party', party._id]">{{party.name}}</a>
                 </h2>
-- 
2.7.4 (Apple Git-66)


From 5e72b04b3a041899a333a7bad0e11930148990c8 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:16:52 +0300
Subject: [PATCH 220/267] Step 20.40: Add some styles

---
 client/imports/app/parties/parties-list.component.scss | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/imports/app/parties/parties-list.component.scss b/client/imports/app/parties/parties-list.component.scss
index 60f77b1..788e78d 100644
--- a/client/imports/app/parties/parties-list.component.scss
+++ b/client/imports/app/parties/parties-list.component.scss
@@ -58,4 +58,9 @@
 
 .search-form {
   margin-bottom: 1em;
+}
+
+img.party-main-image {
+  max-width: 100%;
+  max-height: 100%;
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From a4efeba014e4c1c9d8cf38cdef1e5c9d9e3d590e Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:17:53 +0300
Subject: [PATCH 221/267] Step 20.41: Add the reset method to PartiesUpload
 component

---
 client/imports/app/parties/parties-upload.component.ts | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/imports/app/parties/parties-upload.component.ts b/client/imports/app/parties/parties-upload.component.ts
index 6765dc6..3203cd7 100644
--- a/client/imports/app/parties/parties-upload.component.ts
+++ b/client/imports/app/parties/parties-upload.component.ts
@@ -66,4 +66,9 @@ export class PartiesUploadComponent implements OnInit {
     this.files.next(this.filesArray);
     this.onFile.emit(file._id);
   }
+
+  reset() {
+    this.filesArray = [];
+    this.files.next(this.filesArray);
+  }
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 97a5bd7d0322ffef37090036aba32408f49ae719 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:18:33 +0300
Subject: [PATCH 222/267] Step 20.42: Reset files on ngSubmit

---
 client/imports/app/parties/parties-form.component.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/imports/app/parties/parties-form.component.html b/client/imports/app/parties/parties-form.component.html
index a4f1fc4..a5caa3f 100644
--- a/client/imports/app/parties/parties-form.component.html
+++ b/client/imports/app/parties/parties-form.component.html
@@ -1,4 +1,4 @@
-<form [formGroup]="addForm" (ngSubmit)="addParty()">
+<form [formGroup]="addForm" (ngSubmit)="addParty(); upload.reset()">
   <fieldset class="form-group">
     <md-input formControlName="name" placeholder="Party name"></md-input>
     <md-input formControlName="description" placeholder="Description"></md-input>
@@ -8,7 +8,7 @@
       <md-checkbox formControlName="public">Public</md-checkbox>
     </div>
 
-    <parties-upload (onFile)="onImage($event)"></parties-upload>
+    <parties-upload #upload (onFile)="onImage($event)"></parties-upload>
 
     <button md-raised-button type="submit">Add</button>
   </fieldset>
-- 
2.7.4 (Apple Git-66)


From 9c0f8554674bfe50c80a444ef2910e840c427781 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:34:29 +0300
Subject: [PATCH 223/267] Step 21.1: Add mobile platform

---
 .meteor/platforms | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/.meteor/platforms b/.meteor/platforms
index efeba1b..2d49a85 100644
--- a/.meteor/platforms
+++ b/.meteor/platforms
@@ -1,2 +1,4 @@
-server
+android
 browser
+ios
+server
-- 
2.7.4 (Apple Git-66)


From cb7e8200ffdc6ce43421fbf02e15b45768b36fe6 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 11:26:49 +0300
Subject: [PATCH 224/267] Step 21.2: Wrapped Angular 2 bootstrap with Meteor
 startup

---
 client/main.ts | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/main.ts b/client/main.ts
index 45d1530..7c00907 100644
--- a/client/main.ts
+++ b/client/main.ts
@@ -6,5 +6,7 @@ import { AppModule } from './imports/app/app.module';
 
 import '../both/methods/parties.methods';
 
-const platform = platformBrowserDynamic();
-platform.bootstrapModule(AppModule);
\ No newline at end of file
+Meteor.startup(() => {
+  const platform = platformBrowserDynamic();
+  platform.bootstrapModule(AppModule);
+});
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 50fc8a70382dc2b5af75f0986febb90412cb73c1 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:34:43 +0300
Subject: [PATCH 225/267] Step 21.3: Rename to login.web.component.html

---
 client/imports/app/auth/login.component.html     | 37 ------------------------
 client/imports/app/auth/login.component.web.html | 37 ++++++++++++++++++++++++
 2 files changed, 37 insertions(+), 37 deletions(-)
 delete mode 100644 client/imports/app/auth/login.component.html
 create mode 100644 client/imports/app/auth/login.component.web.html

diff --git a/client/imports/app/auth/login.component.html b/client/imports/app/auth/login.component.html
deleted file mode 100644
index 04fe11c..0000000
--- a/client/imports/app/auth/login.component.html
+++ /dev/null
@@ -1,37 +0,0 @@
-<div class="md-content" layout="row" layout-align="center start" layout-fill layout-margin>
-  <div layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
-    <md-toolbar class="md-primary" color="primary">
-      Sign in
-    </md-toolbar>
-
-    <div layout="column" layout-fill layout-margin layout-padding>
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2"> Sign in with your email</p>
-      </div>
-
-      <form [formGroup]="loginForm" #f="ngForm" (ngSubmit)="login()"
-            layout="column" layout-fill layout-padding layout-margin>
-
-        <md-input formControlName="email" type="email" placeholder="Email"></md-input>
-        <md-input formControlName="password" type="password" placeholder="Password"></md-input>
-
-        <div layout="row" layout-align="space-between center">
-          <a md-button [routerLink]="['/recover']">Forgot password?</a>
-          <button md-raised-button class="md-primary" type="submit" aria-label="login">Sign In</button>
-        </div>
-      </form>
-
-      <div [hidden]="error == ''">
-        <md-toolbar class="md-warn" layout="row" layout-fill layout-padding layout-margin>
-          <p class="md-body-1">{{ error }}</p>
-        </md-toolbar>
-      </div>
-
-      <md-divider></md-divider>
-
-      <div layout="row" layout-align="center">
-        <a md-button [routerLink]="['/signup']">Need an account?</a>
-      </div>
-    </div>
-  </div>
-</div>
\ No newline at end of file
diff --git a/client/imports/app/auth/login.component.web.html b/client/imports/app/auth/login.component.web.html
new file mode 100644
index 0000000..04fe11c
--- /dev/null
+++ b/client/imports/app/auth/login.component.web.html
@@ -0,0 +1,37 @@
+<div class="md-content" layout="row" layout-align="center start" layout-fill layout-margin>
+  <div layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+    <md-toolbar class="md-primary" color="primary">
+      Sign in
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Sign in with your email</p>
+      </div>
+
+      <form [formGroup]="loginForm" #f="ngForm" (ngSubmit)="login()"
+            layout="column" layout-fill layout-padding layout-margin>
+
+        <md-input formControlName="email" type="email" placeholder="Email"></md-input>
+        <md-input formControlName="password" type="password" placeholder="Password"></md-input>
+
+        <div layout="row" layout-align="space-between center">
+          <a md-button [routerLink]="['/recover']">Forgot password?</a>
+          <button md-raised-button class="md-primary" type="submit" aria-label="login">Sign In</button>
+        </div>
+      </form>
+
+      <div [hidden]="error == ''">
+        <md-toolbar class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+          <p class="md-body-1">{{ error }}</p>
+        </md-toolbar>
+      </div>
+
+      <md-divider></md-divider>
+
+      <div layout="row" layout-align="center">
+        <a md-button [routerLink]="['/signup']">Need an account?</a>
+      </div>
+    </div>
+  </div>
+</div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From eaef2390130fb575b768fb498ed15272ec3ef5a5 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:34:55 +0300
Subject: [PATCH 226/267] Step 21.4: Do the same for login.component.ts

---
 client/imports/app/auth/login.component.ts     | 40 --------------------------
 client/imports/app/auth/login.component.web.ts | 40 ++++++++++++++++++++++++++
 2 files changed, 40 insertions(+), 40 deletions(-)
 delete mode 100644 client/imports/app/auth/login.component.ts
 create mode 100644 client/imports/app/auth/login.component.web.ts

diff --git a/client/imports/app/auth/login.component.ts b/client/imports/app/auth/login.component.ts
deleted file mode 100644
index ed740de..0000000
--- a/client/imports/app/auth/login.component.ts
+++ /dev/null
@@ -1,40 +0,0 @@
-import {Component, OnInit, NgZone} from '@angular/core';
-import { FormBuilder, FormGroup, Validators } from '@angular/forms';
-import { Router } from '@angular/router';
-import { Meteor } from 'meteor/meteor';
-
-import template from './login.component.html';
-
-@Component({
-  selector: 'login',
-  template
-})
-export class LoginComponent implements OnInit {
-  loginForm: FormGroup;
-  error: string;
-
-  constructor(private router: Router, private zone: NgZone, private formBuilder: FormBuilder) {}
-
-  ngOnInit() {
-    this.loginForm = this.formBuilder.group({
-      email: ['', Validators.required],
-      password: ['', Validators.required]
-    });
-
-    this.error = '';
-  }
-
-  login() {
-    if (this.loginForm.valid) {
-      Meteor.loginWithPassword(this.loginForm.value.email, this.loginForm.value.password, (err) => {
-        if (err) {
-          this.zone.run(() => {
-            this.error = err;
-          });
-        } else {
-          this.router.navigate(['/']);
-        }
-      });
-    }
-  }
-}
\ No newline at end of file
diff --git a/client/imports/app/auth/login.component.web.ts b/client/imports/app/auth/login.component.web.ts
new file mode 100644
index 0000000..ed740de
--- /dev/null
+++ b/client/imports/app/auth/login.component.web.ts
@@ -0,0 +1,40 @@
+import {Component, OnInit, NgZone} from '@angular/core';
+import { FormBuilder, FormGroup, Validators } from '@angular/forms';
+import { Router } from '@angular/router';
+import { Meteor } from 'meteor/meteor';
+
+import template from './login.component.html';
+
+@Component({
+  selector: 'login',
+  template
+})
+export class LoginComponent implements OnInit {
+  loginForm: FormGroup;
+  error: string;
+
+  constructor(private router: Router, private zone: NgZone, private formBuilder: FormBuilder) {}
+
+  ngOnInit() {
+    this.loginForm = this.formBuilder.group({
+      email: ['', Validators.required],
+      password: ['', Validators.required]
+    });
+
+    this.error = '';
+  }
+
+  login() {
+    if (this.loginForm.valid) {
+      Meteor.loginWithPassword(this.loginForm.value.email, this.loginForm.value.password, (err) => {
+        if (err) {
+          this.zone.run(() => {
+            this.error = err;
+          });
+        } else {
+          this.router.navigate(['/']);
+        }
+      });
+    }
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 47e17bb75b14043a6d0797893d8c3b492149de0d Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:35:10 +0300
Subject: [PATCH 227/267] Step 21.5: Update the template

---
 client/imports/app/auth/login.component.web.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/auth/login.component.web.ts b/client/imports/app/auth/login.component.web.ts
index ed740de..81d0e24 100644
--- a/client/imports/app/auth/login.component.web.ts
+++ b/client/imports/app/auth/login.component.web.ts
@@ -3,7 +3,7 @@ import { FormBuilder, FormGroup, Validators } from '@angular/forms';
 import { Router } from '@angular/router';
 import { Meteor } from 'meteor/meteor';
 
-import template from './login.component.html';
+import template from './login.component.web.html';
 
 @Component({
   selector: 'login',
-- 
2.7.4 (Apple Git-66)


From dfd67073280511ab43931204ee718a3c0b97971a Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:37:42 +0300
Subject: [PATCH 228/267] Step 21.6: Update the index file

---
 client/imports/app/auth/index.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/auth/index.ts b/client/imports/app/auth/index.ts
index 7e5754e..228cb9c 100644
--- a/client/imports/app/auth/index.ts
+++ b/client/imports/app/auth/index.ts
@@ -1,4 +1,4 @@
-import {LoginComponent} from "./login.component";
+import {LoginComponent} from "./login.component.web";
 import {SignupComponent} from "./singup.component";
 import {RecoverComponent} from "./recover.component";
 
-- 
2.7.4 (Apple Git-66)


From 823016429c0bca67a69a69d06ee15f9f8c93c3a4 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:38:00 +0300
Subject: [PATCH 229/267] Step 21.7: Add accounts-phone package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 2d94ff6..0f19195 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -27,3 +27,4 @@ check
 email
 jalik:ufs
 jalik:ufs-gridfs
+mys:accounts-phone
diff --git a/.meteor/versions b/.meteor/versions
index c3f660f..a17bd5a 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -61,6 +61,7 @@ modules@0.7.6
 modules-runtime@0.7.6
 mongo@1.1.12
 mongo-id@1.0.5
+mys:accounts-phone@0.0.21
 npm-bcrypt@0.9.1
 npm-mongo@1.5.49
 observe-sequence@1.0.12
-- 
2.7.4 (Apple Git-66)


From 632c9653cf5c44e69c4a7edb77a0b226851cfb9b Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:39:01 +0300
Subject: [PATCH 230/267] Step 21.8: Create a view for the mobile login

---
 client/imports/app/auth/login.component.mobile.html | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)
 create mode 100644 client/imports/app/auth/login.component.mobile.html

diff --git a/client/imports/app/auth/login.component.mobile.html b/client/imports/app/auth/login.component.mobile.html
new file mode 100644
index 0000000..cd71ab3
--- /dev/null
+++ b/client/imports/app/auth/login.component.mobile.html
@@ -0,0 +1,19 @@
+<div class="md-content" layout="row" layout-align="center start" layout-fill layout-margin>
+  <div layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+    <md-toolbar class="md-primary" color="primary">
+      Sign in
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Sign in with SMS</p>
+      </div>
+
+      <div [hidden]="error == ''">
+        <md-toolbar class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+          <p class="md-body-1">{{ error }}</p>
+        </md-toolbar>
+      </div>
+    </div>
+  </div>
+</div>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 69d1c61ac19c63c852d2e64d199e44797f1e8204 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:40:04 +0300
Subject: [PATCH 231/267] Step 21.9: Create mobile version of Login component

---
 client/imports/app/auth/login.component.mobile.ts | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
 create mode 100644 client/imports/app/auth/login.component.mobile.ts

diff --git a/client/imports/app/auth/login.component.mobile.ts b/client/imports/app/auth/login.component.mobile.ts
new file mode 100644
index 0000000..75a6e78
--- /dev/null
+++ b/client/imports/app/auth/login.component.mobile.ts
@@ -0,0 +1,17 @@
+import { Component, OnInit } from '@angular/core';
+import { FormBuilder, FormGroup, Validators } from '@angular/forms';
+import { Router } from '@angular/router';
+
+import template from './login.component.mobile.html';
+
+@Component({
+  selector: 'login',
+  template
+})
+export class MobileLoginComponent implements OnInit {
+  error: string = '';
+
+  constructor(private router: Router, private formBuilder: FormBuilder) {}
+
+  ngOnInit() {}
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From dc42a1b6560c377506621f9908a451b83103fe8b Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:40:42 +0300
Subject: [PATCH 232/267] Step 21.10: Add a form with phone number to provide

---
 client/imports/app/auth/login.component.mobile.html | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/client/imports/app/auth/login.component.mobile.html b/client/imports/app/auth/login.component.mobile.html
index cd71ab3..2154629 100644
--- a/client/imports/app/auth/login.component.mobile.html
+++ b/client/imports/app/auth/login.component.mobile.html
@@ -9,6 +9,16 @@
         <p class="md-body-2"> Sign in with SMS</p>
       </div>
 
+      <form [formGroup]="phoneForm" #f="ngForm" (ngSubmit)="send()"
+            layout="column" layout-fill layout-padding layout-margin>
+
+        <md-input formControlName="phone" type="text" placeholder="Phone"></md-input>
+
+        <div layout="row" layout-align="space-between center">
+          <button md-raised-button class="md-primary" type="submit" aria-label="send">Send SMS</button>
+        </div>
+      </form>
+
       <div [hidden]="error == ''">
         <md-toolbar class="md-warn" layout="row" layout-fill layout-padding layout-margin>
           <p class="md-body-1">{{ error }}</p>
-- 
2.7.4 (Apple Git-66)


From 02ac5e7132281dcba9c694280c8d4599b27066c2 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:42:13 +0300
Subject: [PATCH 233/267] Step 21.11: Implement a phone number verification

---
 client/imports/app/auth/login.component.mobile.ts | 28 ++++++++++++++++++++---
 1 file changed, 25 insertions(+), 3 deletions(-)

diff --git a/client/imports/app/auth/login.component.mobile.ts b/client/imports/app/auth/login.component.mobile.ts
index 75a6e78..651abdc 100644
--- a/client/imports/app/auth/login.component.mobile.ts
+++ b/client/imports/app/auth/login.component.mobile.ts
@@ -1,6 +1,7 @@
-import { Component, OnInit } from '@angular/core';
+import {Component, OnInit, NgZone} from '@angular/core';
 import { FormBuilder, FormGroup, Validators } from '@angular/forms';
 import { Router } from '@angular/router';
+import { Accounts } from 'meteor/accounts-base';
 
 import template from './login.component.mobile.html';
 
@@ -10,8 +11,29 @@ import template from './login.component.mobile.html';
 })
 export class MobileLoginComponent implements OnInit {
   error: string = '';
+  phoneForm: FormGroup;
+  phone: string;
 
-  constructor(private router: Router, private formBuilder: FormBuilder) {}
+  constructor(private router: Router, private zone: NgZone, private formBuilder: FormBuilder) {}
 
-  ngOnInit() {}
+  ngOnInit() {
+    this.phoneForm = this.formBuilder.group({
+      phone: ['', Validators.required]
+    });
+  }
+
+  send() {
+    if (this.phoneForm.valid) {
+      Accounts.requestPhoneVerification(this.phoneForm.value.phone, (err) => {
+        this.zone.run(() => {
+          if (err) {
+            this.error = err.reason || err;
+          } else {
+            this.phone = this.phoneForm.value.phone;
+            this.error = '';
+          }
+        });
+      });
+    }
+  }
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 59abafd123f7ce7119648692660fa2bc6a5c4c26 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:43:17 +0300
Subject: [PATCH 234/267] Step 21.12: Implement a code verification

---
 client/imports/app/auth/login.component.mobile.ts | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)

diff --git a/client/imports/app/auth/login.component.mobile.ts b/client/imports/app/auth/login.component.mobile.ts
index 651abdc..4695bda 100644
--- a/client/imports/app/auth/login.component.mobile.ts
+++ b/client/imports/app/auth/login.component.mobile.ts
@@ -13,6 +13,8 @@ export class MobileLoginComponent implements OnInit {
   error: string = '';
   phoneForm: FormGroup;
   phone: string;
+  verifyForm: FormGroup;
+  isStepTwo: boolean = false;
 
   constructor(private router: Router, private zone: NgZone, private formBuilder: FormBuilder) {}
 
@@ -20,6 +22,10 @@ export class MobileLoginComponent implements OnInit {
     this.phoneForm = this.formBuilder.group({
       phone: ['', Validators.required]
     });
+
+    this.verifyForm = this.formBuilder.group({
+        code: ['', Validators.required]
+    });
   }
 
   send() {
@@ -31,6 +37,23 @@ export class MobileLoginComponent implements OnInit {
           } else {
             this.phone = this.phoneForm.value.phone;
             this.error = '';
+            this.isStepTwo = true;
+          }
+        });
+      });
+    }
+  }
+
+
+  verify() {
+    if (this.verifyForm.valid) {
+      Accounts.verifyPhone(this.phone, this.verifyForm.value.code, (err) => {
+        this.zone.run(() => {
+          if (err) {
+            this.error = err.reason || err;
+          }
+          else {
+            this.router.navigate(['/']);
           }
         });
       });
-- 
2.7.4 (Apple Git-66)


From de950ecde22b1877bef59dee83bcfd53ce45fc96 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:44:00 +0300
Subject: [PATCH 235/267] Step 21.13: Create a form with code verification

---
 client/imports/app/auth/login.component.mobile.html | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/auth/login.component.mobile.html b/client/imports/app/auth/login.component.mobile.html
index 2154629..f6dc6b7 100644
--- a/client/imports/app/auth/login.component.mobile.html
+++ b/client/imports/app/auth/login.component.mobile.html
@@ -9,7 +9,7 @@
         <p class="md-body-2"> Sign in with SMS</p>
       </div>
 
-      <form [formGroup]="phoneForm" #f="ngForm" (ngSubmit)="send()"
+      <form [formGroup]="phoneForm" *ngIf="!isStepTwo" #f="ngForm" (ngSubmit)="send()"
             layout="column" layout-fill layout-padding layout-margin>
 
         <md-input formControlName="phone" type="text" placeholder="Phone"></md-input>
@@ -19,6 +19,16 @@
         </div>
       </form>
 
+      <form *ngIf="isStepTwo" [formGroup]="verifyForm" #f="ngForm" (ngSubmit)="verify()"
+            layout="column" layout-fill layout-padding layout-margin>
+
+        <md-input formControlName="code" type="text" placeholder="Code"></md-input>
+
+        <div layout="row" layout-align="space-between center">
+          <button md-raised-button class="md-primary" type="submit" aria-label="verify">Verify code</button>
+        </div>
+      </form>
+
       <div [hidden]="error == ''">
         <md-toolbar class="md-warn" layout="row" layout-fill layout-padding layout-margin>
           <p class="md-body-1">{{ error }}</p>
-- 
2.7.4 (Apple Git-66)


From c517b1b3bba10a47dd2346c9437744625155b027 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:46:50 +0300
Subject: [PATCH 236/267] Step 21.14: Added MobileLoginComponent to the index
 file

---
 client/imports/app/auth/index.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/auth/index.ts b/client/imports/app/auth/index.ts
index 228cb9c..dbca5ff 100644
--- a/client/imports/app/auth/index.ts
+++ b/client/imports/app/auth/index.ts
@@ -1,9 +1,11 @@
 import {LoginComponent} from "./login.component.web";
 import {SignupComponent} from "./singup.component";
 import {RecoverComponent} from "./recover.component";
+import {MobileLoginComponent} from "./login.component.mobile";
 
 export const AUTH_DECLARATIONS = [
   LoginComponent,
   SignupComponent,
-  RecoverComponent
+  RecoverComponent,
+  MobileLoginComponent
 ];
-- 
2.7.4 (Apple Git-66)


From 9942f2ce61e2a9e311012d18b2aaa7f96d8d8a47 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Tue, 27 Sep 2016 16:47:36 +0300
Subject: [PATCH 237/267] Step 21.15: Choose mobile or web version

---
 client/imports/app/app.routes.ts | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/client/imports/app/app.routes.ts b/client/imports/app/app.routes.ts
index efefd60..bb84cb5 100644
--- a/client/imports/app/app.routes.ts
+++ b/client/imports/app/app.routes.ts
@@ -3,14 +3,15 @@ import { Meteor } from 'meteor/meteor';
 
 import { PartiesListComponent } from './parties/parties-list.component';
 import { PartyDetailsComponent } from './parties/party-details.component';
-import {LoginComponent} from "./auth/login.component";
 import {SignupComponent} from "./auth/singup.component";
 import {RecoverComponent} from "./auth/recover.component";
+import {MobileLoginComponent} from "./auth/login.component.mobile";
+import {LoginComponent} from "./auth/login.component.web";
 
 export const routes: Route[] = [
   { path: '', component: PartiesListComponent },
   { path: 'party/:partyId', component: PartyDetailsComponent, canActivate: ['canActivateForLoggedIn'] },
-  { path: 'login', component: LoginComponent },
+  { path: 'login', component: Meteor.isCordova ? MobileLoginComponent : LoginComponent },
   { path: 'signup', component: SignupComponent },
   { path: 'recover', component: RecoverComponent }
 ];
-- 
2.7.4 (Apple Git-66)


From e7a3dba014811345549703273d55da18e14b816f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:06:32 +0300
Subject: [PATCH 238/267] Step 22.1: Install ionic-angular and missing angular
 dependencis

---
 package.json | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/package.json b/package.json
index b4194fc..d0883cd 100644
--- a/package.json
+++ b/package.json
@@ -21,8 +21,10 @@
     "@angular/compiler": "2.0.1",
     "@angular/core": "2.0.1",
     "@angular/forms": "2.0.1",
+    "@angular/http": "2.0.1",
     "@angular/platform-browser": "2.0.1",
     "@angular/platform-browser-dynamic": "2.0.1",
+    "@angular/platform-server": "2.0.1",
     "@angular/router": "3.0.1",
     "@angular2-material/button": "2.0.0-alpha.8-2",
     "@angular2-material/card": "2.0.0-alpha.8-2",
@@ -38,6 +40,7 @@
     "angular2-meteor-polyfills": "^0.1.1",
     "angular2-meteor-tests-polyfills": "0.0.2",
     "gm": "^1.23.0",
+    "ionic-angular": "2.0.0-rc.0",
     "meteor-node-stubs": "0.2.3",
     "meteor-rxjs": "0.2.3",
     "ng2-pagination": "0.4.1",
-- 
2.7.4 (Apple Git-66)


From 73444788dbeb819f8ff4f5b01d795cfd385e81cc Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:08:01 +0300
Subject: [PATCH 239/267] Step 22.2: Rename to app.component.web.ts

---
 client/imports/app/app.component.ts     | 19 -------------------
 client/imports/app/app.component.web.ts | 19 +++++++++++++++++++
 2 files changed, 19 insertions(+), 19 deletions(-)
 delete mode 100644 client/imports/app/app.component.ts
 create mode 100644 client/imports/app/app.component.web.ts

diff --git a/client/imports/app/app.component.ts b/client/imports/app/app.component.ts
deleted file mode 100644
index ba12be4..0000000
--- a/client/imports/app/app.component.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { Component } from '@angular/core';
-
-import template from './app.component.html';
-import {InjectUser} from "angular2-meteor-accounts-ui";
-
-@Component({
-  selector: 'app',
-  template
-})
-@InjectUser('user')
-export class AppComponent {
-  constructor() {
-
-  }
-
-  logout() {
-    Meteor.logout();
-  }
-}
diff --git a/client/imports/app/app.component.web.ts b/client/imports/app/app.component.web.ts
new file mode 100644
index 0000000..ba12be4
--- /dev/null
+++ b/client/imports/app/app.component.web.ts
@@ -0,0 +1,19 @@
+import { Component } from '@angular/core';
+
+import template from './app.component.html';
+import {InjectUser} from "angular2-meteor-accounts-ui";
+
+@Component({
+  selector: 'app',
+  template
+})
+@InjectUser('user')
+export class AppComponent {
+  constructor() {
+
+  }
+
+  logout() {
+    Meteor.logout();
+  }
+}
-- 
2.7.4 (Apple Git-66)


From 6987f59bd70056633f4dcc67f38062f11ab0e2f3 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:08:11 +0300
Subject: [PATCH 240/267] Step 22.3: Rename to app.component.web.html

---
 client/imports/app/app.component.html     | 13 -------------
 client/imports/app/app.component.web.html | 13 +++++++++++++
 2 files changed, 13 insertions(+), 13 deletions(-)
 delete mode 100644 client/imports/app/app.component.html
 create mode 100644 client/imports/app/app.component.web.html

diff --git a/client/imports/app/app.component.html b/client/imports/app/app.component.html
deleted file mode 100644
index f6c5855..0000000
--- a/client/imports/app/app.component.html
+++ /dev/null
@@ -1,13 +0,0 @@
-<md-toolbar color="primary">
-  <a routerLink="/" class="md-title">Socially</a>
-  <span class="fill-remaining-space"></span>
-  <div [hidden]="user">
-    <a md-button [routerLink]="['/login']" >Login</a>
-    <a md-button [routerLink]="['/signup']">Sign up</a>
-  </div>
-  <div [hidden]="!user">
-    <span>{{ user | displayName }}</span>
-    <button md-button (click)="logout()">Logout</button>
-  </div>
-</md-toolbar>
-<router-outlet></router-outlet>
\ No newline at end of file
diff --git a/client/imports/app/app.component.web.html b/client/imports/app/app.component.web.html
new file mode 100644
index 0000000..f6c5855
--- /dev/null
+++ b/client/imports/app/app.component.web.html
@@ -0,0 +1,13 @@
+<md-toolbar color="primary">
+  <a routerLink="/" class="md-title">Socially</a>
+  <span class="fill-remaining-space"></span>
+  <div [hidden]="user">
+    <a md-button [routerLink]="['/login']" >Login</a>
+    <a md-button [routerLink]="['/signup']">Sign up</a>
+  </div>
+  <div [hidden]="!user">
+    <span>{{ user | displayName }}</span>
+    <button md-button (click)="logout()">Logout</button>
+  </div>
+</md-toolbar>
+<router-outlet></router-outlet>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 472559b90242e67f7b6fd7efdf792791c5a902c8 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:08:40 +0300
Subject: [PATCH 241/267] Step 22.4: Updated the template import

---
 client/imports/app/app.component.web.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/app.component.web.ts b/client/imports/app/app.component.web.ts
index ba12be4..71fdeed 100644
--- a/client/imports/app/app.component.web.ts
+++ b/client/imports/app/app.component.web.ts
@@ -1,6 +1,6 @@
 import { Component } from '@angular/core';
 
-import template from './app.component.html';
+import template from './app.component.web.html';
 import {InjectUser} from "angular2-meteor-accounts-ui";
 
 @Component({
-- 
2.7.4 (Apple Git-66)


From 1d3ae54f0c724d3c723542380ec4cd7989eb9327 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:09:49 +0300
Subject: [PATCH 242/267] Step 22.5: Updated the main component import

---
 client/imports/app/app.module.ts | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index 7faa03b..d8c4fb2 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -6,7 +6,7 @@ import { AccountsModule } from 'angular2-meteor-accounts-ui';
 import { Ng2PaginationModule } from 'ng2-pagination';
 import { AgmCoreModule } from 'angular2-google-maps/core';
 
-import { AppComponent } from './app.component';
+import { AppComponent } from "./app.component.web";
 import { routes, ROUTES_PROVIDERS } from './app.routes';
 import { PARTIES_DECLARATIONS } from './parties';
 import { SHARED_DECLARATIONS } from './shared';
-- 
2.7.4 (Apple Git-66)


From 6aa83ead8dd1d328d7214d0d50116b5dfc6f5200 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:10:36 +0300
Subject: [PATCH 243/267] Step 22.6: Use web version of Login component in
 routing

---
 client/imports/app/app.routes.ts | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/client/imports/app/app.routes.ts b/client/imports/app/app.routes.ts
index bb84cb5..85f5669 100644
--- a/client/imports/app/app.routes.ts
+++ b/client/imports/app/app.routes.ts
@@ -5,13 +5,12 @@ import { PartiesListComponent } from './parties/parties-list.component';
 import { PartyDetailsComponent } from './parties/party-details.component';
 import {SignupComponent} from "./auth/singup.component";
 import {RecoverComponent} from "./auth/recover.component";
-import {MobileLoginComponent} from "./auth/login.component.mobile";
 import {LoginComponent} from "./auth/login.component.web";
 
 export const routes: Route[] = [
   { path: '', component: PartiesListComponent },
   { path: 'party/:partyId', component: PartyDetailsComponent, canActivate: ['canActivateForLoggedIn'] },
-  { path: 'login', component: Meteor.isCordova ? MobileLoginComponent : LoginComponent },
+  { path: 'login', component: LoginComponent },
   { path: 'signup', component: SignupComponent },
   { path: 'recover', component: RecoverComponent }
 ];
-- 
2.7.4 (Apple Git-66)


From 550f922d9bd97570eaa96cc310cfd0de85ebc5e1 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:16:31 +0300
Subject: [PATCH 244/267] Step 22.7: Created the main mobile component

---
 client/imports/app/mobile/app.component.mobile.ts | 13 +++++++++++++
 1 file changed, 13 insertions(+)
 create mode 100644 client/imports/app/mobile/app.component.mobile.ts

diff --git a/client/imports/app/mobile/app.component.mobile.ts b/client/imports/app/mobile/app.component.mobile.ts
new file mode 100644
index 0000000..ae661d6
--- /dev/null
+++ b/client/imports/app/mobile/app.component.mobile.ts
@@ -0,0 +1,13 @@
+import {Component} from "@angular/core";
+import template from "./app.component.mobile.html";
+import {MenuController, Platform, App} from "ionic-angular";
+
+@Component({
+  selector: "app",
+  template
+})
+export class AppMobileComponent {
+  constructor(app: App, platform: Platform, menu: MenuController) {
+
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 3eee010444e6d56f3b97823821c46501a01c687f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:16:41 +0300
Subject: [PATCH 245/267] Step 22.8: Created the main mobile component view

---
 client/imports/app/mobile/app.component.mobile.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/imports/app/mobile/app.component.mobile.html

diff --git a/client/imports/app/mobile/app.component.mobile.html b/client/imports/app/mobile/app.component.mobile.html
new file mode 100644
index 0000000..a94744b
--- /dev/null
+++ b/client/imports/app/mobile/app.component.mobile.html
@@ -0,0 +1 @@
+<ion-nav [root]="rootPage" swipe-back-enabled="true"></ion-nav>
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 2419c38d69adbd4c5b8097c4c4e24425ff1c5971 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:17:03 +0300
Subject: [PATCH 246/267] Step 22.9: Created index file for mobile declarations

---
 client/imports/app/mobile/index.ts | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 client/imports/app/mobile/index.ts

diff --git a/client/imports/app/mobile/index.ts b/client/imports/app/mobile/index.ts
new file mode 100644
index 0000000..b92e848
--- /dev/null
+++ b/client/imports/app/mobile/index.ts
@@ -0,0 +1,5 @@
+import {AppMobileComponent} from "./app.component.mobile";
+
+export const MOBILE_DECLARATIONS = [
+  AppMobileComponent
+];
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 0d64ae65fee1aa18c8208a271a68350b0fe99b2e Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:17:32 +0300
Subject: [PATCH 247/267] Step 22.10: Imported mobile declarations and added
 conditional main component bootstrap

---
 client/imports/app/app.module.ts | 94 ++++++++++++++++++++++++++--------------
 1 file changed, 61 insertions(+), 33 deletions(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index d8c4fb2..c512dd7 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -19,38 +19,66 @@ import { MdCheckboxModule } from "@angular2-material/checkbox";
 import {MdListModule} from "@angular2-material/list";
 import {AUTH_DECLARATIONS} from "./auth/index";
 import {FileDropModule} from "angular2-file-drop";
+import {MOBILE_DECLARATIONS} from "./mobile/index";
+import {AppMobileComponent} from "./mobile/app.component.mobile";
+import {IonicModule, IonicApp} from "ionic-angular";
 
-@NgModule({
-  imports: [
-    BrowserModule,
-    FormsModule,
-    ReactiveFormsModule,
-    RouterModule.forRoot(routes),
-    AccountsModule,
-    Ng2PaginationModule,
-    AgmCoreModule.forRoot({
-      apiKey: 'AIzaSyAWoBdZHCNh5R-hB5S5ZZ2oeoYyfdDgniA'
-    }),
-    MdCoreModule.forRoot(),
-    MdButtonModule.forRoot(),
-    MdToolbarModule.forRoot(),
-    MdInputModule.forRoot(),
-    MdCardModule.forRoot(),
-    MdCheckboxModule.forRoot(),
-    MdListModule.forRoot(),
-    FileDropModule
-  ],
-  declarations: [
-    AppComponent,
-    ...PARTIES_DECLARATIONS,
-    ...SHARED_DECLARATIONS,
-    ...AUTH_DECLARATIONS
-  ],
-  providers: [
-    ...ROUTES_PROVIDERS
-  ],
-  bootstrap: [
-    AppComponent
-  ]
-})
+let moduleDefinition;
+
+if (Meteor.isCordova) {
+  moduleDefinition = {
+    imports: [
+      IonicModule.forRoot(AppMobileComponent)
+    ],
+    declarations: [
+      ...SHARED_DECLARATIONS,
+      ...MOBILE_DECLARATIONS
+    ],
+    providers: [
+    ],
+    bootstrap: [
+      IonicApp
+    ],
+    entryComponents: [
+      AppMobileComponent
+    ]
+  }
+}
+else {
+  moduleDefinition = {
+    imports: [
+      BrowserModule,
+      FormsModule,
+      ReactiveFormsModule,
+      RouterModule.forRoot(routes),
+      AccountsModule,
+      Ng2PaginationModule,
+      AgmCoreModule.forRoot({
+        apiKey: 'AIzaSyAWoBdZHCNh5R-hB5S5ZZ2oeoYyfdDgniA'
+      }),
+      MdCoreModule.forRoot(),
+      MdButtonModule.forRoot(),
+      MdToolbarModule.forRoot(),
+      MdInputModule.forRoot(),
+      MdCardModule.forRoot(),
+      MdCheckboxModule.forRoot(),
+      MdListModule.forRoot(),
+      FileDropModule
+    ],
+    declarations: [
+      AppComponent,
+      ...PARTIES_DECLARATIONS,
+      ...SHARED_DECLARATIONS,
+      ...AUTH_DECLARATIONS
+    ],
+    providers: [
+      ...ROUTES_PROVIDERS
+    ],
+    bootstrap: [
+      AppComponent
+    ]
+  }
+}
+
+@NgModule(moduleDefinition)
 export class AppModule {}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From afaf548fd891be5321d4be3458c04312cfad0db1 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:38:32 +0300
Subject: [PATCH 248/267] Step 22.11: Added ionic-selector package

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index d0883cd..ffdfb93 100644
--- a/package.json
+++ b/package.json
@@ -41,6 +41,7 @@
     "angular2-meteor-tests-polyfills": "0.0.2",
     "gm": "^1.23.0",
     "ionic-angular": "2.0.0-rc.0",
+    "ionic-selector": "0.0.2",
     "meteor-node-stubs": "0.2.3",
     "meteor-rxjs": "0.2.3",
     "ng2-pagination": "0.4.1",
-- 
2.7.4 (Apple Git-66)


From 6751e828f045c008fe16f2102c32839059565f8f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:39:16 +0300
Subject: [PATCH 249/267] Step 22.12: Use ionic-selector package

---
 client/main.ts | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/main.ts b/client/main.ts
index 7c00907..5cbb885 100644
--- a/client/main.ts
+++ b/client/main.ts
@@ -6,7 +6,13 @@ import { AppModule } from './imports/app/app.module';
 
 import '../both/methods/parties.methods';
 
+import ionicSelector from 'ionic-selector';
+
 Meteor.startup(() => {
+  if (Meteor.isCordova) {
+    ionicSelector("app");
+  }
+
   const platform = platformBrowserDynamic();
   platform.bootstrapModule(AppModule);
 });
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From d509d1dc9c9468fe8a94ce12e08839313173b70e Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:42:58 +0300
Subject: [PATCH 250/267] Step 22.13: Install ionicons

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index ffdfb93..4dda2ac 100644
--- a/package.json
+++ b/package.json
@@ -42,6 +42,7 @@
     "gm": "^1.23.0",
     "ionic-angular": "2.0.0-rc.0",
     "ionic-selector": "0.0.2",
+    "ionicons": "^3.0.0",
     "meteor-node-stubs": "0.2.3",
     "meteor-rxjs": "0.2.3",
     "ng2-pagination": "0.4.1",
-- 
2.7.4 (Apple Git-66)


From 96f4ed21375286732ee1d8ffc07be30289736ef5 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:43:51 +0300
Subject: [PATCH 251/267] Step 22.14: Create ionic.scss and add ionicons to it

---
 client/imports/app/mobile/ionic.scss | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/imports/app/mobile/ionic.scss

diff --git a/client/imports/app/mobile/ionic.scss b/client/imports/app/mobile/ionic.scss
new file mode 100644
index 0000000..0dec7a3
--- /dev/null
+++ b/client/imports/app/mobile/ionic.scss
@@ -0,0 +1 @@
+@import "{}/node_modules/ionicons/dist/scss/ionicons";
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 8e824921ffb4aa96d74d2a06800b197149b1a579 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:48:45 +0300
Subject: [PATCH 252/267] Step 22.15: Import ionic.scss to main file

---
 client/main.scss | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/main.scss b/client/main.scss
index 40113ec..35d0575 100644
--- a/client/main.scss
+++ b/client/main.scss
@@ -1,4 +1,5 @@
 @import "{}/node_modules/angular2-meteor-accounts-ui/build/login-buttons.scss";
+@import "imports/app/mobile/ionic.scss";
 
 $color1 : #2F2933;
 $color2 : #01A2A6;
-- 
2.7.4 (Apple Git-66)


From dd0b9d98f8e71266bc70771d757fdaf0c1e14e58 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:59:06 +0300
Subject: [PATCH 253/267] Step 22.16: Imported the main css file of ionic

---
 client/imports/app/mobile/app.component.mobile.ts | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/imports/app/mobile/app.component.mobile.ts b/client/imports/app/mobile/app.component.mobile.ts
index ae661d6..212bc29 100644
--- a/client/imports/app/mobile/app.component.mobile.ts
+++ b/client/imports/app/mobile/app.component.mobile.ts
@@ -2,6 +2,10 @@ import {Component} from "@angular/core";
 import template from "./app.component.mobile.html";
 import {MenuController, Platform, App} from "ionic-angular";
 
+if (Meteor.isCordova) {
+  require("ionic-angular/css/ionic.css");
+}
+
 @Component({
   selector: "app",
   template
-- 
2.7.4 (Apple Git-66)


From 179c9f734f2607975685b78d3474d050bb30ba4f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:49:15 +0300
Subject: [PATCH 254/267] Step 22.17: Add two classes to fix an issue with
 overflow

---
 client/main.scss | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/client/main.scss b/client/main.scss
index 35d0575..685e517 100644
--- a/client/main.scss
+++ b/client/main.scss
@@ -22,6 +22,15 @@ body {
   font-family: 'Muli', sans-serif;
 }
 
+body.mobile {
+  overflow: hidden;
+}
+
+body.web {
+  overflow: visible;
+  position: initial;
+}
+
 .sebm-google-map-container {
   width: 450px;
   height: 450px;
-- 
2.7.4 (Apple Git-66)


From b14a2feef637e5252f31c8cc08b071c32145d491 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 12:50:18 +0300
Subject: [PATCH 255/267] Step 22.18: Set the proper class on body

---
 client/main.ts | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/main.ts b/client/main.ts
index 5cbb885..26bd39d 100644
--- a/client/main.ts
+++ b/client/main.ts
@@ -8,9 +8,20 @@ import '../both/methods/parties.methods';
 
 import ionicSelector from 'ionic-selector';
 
+function setClass(css) {
+  if (!document.body.className) {
+    document.body.className = "";
+  }
+  document.body.className += " " + css;
+}
+
 Meteor.startup(() => {
   if (Meteor.isCordova) {
     ionicSelector("app");
+    setClass('mobile');
+  }
+  else {
+    setClass('web');
   }
 
   const platform = platformBrowserDynamic();
-- 
2.7.4 (Apple Git-66)


From 3e625716fbd8abd7582024864d6dca70ec244f9e Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:04:53 +0300
Subject: [PATCH 256/267] Step 22.19: Take the logic of parties list to
 external class

---
 .../app/shared-components/parties-list.class.ts    | 112 +++++++++++++++++++++
 1 file changed, 112 insertions(+)
 create mode 100644 client/imports/app/shared-components/parties-list.class.ts

diff --git a/client/imports/app/shared-components/parties-list.class.ts b/client/imports/app/shared-components/parties-list.class.ts
new file mode 100644
index 0000000..dd481bb
--- /dev/null
+++ b/client/imports/app/shared-components/parties-list.class.ts
@@ -0,0 +1,112 @@
+import {OnDestroy, OnInit} from "@angular/core";
+import {Observable, Subscription, Subject} from "rxjs";
+import {Party} from "../../../../both/models/party.model";
+import {PaginationService} from "ng2-pagination";
+import {MeteorObservable} from "meteor-rxjs";
+import {Parties} from "../../../../both/collections/parties.collection";
+import {Counts} from "meteor/tmeasday:publish-counts";
+import {InjectUser} from "angular2-meteor-accounts-ui";
+
+interface Pagination {
+  limit: number;
+  skip: number;
+}
+
+interface Options extends Pagination {
+  [key: string]: any
+}
+
+@InjectUser('user')
+export class PartiesList implements OnInit, OnDestroy {
+  parties: Observable<Party[]>;
+  partiesSub: Subscription;
+  pageSize: Subject<number> = new Subject<number>();
+  curPage: Subject<number> = new Subject<number>();
+  nameOrder: Subject<number> = new Subject<number>();
+  optionsSub: Subscription;
+  partiesSize: number = 0;
+  autorunSub: Subscription;
+  location: Subject<string> = new Subject<string>();
+  user: Meteor.User;
+  imagesSubs: Subscription;
+
+  constructor(private paginationService: PaginationService) {
+
+  }
+
+  ngOnInit() {
+    this.optionsSub = Observable.combineLatest(
+      this.pageSize,
+      this.curPage,
+      this.nameOrder,
+      this.location
+    ).subscribe(([pageSize, curPage, nameOrder, location]) => {
+      const options: Options = {
+        limit: pageSize as number,
+        skip: ((curPage as number) - 1) * (pageSize as number),
+        sort: { name: nameOrder as number }
+      };
+
+      this.paginationService.setCurrentPage(this.paginationService.defaultId, curPage as number);
+
+      if (this.partiesSub) {
+        this.partiesSub.unsubscribe();
+      }
+
+      this.partiesSub = MeteorObservable.subscribe('parties', options, location).zone().subscribe(() => {
+        this.parties = Parties.find({}, {
+          sort: {
+            name: nameOrder
+          }
+        }).zone();
+      });
+    });
+
+    this.paginationService.register({
+      id: this.paginationService.defaultId,
+      itemsPerPage: 10,
+      currentPage: 1,
+      totalItems: this.partiesSize
+    });
+
+    this.pageSize.next(10);
+    this.curPage.next(1);
+    this.nameOrder.next(1);
+    this.location.next('');
+
+    this.autorunSub = MeteorObservable.autorun().zone().subscribe(() => {
+      this.partiesSize = Counts.get('numberOfParties');
+      this.paginationService.setTotalItems(this.paginationService.defaultId, this.partiesSize);
+    });
+
+    this.imagesSubs = MeteorObservable.subscribe('images').zone().subscribe();
+  }
+
+  removeParty(party: Party): void {
+    Parties.remove(party._id);
+  }
+
+  search(value: string): void {
+    this.curPage.next(1);
+    this.location.next(value);
+  }
+
+  onPageChanged(page: number): void {
+    this.curPage.next(page);
+  }
+
+  changeSortOrder(nameOrder: string): void {
+    this.nameOrder.next(parseInt(nameOrder));
+  }
+
+  isOwner(party: Party): boolean {
+    return this.user && this.user._id === party.owner;
+  }
+
+  ngOnDestroy() {
+    this.partiesSub.unsubscribe();
+    this.optionsSub.unsubscribe();
+    this.autorunSub.unsubscribe();
+    this.imagesSubs.unsubscribe();
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 3bf868fdb9be7e559b1bbd0af10e6909b2768f73 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:05:07 +0300
Subject: [PATCH 257/267] Step 22.20: Create a clean parties list for web
 display

---
 .../imports/app/parties/parties-list.component.ts  | 118 +--------------------
 1 file changed, 5 insertions(+), 113 deletions(-)

diff --git a/client/imports/app/parties/parties-list.component.ts b/client/imports/app/parties/parties-list.component.ts
index f392a12..cc5cfcb 100644
--- a/client/imports/app/parties/parties-list.component.ts
+++ b/client/imports/app/parties/parties-list.component.ts
@@ -1,123 +1,15 @@
-import { Component, OnInit, OnDestroy } from '@angular/core';
-import { Observable } from 'rxjs/Observable';
-import { Subject } from 'rxjs/Subject';
-import { Subscription } from 'rxjs/Subscription';
-import { MeteorObservable } from 'meteor-rxjs';
+import { Component } from '@angular/core';
 import { PaginationService } from 'ng2-pagination';
-import { Counts } from 'meteor/tmeasday:publish-counts';
-import { InjectUser } from "angular2-meteor-accounts-ui";
-
-import 'rxjs/add/operator/combineLatest';
-
-import { Parties } from '../../../../both/collections/parties.collection';
-import { Party } from '../../../../both/models/party.model';
+import { PartiesList } from "../shared-components/parties-list.class";
 
 import template from './parties-list.component.html';
 
-interface Pagination {
-  limit: number;
-  skip: number;
-}
-
-interface Options extends Pagination {
-  [key: string]: any
-}
-
 @Component({
   selector: 'parties-list',
   template
 })
-@InjectUser('user')
-export class PartiesListComponent implements OnInit, OnDestroy {
-  parties: Observable<Party[]>;
-  partiesSub: Subscription;
-  pageSize: Subject<number> = new Subject<number>();
-  curPage: Subject<number> = new Subject<number>();
-  nameOrder: Subject<number> = new Subject<number>();
-  optionsSub: Subscription;
-  partiesSize: number = 0;
-  autorunSub: Subscription;
-  location: Subject<string> = new Subject<string>();
-  user: Meteor.User;
-  imagesSubs: Subscription;
-
-  constructor(
-    private paginationService: PaginationService
-  ) {}
-
-  ngOnInit() {
-    this.optionsSub = Observable.combineLatest(
-      this.pageSize,
-      this.curPage,
-      this.nameOrder,
-      this.location
-    ).subscribe(([pageSize, curPage, nameOrder, location]) => {
-      const options: Options = {
-        limit: pageSize as number,
-        skip: ((curPage as number) - 1) * (pageSize as number),
-        sort: { name: nameOrder as number }
-      };
-
-      this.paginationService.setCurrentPage(this.paginationService.defaultId, curPage as number);
-
-      if (this.partiesSub) {
-        this.partiesSub.unsubscribe();
-      }
-      
-      this.partiesSub = MeteorObservable.subscribe('parties', options, location).zone().subscribe(() => {
-        this.parties = Parties.find({}, {
-          sort: {
-            name: nameOrder
-          }
-        }).zone();
-      });
-    });
-
-    this.paginationService.register({
-      id: this.paginationService.defaultId,
-      itemsPerPage: 10,
-      currentPage: 1,
-      totalItems: this.partiesSize
-    });
-
-    this.pageSize.next(10);
-    this.curPage.next(1);
-    this.nameOrder.next(1);
-    this.location.next('');
-
-    this.autorunSub = MeteorObservable.autorun().zone().subscribe(() => {
-      this.partiesSize = Counts.get('numberOfParties');
-      this.paginationService.setTotalItems(this.paginationService.defaultId, this.partiesSize);
-    });
-
-    this.imagesSubs = MeteorObservable.subscribe('images').zone().subscribe();
-  }
-
-  removeParty(party: Party): void {
-    Parties.remove(party._id);
-  }
-
-  search(value: string): void {
-    this.curPage.next(1);
-    this.location.next(value);
-  }
-
-  onPageChanged(page: number): void {
-    this.curPage.next(page);
-  }
-
-  changeSortOrder(nameOrder: string): void {
-    this.nameOrder.next(parseInt(nameOrder));
-  }
-
-  isOwner(party: Party): boolean {
-    return this.user && this.user._id === party.owner;
-  }
-
-  ngOnDestroy() {
-    this.partiesSub.unsubscribe();
-    this.optionsSub.unsubscribe();
-    this.autorunSub.unsubscribe();
-    this.imagesSubs.unsubscribe();
+export class PartiesListComponent extends PartiesList {
+  constructor(paginationService: PaginationService) {
+    super(paginationService);
   }
 }
-- 
2.7.4 (Apple Git-66)


From ac2e31a232c8903e146de29a92dc6f5e37c22063 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:06:01 +0300
Subject: [PATCH 258/267] Step 22.21: Create a basic view of the mobile version

---
 client/imports/app/mobile/parties-list.component.mobile.html | 8 ++++++++
 1 file changed, 8 insertions(+)
 create mode 100644 client/imports/app/mobile/parties-list.component.mobile.html

diff --git a/client/imports/app/mobile/parties-list.component.mobile.html b/client/imports/app/mobile/parties-list.component.mobile.html
new file mode 100644
index 0000000..36c6831
--- /dev/null
+++ b/client/imports/app/mobile/parties-list.component.mobile.html
@@ -0,0 +1,8 @@
+<ion-header>
+  <ion-navbar>
+    <ion-title>Socially</ion-title>
+  </ion-navbar>
+</ion-header>
+<ion-content>
+  Parties!
+</ion-content>
-- 
2.7.4 (Apple Git-66)


From 9a5abd23bd0a2b1e2e94087850dd668c57e6c1e4 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:07:44 +0300
Subject: [PATCH 259/267] Step 22.22: Create the mobile version of PartiesList
 component

---
 .../imports/app/mobile/parties-list.component.mobile.ts   | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 client/imports/app/mobile/parties-list.component.mobile.ts

diff --git a/client/imports/app/mobile/parties-list.component.mobile.ts b/client/imports/app/mobile/parties-list.component.mobile.ts
new file mode 100644
index 0000000..34b7ee1
--- /dev/null
+++ b/client/imports/app/mobile/parties-list.component.mobile.ts
@@ -0,0 +1,15 @@
+import { Component } from '@angular/core';
+import { PaginationService } from 'ng2-pagination';
+import { PartiesList } from "../shared-components/parties-list.class";
+
+import template from './parties-list.component.mobile.html';
+
+@Component({
+  selector: 'parties-list',
+  template
+})
+export class PartiesListMobileComponent extends PartiesList {
+  constructor(paginationService: PaginationService) {
+    super(paginationService);
+  }
+}
-- 
2.7.4 (Apple Git-66)


From 22e5ab254557f460ccafd8cef2235d3ff69a5883 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:08:28 +0300
Subject: [PATCH 260/267] Step 22.23: Added PartiesListMobile component to the
 index file

---
 client/imports/app/mobile/index.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/mobile/index.ts b/client/imports/app/mobile/index.ts
index b92e848..e6203fc 100644
--- a/client/imports/app/mobile/index.ts
+++ b/client/imports/app/mobile/index.ts
@@ -1,5 +1,7 @@
 import {AppMobileComponent} from "./app.component.mobile";
+import {PartiesListMobileComponent} from "./parties-list.component.mobile";
 
 export const MOBILE_DECLARATIONS = [
-  AppMobileComponent
+  AppMobileComponent,
+  PartiesListMobileComponent
 ];
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From 7a895db895cf7b2b4e39392d891e642564ea2d2a Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:14:30 +0300
Subject: [PATCH 261/267] Step 22.24: Added the rootPage

---
 client/imports/app/mobile/app.component.mobile.ts | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/mobile/app.component.mobile.ts b/client/imports/app/mobile/app.component.mobile.ts
index 212bc29..2b70422 100644
--- a/client/imports/app/mobile/app.component.mobile.ts
+++ b/client/imports/app/mobile/app.component.mobile.ts
@@ -1,6 +1,7 @@
 import {Component} from "@angular/core";
 import template from "./app.component.mobile.html";
 import {MenuController, Platform, App} from "ionic-angular";
+import {PartiesListMobileComponent} from "./parties-list.component.mobile";
 
 if (Meteor.isCordova) {
   require("ionic-angular/css/ionic.css");
@@ -11,7 +12,9 @@ if (Meteor.isCordova) {
   template
 })
 export class AppMobileComponent {
-  constructor(app: App, platform: Platform, menu: MenuController) {
+  rootPage: any;
 
+  constructor(app: App, platform: Platform, menu: MenuController) {
+    this.rootPage = PartiesListMobileComponent;
   }
 }
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)


From f2a32b8781d57738772d362688e4bccc4e33961b Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:15:32 +0300
Subject: [PATCH 262/267] Step 22.25: Update the module imports and entry point

---
 client/imports/app/app.module.ts | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/app.module.ts b/client/imports/app/app.module.ts
index c512dd7..2f8aac9 100644
--- a/client/imports/app/app.module.ts
+++ b/client/imports/app/app.module.ts
@@ -22,12 +22,14 @@ import {FileDropModule} from "angular2-file-drop";
 import {MOBILE_DECLARATIONS} from "./mobile/index";
 import {AppMobileComponent} from "./mobile/app.component.mobile";
 import {IonicModule, IonicApp} from "ionic-angular";
+import {PartiesListMobileComponent} from "./mobile/parties-list.component.mobile";
 
 let moduleDefinition;
 
 if (Meteor.isCordova) {
   moduleDefinition = {
     imports: [
+      Ng2PaginationModule,
       IonicModule.forRoot(AppMobileComponent)
     ],
     declarations: [
@@ -40,7 +42,7 @@ if (Meteor.isCordova) {
       IonicApp
     ],
     entryComponents: [
-      AppMobileComponent
+      PartiesListMobileComponent
     ]
   }
 }
-- 
2.7.4 (Apple Git-66)


From a637b4bfa8be38d59f29ce42236990eecee3671f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:26:29 +0300
Subject: [PATCH 263/267] Step 22.26: Add name, description ad RSVPs to the
 view

---
 .../app/mobile/parties-list.component.mobile.html  | 25 +++++++++++++++++++++-
 1 file changed, 24 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/mobile/parties-list.component.mobile.html b/client/imports/app/mobile/parties-list.component.mobile.html
index 36c6831..fc0c5b3 100644
--- a/client/imports/app/mobile/parties-list.component.mobile.html
+++ b/client/imports/app/mobile/parties-list.component.mobile.html
@@ -4,5 +4,28 @@
   </ion-navbar>
 </ion-header>
 <ion-content>
-  Parties!
+  <ion-card *ngFor="let party of parties | async">
+    <ion-card-content>
+      <ion-card-title>
+        {{party.name}}
+      </ion-card-title>
+      <p>
+        {{party.description}}
+      </p>
+    </ion-card-content>
+
+    <ion-row no-padding>
+      <ion-col text-right>
+        <ion-badge>
+          yes {{party | rsvp:'yes'}}
+        </ion-badge>
+        <ion-badge item-center dark>
+          maybe {{party | rsvp:'maybe'}}
+        </ion-badge>
+        <ion-badge item-center danger>
+          no {{party | rsvp:'no'}}
+        </ion-badge>
+      </ion-col>
+    </ion-row>
+  </ion-card>
 </ion-content>
-- 
2.7.4 (Apple Git-66)


From d041b620a8f0cce88b8e5940d62851e4a16584ba Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:28:06 +0300
Subject: [PATCH 264/267] Step 22.27: Fix an issuewith a absolute path of an
 image

---
 client/imports/app/shared/display-main-image.pipe.ts | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/client/imports/app/shared/display-main-image.pipe.ts b/client/imports/app/shared/display-main-image.pipe.ts
index c98e952..dda5f05 100644
--- a/client/imports/app/shared/display-main-image.pipe.ts
+++ b/client/imports/app/shared/display-main-image.pipe.ts
@@ -1,6 +1,7 @@
 import {Pipe, PipeTransform} from '@angular/core';
 import { Images } from '../../../../both/collections/images.collection';
 import { Party } from '../../../../both/models/party.model';
+import { Meteor } from "meteor/meteor";
 
 @Pipe({
   name: 'displayMainImage'
@@ -17,7 +18,12 @@ export class DisplayMainImagePipe implements PipeTransform {
     const found = Images.findOne(imageId);
 
     if (found) {
-      imageUrl = found.url;
+      if (!Meteor.isCordova) {
+        imageUrl = found.url;
+      } else {
+        const path = `ufs/${found.store}/${found._id}/${found.name}`;
+        imageUrl = Meteor.absoluteUrl(path);
+      }
     }
 
     return imageUrl;
-- 
2.7.4 (Apple Git-66)


From 6eebc03d32ddf45e230b4743ee93418c22efedf7 Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:28:57 +0300
Subject: [PATCH 265/267] Step 22.28: Use the main image pipe

---
 client/imports/app/mobile/parties-list.component.mobile.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/imports/app/mobile/parties-list.component.mobile.html b/client/imports/app/mobile/parties-list.component.mobile.html
index fc0c5b3..02e5489 100644
--- a/client/imports/app/mobile/parties-list.component.mobile.html
+++ b/client/imports/app/mobile/parties-list.component.mobile.html
@@ -5,6 +5,7 @@
 </ion-header>
 <ion-content>
   <ion-card *ngFor="let party of parties | async">
+    <img *ngIf="party.images" [src]="party | displayMainImage">
     <ion-card-content>
       <ion-card-title>
         {{party.name}}
-- 
2.7.4 (Apple Git-66)


From 8af274d4d2154e4a2d291d261269bcc25b95551f Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:30:25 +0300
Subject: [PATCH 266/267] Step 22.29: Add mys:fonts

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 0f19195..94f1344 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -28,3 +28,4 @@ email
 jalik:ufs
 jalik:ufs-gridfs
 mys:accounts-phone
+mys:fonts
diff --git a/.meteor/versions b/.meteor/versions
index a17bd5a..4f10af6 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -62,6 +62,7 @@ modules-runtime@0.7.6
 mongo@1.1.12
 mongo-id@1.0.5
 mys:accounts-phone@0.0.21
+mys:fonts@0.0.2
 npm-bcrypt@0.9.1
 npm-mongo@1.5.49
 observe-sequence@1.0.12
-- 
2.7.4 (Apple Git-66)


From 104891195013c1a27158be45e00e34698c8d7afc Mon Sep 17 00:00:00 2001
From: dotansimha <dotansimha@gmail.com>
Date: Wed, 28 Sep 2016 13:30:57 +0300
Subject: [PATCH 267/267] Step 22.30: Define fonts.json

---
 fonts.json | 8 ++++++++
 1 file changed, 8 insertions(+)
 create mode 100644 fonts.json

diff --git a/fonts.json b/fonts.json
new file mode 100644
index 0000000..311eb9c
--- /dev/null
+++ b/fonts.json
@@ -0,0 +1,8 @@
+{
+  "map": {
+    "node_modules/ionic-angular/fonts/roboto-medium.ttf": "fonts/roboto-medium.ttf",
+    "node_modules/ionic-angular/fonts/roboto-regular.ttf": "fonts/roboto-regular.ttf",
+    "node_modules/ionic-angular/fonts/roboto-medium.woff": "fonts/roboto-medium.woff",
+    "node_modules/ionic-angular/fonts/roboto-regular.woff": "fonts/roboto-regular.woff"
+  }
+}
\ No newline at end of file
-- 
2.7.4 (Apple Git-66)

